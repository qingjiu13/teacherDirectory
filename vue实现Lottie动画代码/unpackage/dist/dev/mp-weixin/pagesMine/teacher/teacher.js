"use strict";const e=require("../../common/vendor.js"),h=require("../../router/Router.js"),s=require("../../common/assets.js"),l=()=>"../../components/navigationTitleBar/header.js",_=()=>"../../components/loading/LoadingAnimation.js",v=e.defineComponent({components:{Header:l,LoadingAnimation:_},data(){return{teacherId:null,activeTab:"services",isLoading:!1,showServiceDetail:!1,currentService:null,isIntroExpanded:!1,introMaxLength:100}},computed:Object.assign(Object.assign({},e.mapState("user/match",["matchList"])),{teacherData(){var i;e.index.__f__("log","at pagesMine/teacher/teacher.vue:207","=== teacherData computed 被调用 ==="),e.index.__f__("log","at pagesMine/teacher/teacher.vue:208","当前 teacherId:",this.teacherId,"类型:",typeof this.teacherId),e.index.__f__("log","at pagesMine/teacher/teacher.vue:209","matchList 长度:",this.matchList.length),this.matchList.forEach((n=null,u=null)=>{e.index.__f__("log","at pagesMine/teacher/teacher.vue:213",`[${u}] teacher.id: ${n.id} (类型: ${typeof n.id})`)});const a=this.matchList.find((n=null)=>Number(n.id)===Number(this.teacherId));return e.index.__f__("log","at pagesMine/teacher/teacher.vue:219","找到的教师:",a?"是":"否"),a&&(e.index.__f__("log","at pagesMine/teacher/teacher.vue:221","教师服务数量:",((i=a.service)===null||i===void 0?null:i.length)||0),a.service&&a.service.length>0&&e.index.__f__("log","at pagesMine/teacher/teacher.vue:223","第一个服务:",UTS.JSON.stringify(a.service[0],null,2))),a||new UTSJSONObject({id:null,name:"",avatar:"/static/image/defaultAvatar/teacher-man.png",school:"",major:"",certificate:0,campusAmbassador:0,selfIntroduction:"暂无数据",service:[]})},services(){return this.teacherData&&Array.isArray(this.teacherData.service)?this.teacherData.service:[]},displayIntroduction(){const i=this.teacherData.selfIntroduction||"这位老师很懒，还没有填写个人简介。";return!this.isIntroExpanded&&i.length>this.introMaxLength?i.substring(0,this.introMaxLength)+"...":i},shouldShowToggleBtn(){return(this.teacherData.selfIntroduction||"").length>this.introMaxLength}}),onLoad(i){if(e.index.__f__("log","at pagesMine/teacher/teacher.vue:273","=== teacher.vue onLoad 开始 ==="),e.index.__f__("log","at pagesMine/teacher/teacher.vue:274","接收到的options:",i),this.teacherId=Number(i.id)||null,e.index.__f__("log","at pagesMine/teacher/teacher.vue:279","解析后的teacherId:",this.teacherId,"类型:",typeof this.teacherId),!this.teacherId)return e.index.__f__("error","at pagesMine/teacher/teacher.vue:282","teacherId 无效或为空"),e.index.showToast({title:"未获取到教师ID",icon:"none"}),null;this.isLoading=!0,this.$store.dispatch("user/match/fetchTeacherDetail",new UTSJSONObject({teacherId:this.teacherId})).then((a=null)=>{var n;e.index.__f__("log","at pagesMine/teacher/teacher.vue:298","=== teacher.vue 获取教师详情成功 ==="),e.index.__f__("log","at pagesMine/teacher/teacher.vue:299","API响应:",a);const u=this.matchList.findIndex((t=null)=>Number(t.id)===this.teacherId);u===-1?(e.index.__f__("warn","at pagesMine/teacher/teacher.vue:304","在matchList中未找到对应的教师信息"),e.index.showToast({title:"未找到该教师信息",icon:"none"})):(e.index.__f__("log","at pagesMine/teacher/teacher.vue:310","成功找到教师信息，索引:",u),e.index.__f__("log","at pagesMine/teacher/teacher.vue:311","教师服务数量:",((n=this.teacherData.service)===null||n===void 0?null:n.length)||0)),this.isLoading=!1}).catch((a=null)=>{e.index.__f__("error","at pagesMine/teacher/teacher.vue:318","=== teacher.vue 获取教师详情失败 ==="),e.index.__f__("error","at pagesMine/teacher/teacher.vue:319","错误详情:",a),this.isLoading=!1,e.index.showToast({title:a.message||"获取教师详情失败",icon:"none"})}),e.index.__f__("log","at pagesMine/teacher/teacher.vue:330","=== teacher.vue onLoad 完成 ===")},methods:{handleBack(){h.Navigator.redirectTo(h.MatchRoutes.MATCH)},switchTab(i=null){this.activeTab!==i&&(this.activeTab=i)},toggleIntroduction(){this.isIntroExpanded=!this.isIntroExpanded},startConsultation(){this.isLoading=!0,setTimeout(()=>{this.isLoading=!1,h.Navigator.toChat(this.teacherId)},500)},goToServiceDetail(i=null){const a=Array.isArray(this.services)?this.services:[],n=UTS.arrayFind(a,(u=null)=>u.id===i);n?(this.currentService=n,this.showServiceDetail=!0):e.index.showToast({title:"未找到服务信息",icon:"none"})},closeServiceDetail(){this.showServiceDetail=!1,this.currentService=null}}});if(!Array){const i=e.resolveComponent("Header"),a=e.resolveComponent("loading-animation");(i+a)()}function g(i,a,n,u,t,r){return e.e({a:s._imports_0$2,b:s._imports_1$2,c:e.o(r.handleBack),d:e.p({title:"导师详情"}),e:t.isLoading},t.isLoading?{f:e.p({src:"https://lottie.host/1f64310d-d1a9-44c9-ac77-3c29ae849559/c3yfKGAzCm.json",width:"150rpx",height:"150rpx",showText:!0,text:"加载中..."})}:{},{g:!t.isLoading},t.isLoading?{}:e.e({h:r.teacherData.avatar||"/static/image/defaultAvatar/teacher-man.png",i:e.t(r.teacherData.name),j:r.teacherData.certificate},r.teacherData.certificate?{k:s._imports_2$2}:{l:s._imports_3$4},{m:r.teacherData.campusAmbassador},r.teacherData.campusAmbassador?{n:s._imports_4$1}:{},{o:e.t(r.teacherData.school),p:e.t(r.teacherData.major),q:e.t(r.displayIntroduction),r:r.shouldShowToggleBtn},r.shouldShowToggleBtn?{s:e.t(t.isIntroExpanded?"收起":"展开"),t:e.o((...c)=>r.toggleIntroduction&&r.toggleIntroduction(...c))}:{},{v:t.activeTab==="services"?1:"",w:e.o(c=>r.switchTab("services")),x:t.activeTab==="services"},t.activeTab==="services"?e.e({y:r.teacherData.service&&r.teacherData.service.length>0},r.teacherData.service&&r.teacherData.service.length>0?{z:e.f(r.teacherData.service,(c,o,m)=>({a:c.images&&c.images.length>0?c.images[0]:"../static/teacher/test.png",b:e.t(c.name),c:e.t(c.price),d:e.t(c.description.length>=40?c.description.slice(0,40)+"...":c.description),e:o,f:e.o(d=>r.goToServiceDetail(c.id),o)}))}:{}):{},{A:s._imports_5,B:e.o((...c)=>r.startConsultation&&r.startConsultation(...c))}),{C:t.showServiceDetail},t.showServiceDetail?e.e({D:e.o((...c)=>r.closeServiceDetail&&r.closeServiceDetail(...c)),E:t.currentService.images&&t.currentService.images.length>0?t.currentService.images[0]:"../static/teacher/test.png",F:e.t(t.currentService.name),G:e.t(t.currentService.price),H:e.t(t.currentService.type.typeName),I:t.currentService.type.typeName==="一对一课程"||t.currentService.type.typeName==="一对多课程"},t.currentService.type.typeName==="一对一课程"||t.currentService.type.typeName==="一对多课程"?{}:{},{J:t.currentService.type.typeName==="一对一课程"||t.currentService.type.typeName==="一对多课程"},t.currentService.type.typeName==="一对一课程"||t.currentService.type.typeName==="一对多课程"?{K:e.t(t.currentService.type.courseNum)}:{},{L:t.currentService.type.typeName==="一对一课程"||t.currentService.type.typeName==="一对多课程"},t.currentService.type.typeName==="一对一课程"||t.currentService.type.typeName==="一对多课程"?{}:{},{M:t.currentService.type.typeName==="一对一课程"||t.currentService.type.typeName==="一对多课程"},t.currentService.type.typeName==="一对一课程"||t.currentService.type.typeName==="一对多课程"?{N:e.t(t.currentService.type.hours),O:e.t(t.currentService.type.minutes)}:{},{P:t.currentService.type.typeName==="一对多课程"},t.currentService.type.typeName==="一对多课程"?{}:{},{Q:t.currentService.type.typeName==="一对多课程"},t.currentService.type.typeName==="一对多课程"?{R:e.t(t.currentService.type.studentNum)}:{},{S:e.t(t.currentService.description)}):{})}const p=e._export_sfc(v,[["render",g]]);wx.createPage(p);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pagesMine/teacher/teacher.js.map
