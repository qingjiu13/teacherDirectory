"use strict";const n=require("../../../../common/vendor.js"),l=require("./js/uuid.js"),h=n.defineComponent({props:{canvasId:{type:String},width:{type:String,default:"750rpx"},height:{type:String,default:"750rpx"},src:{type:String},data:{type:String},autoPlay:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},renderer:{type:String,default:"canvas"},isOnChange:{type:Boolean,default:!1}},emits:["Complete","LoopComplete","EnterFrame","SegmentStart","dataReady","dataFailed"],data(){return{fun:new UTSJSONObject({})}},computed:{myCanvasId(){return this.canvasId?this.canvasId:"c"+l.uuid(18)},lottieData(){return new UTSJSONObject({myCanvasId:this.myCanvasId,width:this.width,height:this.height,src:this.src,data:this.data,autoPlay:this.autoPlay,loop:this.loop,renderer:this.renderer,isOnChange:this.isOnChange})}},watch:{lottieData(){this.render()}},methods:{call(e=null,a=null){this.fun=new UTSJSONObject({name:e,args:a}),this.callPlayer(this.fun)},getContext(){return new Promise(e=>{const a=n.index.getSystemInfoSync().pixelRatio;n.index.createSelectorQuery().in(this).select(`#${this.myCanvasId}`).fields(new UTSJSONObject({node:!0,size:!0})).exec(i=>{const r=i[0],s=r.width,t=r.height,o=i[0].node;e({canvas:o,width:s,height:t,pixelRatio:a})})})},render(){return n.__awaiter(this,void 0,void 0,function*(){this.player&&this.call("destroy",this.player);let e=yield this.getContext(),a=e.canvas,i=e.width,r=e.height,s=e.pixelRatio;this.myCanvas=a,this.context=a.getContext("2d"),this.context.scale(s,s),a.width=i*s,a.height=r*s,n.lottie.setup(this.myCanvas),this.player=n.lottie.loadAnimation({loop:this.loop,autoplay:this.autoPlay,animationData:this.data,path:this.src,rendererSettings:{context:this.context}}),this.player.addEventListener("data_ready",(t=null)=>{this.$emit("dataReady",t)}),this.player.addEventListener("data_failed",(t=null)=>{this.$emit("dataFailed",t)}),this.player.onComplete=(t=null)=>{this.$emit("Complete",t)},this.player.onLoopComplete=(t=null)=>{this.$emit("LoopComplete",t)},this.isOnChange&&(this.player.onEnterFrame=(t=null)=>{this.$emit("EnterFrame",t)}),this.player.onSegmentStart=(t=null)=>{this.$emit("SegmentStart",t)}})},callPlayer(e=null){if(!e.name)return null;let a=e.name,i=e.args;Array.isArray(i)?this.player[a](...i):this.player[a](i)}},mounted(){this.render()},beforeDestroy(){this.call("destroy")}});function d(e,a,i,r,s,t){return{a:n.sei(t.myCanvasId,"canvas"),b:n.sei(n.gei(e,""),"view"),c:i.width,d:i.height}}const c=n._export_sfc(h,[["render",d],["__scopeId","data-v-bb75a63f"]]);wx.createComponent(c);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/uni_modules/c-lottie/components/c-lottie/c-lottie.js.map
