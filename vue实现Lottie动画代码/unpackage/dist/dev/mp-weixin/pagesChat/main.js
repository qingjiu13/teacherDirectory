"use strict";const e=require("../common/vendor.js"),u=require("./env.js");require("../uni_modules/uview-plus/index.js");const m=require("./store/chatStore.js"),d=require("./store/friendStore.js"),f=require("./store/configStore.js"),_=require("./store/userStore.js"),g=require("./store/groupStore.js"),S=require("../uni_modules/uni-search-bar/components/uni-search-bar/i18n/index.js"),y=require("./common/date.js"),w=require("./common/emotion.js"),l=require("./common/messageType.js"),C=require("./common/enums.js");require("./common/recorder-app.js");const h=e.initVueI18n(S.messages).t,p=e.defineComponent({name:"UniSearchBar",emits:["input","update:modelValue","clear","cancel","confirm","blur","focus"],props:{placeholder:{type:String,default:""},radius:{type:[Number,String],default:5},clearButton:{type:String,default:"auto"},cancelButton:{type:String,default:"auto"},cancelText:{type:String,default:""},bgColor:{type:String,default:"#F8F8F8"},maxlength:{type:[Number,String],default:100},value:{type:[Number,String],default:""},modelValue:{type:[Number,String],default:""},focus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},data(){return{show:!1,showSync:!1,searchVal:""}},computed:{cancelTextI18n(){return this.cancelText||h("uni-search-bar.cancel")},placeholderText(){return this.placeholder||h("uni-search-bar.placeholder")}},watch:{modelValue:{immediate:!0,handler(t=null){this.searchVal=t,t&&(this.show=!0)}},focus:{immediate:!0,handler(t=null){if(t){if(this.readonly)return null;this.show=!0,this.$nextTick(()=>{this.showSync=!0})}}},searchVal(t=null,c=null){this.$emit("input",t),this.$emit("update:modelValue",t)}},methods:{searchClick(){if(this.readonly||this.show)return null;this.show=!0,this.$nextTick(()=>{this.showSync=!0})},clear(){this.$emit("clear",new UTSJSONObject({value:this.searchVal})),this.searchVal=""},cancel(){if(this.readonly)return null;this.$emit("cancel",new UTSJSONObject({value:this.searchVal})),this.searchVal="",this.show=!1,this.showSync=!1,e.index.hideKeyboard()},confirm(){e.index.hideKeyboard(),this.$emit("confirm",new UTSJSONObject({value:this.searchVal}))},blur(){e.index.hideKeyboard(),this.$emit("blur",new UTSJSONObject({value:this.searchVal}))},emitFocus(t=null){this.$emit("focus",t.detail)}}});Array||e.resolveComponent("uni-icons")();const b=()=>"../uni_modules/uni-icons/components/uni-icons/uni-icons.js";Math||b();function T(t,c,n,i,a,o){return e.e({a:e.p({color:"#c0c4cc",size:"18",type:"search"}),b:a.show||a.searchVal},a.show||a.searchVal?{c:a.showSync,d:n.readonly,e:o.placeholderText,f:n.maxlength,g:e.o((...s)=>o.confirm&&o.confirm(...s)),h:e.o((...s)=>o.blur&&o.blur(...s)),i:e.o((...s)=>o.emitFocus&&o.emitFocus(...s)),j:a.searchVal,k:e.o(s=>a.searchVal=s.detail.value)}:{l:e.t(n.placeholder)},{m:a.show&&(n.clearButton==="always"||n.clearButton==="auto"&&a.searchVal!=="")&&!n.readonly},a.show&&(n.clearButton==="always"||n.clearButton==="auto"&&a.searchVal!=="")&&!n.readonly?{n:e.p({color:"#c0c4cc",size:"20",type:"clear"}),o:e.o((...s)=>o.clear&&o.clear(...s))}:{},{p:n.radius+"px",q:n.bgColor,r:e.o((...s)=>o.searchClick&&o.searchClick(...s)),s:n.cancelButton==="always"||a.show&&n.cancelButton==="auto"},n.cancelButton==="always"||a.show&&n.cancelButton==="auto"?{t:e.t(o.cancelTextI18n),v:e.o((...s)=>o.cancel&&o.cancel(...s))}:{},{w:e.sei(e.gei(t,""),"view")})}const x=e._export_sfc(p,[["render",T]]);Array||e.resolveComponent("uni-icons")();const v=()=>"../uni_modules/uni-icons/components/uni-icons/uni-icons.js";Math||v();Array||e.resolveComponent("uni-icons")();const M=()=>"../uni_modules/uni-icons/components/uni-icons/uni-icons.js";Math||M();const N=e.defineComponent({data(){return{}},props:{size:{type:Number,default:100},mask:{type:Boolean,default:!0}},computed:{icontStyle(){return`font-size:${this.size}rpx`},loadingStyle(){return this.mask?"background: rgba(0, 0, 0, 0.3);":""}}});function B(t,c,n,i,a,o){return{a:e.s(o.icontStyle),b:e.sei(e.gei(t,""),"view"),c:e.s(o.loadingStyle)}}const V=e._export_sfc(N,[["render",B],["__scopeId","data-v-34228fa1"]]),j=e.defineComponent({name:"long-press-menu",data(){return{isShowMenu:!1,isTouchMove:!1,style:""}},props:{items:{type:Array}},methods:{onLongPress(t=null){if(this.isTouchMove)return null;e.index.getSystemInfo(new UTSJSONObject({success:c=>{let n=t.touches[0],i="";n.clientY>c.windowHeight/2?i=`bottom:${c.windowHeight-n.clientY}px;`:i=`top:${n.clientY}px;`,n.clientX>c.windowWidth/2?i+=`right:${c.windowWidth-n.clientX}px;`:i+=`left:${n.clientX}px;`,this.menuStyle=i,this.$nextTick(()=>{this.isShowMenu=!0})}}))},onTouchMove(){this.onClose(),this.isTouchMove=!0},onTouchEnd(){this.isTouchMove=!1},onSelectMenu(t=null){this.$emit("select",t),this.isShowMenu=!1},onClose(){this.isShowMenu=!1},itemStyle(t=null){return t.color?`color:${t.color};`:"color:#000;"}}});function I(t,c,n,i,a,o){return e.e({a:e.o(s=>o.onLongPress(s)),b:e.o((...s)=>o.onTouchMove&&o.onTouchMove(...s)),c:e.o((...s)=>o.onTouchEnd&&o.onTouchEnd(...s)),d:a.isShowMenu},a.isShowMenu?{e:e.o(s=>o.onClose()),f:e.o(()=>{})}:{},{g:a.isShowMenu},a.isShowMenu?{h:e.f(n.items,(s,X,K)=>({a:e.t(s.name),b:e.s(o.itemStyle(s)),c:s.key,d:e.o(D=>o.onSelectMenu(s),s.key)})),i:e.s(t.menuStyle)}:{},{j:e.sei(e.gei(t,""),"view")})}const E=e._export_sfc(j,[["render",I],["__scopeId","data-v-8aa6628f"]]),k=()=>"./components/head-image/head-image.js",q=e.defineComponent({name:"chatItem",components:{HeadImage:k},data(){return{MESSAGE_TYPE:C.MESSAGE_TYPE}},props:{chat:{type:Object},index:{type:Number},active:{type:Boolean,default:!1},chatStore:{type:Object,default:null}},beforeCreate(){this.$msgType||(this.$msgType=l.messageType)},methods:{formatTime(t=null,c=null){return y.toTimeText(t,c)},transformEmoji(t=null){return t?w.emoUtil.transform(t,"emoji-img"):""},showChatBox(){if(!getApp().$vm.isInit||this.chatStore&&this.chatStore.isLoading&&this.chatStore.isLoading())return e.index.showToast({title:"正在初始化页面,请稍后...",icon:"none"}),null;e.index.navigateTo({url:"/pagesChat/chat-box?chatIdx="+this.index})}},computed:{isShowSendName(){if(!this.chat.sendNickName)return!1;let t=this.chat.messages?this.chat.messages.length:0;if(t==0)return!1;let c=this.chat.messages[t-1];return l.isNormal(c.type)},atText(){return this.chat.atMe?"[有人@我]":this.chat.atAll?"[@全体成员]":""}}});if(!Array){const t=e.resolveComponent("HeadImage"),c=e.resolveComponent("uni-badge");(t+c)()}const A=()=>"../uni_modules/uni-badge/components/uni-badge/uni-badge.js";Math||A();function O(t,c,n,i,a,o){return e.e({a:e.o(s=>o.showChatBox()),b:e.p({url:n.chat.headImage,name:n.chat.showName}),c:e.t(n.chat.showName),d:e.t(o.formatTime(n.chat.lastSendTime,!0)),e:e.t(o.atText),f:o.isShowSendName},o.isShowSendName?{g:e.t(n.chat.sendNickName+": ")}:{},{h:o.transformEmoji(n.chat.lastContent),i:n.chat.unreadCount>0},n.chat.unreadCount>0?{j:e.p({"max-num":99,text:n.chat.unreadCount})}:{},{k:e.sei(e.gei(t,""),"view"),l:e.n(n.active?"active":"")})}const U=e._export_sfc(q,[["render",O],["__scopeId","data-v-cbde654b"]]),r=e.createPinia();u.UNI_APP.WEBRTC||(u.UNI_APP.WEBRTC={ICE_SERVERS:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}],MAX_CHANNEL:6});const F=m.useChatStore(r),P=d.useFriendStore(r),z=f.useConfigStore(r),H=_.useUserStore(r),G=g.useGroupStore(r);function J(){return F}function L(){return P}function Y(){return z}function R(){return H}function W(){return G}exports.Component=x;exports.Component$1=U;exports.Component$2=E;exports.Component$3=V;exports.getChatStore=J;exports.getConfigStore=Y;exports.getFriendStore=L;exports.getGroupStore=W;exports.getUserStore=R;
//# sourceMappingURL=../../.sourcemap/mp-weixin/pagesChat/main.js.map
