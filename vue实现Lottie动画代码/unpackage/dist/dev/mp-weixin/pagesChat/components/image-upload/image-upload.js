"use strict";const e=require("../../../common/vendor.js"),s=require("../../env.js"),r=e.defineComponent({name:"image-upload",data(){return{uploadHeaders:new UTSJSONObject({accessToken:e.index.getStorageSync("loginInfo").accessToken})}},props:{maxCount:{type:Number,default:1},maxSize:{type:Number,default:5*1024*1024},sourceType:{type:String,default:"album"},isPermanent:{type:Boolean,default:!1},onBefore:{type:Function,default:null},onSuccess:{type:Function,default:null},onError:{type:Function,default:null}},methods:{selectAndUpload(){e.index.chooseImage(new UTSJSONObject({count:this.maxCount,sourceType:[this.sourceType],sizeType:["original"],success:n=>{n.tempFiles.forEach(o=>{(!this.onBefore||this.onBefore(o))&&this.uploadImage(o)})}}))},uploadImage(n=null){e.index.uploadFile({url:s.UNI_APP.BASE_URL+"/image/upload?isPermanent="+this.isPermanent,header:new UTSJSONObject({accessToken:e.index.getStorageSync("loginInfo").accessToken}),filePath:n.path,name:"file",success:o=>{let t=UTS.JSON.parse(o.data);t.code!=200?(e.index.showToast({icon:"none",title:t.message}),this.onError&&this.onError(n,t)):this.onSuccess&&this.onSuccess(n,t)},fail:o=>{e.index.__f__("log","at pagesChat/components/image-upload/image-upload.vue:87",o),this.onError&&this.onError(n,o)}})}}});function c(n,o,t,u,l,a){return{a:e.sei(e.gei(n,""),"view"),b:e.o(d=>a.selectAndUpload())}}const i=e._export_sfc(r,[["render",c]]);wx.createComponent(i);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pagesChat/components/image-upload/image-upload.js.map
