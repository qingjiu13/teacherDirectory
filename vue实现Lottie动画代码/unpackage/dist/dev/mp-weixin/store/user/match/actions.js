"use strict";const I=require("../APIroute/match_api/match_api.js"),O=({commit:e,rootState:t,state:s},r={})=>{const n=t.user.baseInfo.id,c=r.loadMore===!0,o=c?s.currentPage+1:1,a={mathId:s.nonProfessionalList.math.selectedId,englishId:s.nonProfessionalList.english.selectedId,politicsId:s.nonProfessionalList.politics.selectedId,otherId:s.nonProfessionalList.other.selectedId},E={userId:n,schoolId:s.schoolList.selectedSchoolId,professionalId:s.professionalList.selectedMajorId,nonProfessionalList:a,sortModeId:s.sortMode.selectedId,currentPage:o,pageSize:r.pageSize||s.pageSize};return new Promise((i,S)=>{I.getMatchTeacherList(E).then(d=>{d&&d.data&&(e(c?"APPEND_MATCH_LIST":"SET_MATCH_LIST",d.data),e("SET_PAGINATION",{currentPage:o,hasMore:d.hasMore||!1})),i(d)}).catch(d=>{S(d)})})},h=({commit:e,rootState:t,state:s},{keyword:r,loadMore:n=!1})=>{const c=t.user.baseInfo.id,o=n?s.schoolList.currentPage+1:1;e("SET_SCHOOL_PAGINATION",{isLoading:!0}),n||e("SET_SCHOOL_SEARCH_KEYWORD",r);const a={userId:c,keyword:r,currentPage:o,pageSize:s.schoolList.pageSize};return new Promise((E,i)=>{I.searchSchoolList(a).then(S=>{S&&S.data&&(e("SET_SCHOOL_OPTIONS",{options:S.data,isLoadMore:n}),e("SET_SCHOOL_PAGINATION",{currentPage:o,hasMore:S.hasMore||!1,isLoading:!1})),E(S)}).catch(S=>{e("SET_SCHOOL_PAGINATION",{isLoading:!1}),i(S)})})},l=({commit:e,rootState:t,state:s},{keyword:r})=>{const n=t.user.baseInfo.id,c=s.schoolList.selectedSchoolId;if(!c)return Promise.reject(new Error("请先选择学校"));e("SET_PROFESSIONAL_SEARCH_KEYWORD",r);const o={userId:n,schoolId:c,keyword:r};return new Promise((a,E)=>{I.searchMajorList(o).then(i=>{i&&i.data&&e("SET_PROFESSIONAL_OPTIONS",i.data),a(i)}).catch(i=>{E(i)})})},_=({commit:e,rootState:t},{type:s})=>{const n={userId:t.user.baseInfo.id,type:s};return new Promise((c,o)=>{I.getNonProfessionalOptions(n).then(a=>{c(a)}).catch(a=>{o(a)})})},L=({commit:e,rootState:t})=>{const r={userId:t.user.baseInfo.id};return new Promise((n,c)=>{I.getSortModeOptions(r).then(o=>{o&&o.data&&e("SET_SORT_OPTIONS",o.data),n(o)}).catch(o=>{c(o)})})},T=({commit:e},{id:t,name:s})=>{e("SET_SELECTED_SCHOOL",{id:t,name:s}),e("SET_SELECTED_PROFESSIONAL",{id:null,name:""}),e("SET_PROFESSIONAL_OPTIONS",[])},u=({commit:e},{id:t,name:s})=>{e("SET_SELECTED_PROFESSIONAL",{id:t,name:s}),e("CLEAR_NON_PROFESSIONAL_SELECTION")},P=({commit:e},{type:t,id:s,name:r})=>{e("SET_NON_PROFESSIONAL_SELECTION",{type:t,id:s,name:r}),e("SET_SELECTED_PROFESSIONAL",{id:null,name:""})},f=({commit:e},{id:t,name:s})=>{e("SET_SELECTED_SORT_MODE",{id:t,name:s})},N=({commit:e,rootState:t},{teacherId:s})=>{const r=t.user.baseInfo.id;if(!s)return Promise.reject(new Error("老师ID不能为空"));const n={userId:r,teacherId:s};return new Promise((c,o)=>{I.getTeacherDetail(n).then(a=>{a&&a.data&&e("SET_TEACHER_DETAIL",{teacherId:s,detail:a.data}),c(a)}).catch(a=>{o(a)})})},A={fetchMatchTeacherList:O,searchSchools:h,searchMajors:l,fetchNonProfessionalOptions:_,fetchSortModeOptions:L,selectSchool:T,selectMajor:u,selectNonProfessional:P,selectSortMode:f,fetchTeacherDetail:N};exports.actions=A;
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/store/user/match/actions.js.map
