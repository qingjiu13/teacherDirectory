"use strict";const e=require("./common/vendor.js"),u=require("./components/timeStamp.js"),h=require("./common/assets.js"),g=e.defineComponent({name:"HistorySidebar",props:{visible:{type:Boolean,default:!1},groupedHistory:{type:Object,default:()=>new UTSJSONObject({today:[],week:[],month:[]})},currentChatId:{type:String,default:""}},computed:Object.assign(Object.assign({},e.mapState(new UTSJSONObject({conversations:(a=null)=>{try{return a.user&&a.user.aiChat&&a.user.aiChat.aiChat?a.user.aiChat.aiChat.conversations||[]:[]}catch(s){return e.index.__f__("error","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:145","获取 conversations 状态出错:",s),[]}},activeConversation:(a=null)=>{try{return a.user&&a.user.aiChat&&a.user.aiChat.aiChat?a.user.aiChat.aiChat.activeConversation:null}catch(s){return e.index.__f__("error","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:155","获取 activeConversation 状态出错:",s),null}}}))),{groupedConversationsByDate(){const a=new Date,s=new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime(),o=s-7*24*60*60*1e3,c=s-30*24*60*60*1e3,n=new UTSJSONObject({today:[],week:[],month:[]});return this.conversations.forEach((r=null)=>{const t=r.updatedAt||r.createdAt,d=u.formatTimestamp(t);e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:186",`对话 ${r.id} 的时间: ${d}, 时间戳: ${t}`),t>=s?n.today.push(r):t>=o?n.week.push(r):t>=c&&n.month.push(r)}),["today","week","month"].forEach(r=>{n[r].sort((t=null,d=null)=>{const _=t.updatedAt||t.createdAt;return(d.updatedAt||d.createdAt)-_})}),n},hasAnyHistory(){const a=this.groupedHistory;return a.today&&a.today.length||a.week&&a.week.length||a.month&&a.month.length}}),created(){e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:220","=================== 调试信息开始 ==================="),e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:221","完整的 Vuex store:",this.$store),e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:222","Vuex store状态:",this.$store.state),this.$store.state.user?(e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:225","user模块状态:",this.$store.state.user),this.$store.state.user.aiChat?(e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:228","aiChat模块状态:",this.$store.state.user.aiChat),this.$store.state.user.aiChat.aiChat?(e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:231","内层 aiChat:",this.$store.state.user.aiChat.aiChat),e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:232","内层 aiChat conversations:",this.$store.state.user.aiChat.aiChat.conversations)):(e.index.__f__("error","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:234","无法访问内层 aiChat!"),e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:235","aiChat 模块完整内容:",UTS.JSON.stringify(this.$store.state.user.aiChat)))):e.index.__f__("error","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:238","无法访问 aiChat 模块!")):e.index.__f__("error","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:241","无法访问 user 模块!"),e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:244","组件计算的 conversations:",this.conversations),e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:245","组件计算的 historySummaries:",this.historySummaries),e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:246","组件计算的 currentChatId:",this.currentChatId),e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:247","=================== 调试信息结束 ===================")},mounted(){this.initConversationGroups()},methods:Object.assign(Object.assign({},e.mapActions(new UTSJSONObject({setActiveConversation:"user/aiChat/setCurrentChat",deleteConversation:"user/aiChat/deleteChat"}))),{initConversationGroups(){const a=this.groupedConversationsByDate;this.$emit("updateGroups",a)},formatDate(a=null,s="YYYY-MM-DD"){return u.formatTimestamp(a,s)},getModeLabel(a=null){return new UTSJSONObject({general:"通用",school:"择校",career:"职业规划"})[a]||"通用"},loadChatHistory(a=null){this.setActiveConversation(a),this.$emit("loadChat",a)},deleteChatHistory(a=null,s=null){s&&(s.stopPropagation(),s.preventDefault()),e.index.__f__("log","at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:319","删除历史记录:",a),this.deleteConversation(a),this.$emit("deleteChat",a)}})});function l(a,s,o,c,n,r){return e.e({a:o.groupedHistory.today&&o.groupedHistory.today.length},o.groupedHistory.today&&o.groupedHistory.today.length?{b:e.f(o.groupedHistory.today,(t,d,_)=>e.e({a:o.currentChatId===t.id},o.currentChatId===t.id?e.e({b:e.t(t.abstract||t.title),c:t.chatMode},t.chatMode?{d:e.t(r.getModeLabel(t.chatMode))}:{},{e:h._imports_0$7,f:e.o(i=>r.deleteChatHistory(t.id,i),t.id),g:e.o(i=>r.loadChatHistory(t.id),t.id)}):e.e({h:e.t(t.abstract||t.title),i:t.chatMode},t.chatMode?{j:e.t(r.getModeLabel(t.chatMode))}:{},{k:h._imports_0$7,l:e.o(i=>r.deleteChatHistory(t.id,i),t.id),m:e.o(i=>r.loadChatHistory(t.id),t.id)}),{n:t.id,o:o.currentChatId===t.id?1:""}))}:{},{c:o.groupedHistory.week&&o.groupedHistory.week.length},o.groupedHistory.week&&o.groupedHistory.week.length?{d:e.f(o.groupedHistory.week,(t,d,_)=>e.e({a:o.currentChatId===t.id},o.currentChatId===t.id?e.e({b:e.t(t.abstract||t.title),c:t.chatMode},t.chatMode?{d:e.t(r.getModeLabel(t.chatMode))}:{},{e:h._imports_0$7,f:e.o(i=>r.deleteChatHistory(t.id,i),t.id),g:e.o(i=>r.loadChatHistory(t.id),t.id)}):e.e({h:e.t(t.abstract||t.title),i:t.chatMode},t.chatMode?{j:e.t(r.getModeLabel(t.chatMode))}:{},{k:h._imports_0$7,l:e.o(i=>r.deleteChatHistory(t.id,i),t.id),m:e.o(i=>r.loadChatHistory(t.id),t.id)}),{n:t.id,o:o.currentChatId===t.id?1:""}))}:{},{e:o.groupedHistory.month&&o.groupedHistory.month.length},o.groupedHistory.month&&o.groupedHistory.month.length?{f:e.f(o.groupedHistory.month,(t,d,_)=>e.e({a:o.currentChatId===t.id},o.currentChatId===t.id?e.e({b:e.t(t.abstract||t.title),c:t.chatMode},t.chatMode?{d:e.t(r.getModeLabel(t.chatMode))}:{},{e:h._imports_0$7,f:e.o(i=>r.deleteChatHistory(t.id,i),t.id),g:e.o(i=>r.loadChatHistory(t.id),t.id)}):e.e({h:e.t(t.abstract||t.title),i:t.chatMode},t.chatMode?{j:e.t(r.getModeLabel(t.chatMode))}:{},{k:h._imports_0$7,l:e.o(i=>r.deleteChatHistory(t.id,i),t.id),m:e.o(i=>r.loadChatHistory(t.id),t.id)}),{n:t.id,o:o.currentChatId===t.id?1:""}))}:{},{g:!r.hasAnyHistory},r.hasAnyHistory?{}:{},{h:e.sei(e.gei(a,""),"view"),i:o.visible?1:""})}const y=e._export_sfc(g,[["render",l]]);exports.Component=y;
//# sourceMappingURL=../.sourcemap/mp-weixin/HistorySidebar.js.map
