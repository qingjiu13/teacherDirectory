"use strict";const n=require("../common/vendor.js");class o{constructor(){this.isConnected=!1,this.connectionListeners=new Set,this.currentConversationId=null}setConnectionStatus(e,t=null){const s=this.isConnected;this.isConnected=e,this.currentConversationId=t,n.index.__f__("log","at utils/websocketManager.js:23","[WebSocket管理] 状态变更:",{connected:e,conversationId:t,previousStatus:s}),this.notifyListeners()}getConnectionStatus(){return this.isConnected}getCurrentConversationId(){return this.currentConversationId}addConnectionListener(e){this.connectionListeners.add(e)}removeConnectionListener(e){this.connectionListeners.delete(e)}notifyListeners(){this.connectionListeners.forEach(e=>{try{e(this.isConnected,this.currentConversationId)}catch(t){n.index.__f__("error","at utils/websocketManager.js:73","[WebSocket管理] 通知监听器失败:",t)}})}cleanup(){this.isConnected=!1,this.currentConversationId=null,this.connectionListeners.clear(),n.index.__f__("log","at utils/websocketManager.js:85","[WebSocket管理] 清理完成")}}const i=new o;exports.websocketManager=i;
//# sourceMappingURL=../../.sourcemap/mp-weixin/utils/websocketManager.js.map
