"use strict";const a=require("../common/vendor.js");class s{constructor(){this.currentPage=null,this.pageStack=[],this.pageListeners=new Set}setCurrentPage(e,t={}){const r=this.currentPage;this.currentPage=e,a.index.__f__("log","at utils/pageStateManager.js:22","[页面状态管理] 页面切换:",{from:r,to:e,options:t}),this.updatePageStack(e,t),this.notifyListeners()}getCurrentPage(){return this.currentPage}getPageStack(){return[...this.pageStack]}updatePageStack(e,t={}){t.isBack?this.pageStack.pop():this.pageStack.push({name:e,timestamp:Date.now(),options:t}),this.pageStack.length>10&&(this.pageStack=this.pageStack.slice(-10))}addPageListener(e){this.pageListeners.add(e)}removePageListener(e){this.pageListeners.delete(e)}notifyListeners(){this.pageListeners.forEach(e=>{try{e(this.currentPage,this.pageStack)}catch(t){a.index.__f__("error","at utils/pageStateManager.js:99","[页面状态管理] 通知监听器失败:",t)}})}isInPage(e){return this.currentPage===e}isInChatPage(){return this.currentPage==="chat-box"||this.currentPage==="chat-list"}cleanup(){this.currentPage=null,this.pageStack=[],this.pageListeners.clear(),a.index.__f__("log","at utils/pageStateManager.js:128","[页面状态管理] 清理完成")}}const i=new s;exports.pageStateManager=i;
//# sourceMappingURL=../../.sourcemap/mp-weixin/utils/pageStateManager.js.map
