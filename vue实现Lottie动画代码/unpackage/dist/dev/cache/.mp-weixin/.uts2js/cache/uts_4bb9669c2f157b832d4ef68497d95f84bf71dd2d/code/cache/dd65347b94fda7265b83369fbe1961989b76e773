{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\n/**\n * @description 我的页面（通用）\n */\nimport { Navigator, MineRoutes } from '@/router/Router.js';\nimport TabBar from '../../../components/tab-bar/tab-bar.vue';\nimport store from '@/store/index.js';\nimport { mapState, mapGetters, mapActions } from 'vuex';\nexport default defineComponent(new UTSJSONObject({\n    components: {\n        TabBar\n    },\n    data() {\n        return {\n            userName: '',\n            userData: new UTSJSONObject({}),\n            isLoggedIn: false,\n            MineRoutes,\n            isLoading: false\n        };\n    },\n    computed: new UTSJSONObject(Object.assign({}, mapGetters('user/baseInfo', [\n        'profile',\n        'userRole',\n        'isTeacher'\n    ]))),\n    onLoad() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this.loadUserData();\n            }\n            catch (error) {\n                uni.__f__('error', 'at pages/mine/mine/mine_common.vue:118', 'onLoad错误:', error);\n            }\n        });\n    },\n    onShow() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const storedUserRole = uni.getStorageSync('userRole');\n                if (storedUserRole) {\n                    yield this.updateUserRole(storedUserRole);\n                    yield this.loadUserData();\n                }\n                else {\n                    if (!this.profile || !this.profile.nickname) {\n                        yield this.loadUserData();\n                    }\n                    else {\n                        this.userData = new UTSJSONObject(Object.assign({}, this.profile));\n                        this.userName = this.profile.nickname || '用户';\n                    }\n                }\n            }\n            catch (error) {\n                uni.__f__('error', 'at pages/mine/mine/mine_common.vue:137', 'onShow错误:', error);\n            }\n        });\n    },\n    methods: new UTSJSONObject(Object.assign(Object.assign({}, mapActions('user/baseInfo', [\n        'getUserInfo',\n        'updateRole'\n    ])), { \n        /**\n         * @description 更新用户角色\n         * @param {string} role - 用户角色\n         */\n        updateUserRole(role = null) {\n            return __awaiter(this, void 0, void 0, function* () {\n                try {\n                    // 使用映射的action更新角色\n                    yield this.updateRole(role);\n                }\n                catch (error) {\n                    uni.__f__('error', 'at pages/mine/mine/mine_common.vue:157', '更新用户角色失败', error);\n                    // 本地存储作为备份\n                    uni.setStorageSync('userRole', role);\n                }\n            });\n        },\n        /**\n         * @description 加载用户数据\n         */\n        loadUserData() {\n            return __awaiter(this, void 0, void 0, function* () {\n                this.isLoading = true;\n                try {\n                    yield this.syncUserDataFromVuex();\n                }\n                catch (error) {\n                    uni.__f__('error', 'at pages/mine/mine/mine_common.vue:172', '加载用户数据失败', error);\n                }\n                finally {\n                    this.isLoading = false;\n                }\n            });\n        },\n        /**\n         * @description 从Vuex同步用户数据\n         */\n        syncUserDataFromVuex() {\n            return __awaiter(this, void 0, void 0, function* () {\n                try {\n                    // 使用映射的action获取用户信息\n                    const result = yield this.getUserInfo();\n                    if (result && result.nickname) {\n                        this.userData = new UTSJSONObject(Object.assign({}, result));\n                        this.userName = result.nickname || '用户';\n                        this.isLoggedIn = true;\n                    }\n                    else if (this.profile && this.profile.nickname) {\n                        this.userData = new UTSJSONObject(Object.assign({}, this.profile));\n                        this.userName = this.profile.nickname || '用户';\n                        this.isLoggedIn = true;\n                    }\n                }\n                catch (error) {\n                    uni.__f__('error', 'at pages/mine/mine/mine_common.vue:196', '同步用户数据失败', error);\n                }\n            });\n        },\n        /**\n         * @description 处理头像点击\n         */\n        handleAvatarClick() {\n            this.handleEditProfile();\n        },\n        /**\n         * @description 处理登录文本点击\n         */\n        handleLoginClick() {\n            if (this.isLoggedIn) {\n                this.handleEditProfile();\n            }\n            else {\n                // 未登录时导航到登录页\n                Navigator.toLogin();\n            }\n        },\n        /**\n         * @description 跳转到修改个人信息页面\n         */\n        handleEditProfile() {\n            Navigator.toModify();\n        },\n        /**\n         * @description 页面跳转方法\n         * @param {string} url - 目标页面路径\n         */\n        navigateTo(url = null) {\n            Navigator.navigateTo(url);\n        } }))\n}));\n//# sourceMappingURL=E:/yanshilu%E9%87%8D%E6%96%B0%E6%9D%A5%E8%BF%87/vue%E5%AE%9E%E7%8E%B0Lottie%E5%8A%A8%E7%94%BB%E4%BB%A3%E7%A0%81/pages/mine/mine/mine_common.vue?vue&type=script&lang.uts.js.map","references":["E:/yanshilu重新来过/vue实现Lottie动画代码/router/Router.js","E:/yanshilu重新来过/vue实现Lottie动画代码/components/tab-bar/tab-bar.vue.ts","E:/yanshilu重新来过/vue实现Lottie动画代码/store/index.js","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/vuex/types/index.d.ts"],"uniExtApis":["uni.__f__","uni.getStorageSync","uni.setStorageSync"],"map":"{\"version\":3,\"file\":\"mine_common.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"mine_common.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
