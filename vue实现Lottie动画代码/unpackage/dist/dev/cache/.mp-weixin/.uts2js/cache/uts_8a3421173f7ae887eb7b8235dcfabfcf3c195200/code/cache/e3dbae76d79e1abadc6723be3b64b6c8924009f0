{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\n/**\n * @description 设置页面\n */\nimport { Navigator } from '@/router/Router.js';\nimport store from '@/store';\nimport { USE_MOCK_DATA, getApiImplementation } from '@/store/user/baseInfo/config.js';\nexport default defineComponent({\n    data() {\n        return {\n            isLoggedIn: true,\n            switching: false,\n            useMockData: false,\n            mockUserInfo: '' // 当前模拟用户信息\n        };\n    },\n    computed: {\n        // 直接从store获取数据，替代mapGetters\n        isTeacher() {\n            return store.getters['user/baseInfo/isTeacher'];\n        },\n        userRole() {\n            return store.getters['user/baseInfo/userRole'];\n        },\n        profile() {\n            return store.getters['user/baseInfo/profile'];\n        },\n        isStudent() {\n            return !this.isTeacher;\n        }\n    },\n    onLoad() {\n        // 检查登录状态\n        const token = uni.getStorageSync('token');\n        this.isLoggedIn = !!token;\n        // 检查模拟数据设置\n        this.checkMockDataStatus();\n        // 获取模拟用户信息\n        this.getMockUserInfo();\n    },\n    methods: {\n        // 直接调用store的dispatch方法，替代mapActions\n        /**\n         * @description 检查模拟数据状态\n         */\n        checkMockDataStatus() {\n            // 首先检查全局配置\n            this.useMockData = USE_MOCK_DATA;\n            // 然后检查本地存储设置，优先使用本地存储的设置\n            const localMockSetting = uni.getStorageSync('use_mock_api');\n            if (localMockSetting !== '') {\n                this.useMockData = localMockSetting === 'true';\n            }\n            uni.__f__('log', 'at pages/mine/settings.vue:118', '当前模拟数据状态:', this.useMockData ? '使用模拟数据' : '使用真实API');\n        },\n        /**\n         * @description 获取模拟用户信息\n         */\n        getMockUserInfo() {\n            return __awaiter(this, void 0, void 0, function* () {\n                if (this.useMockData) {\n                    try {\n                        yield store.dispatch('user/baseInfo/getUserInfo');\n                        this.mockUserInfo = `${this.profile.nickname || '未登录'} (${this.isTeacher ? '老师' : '学生'})`;\n                    }\n                    catch (error) {\n                        uni.__f__('error', 'at pages/mine/settings.vue:130', '获取模拟用户信息失败:', error);\n                        this.mockUserInfo = '未知用户';\n                    }\n                }\n                else {\n                    this.mockUserInfo = '';\n                }\n            });\n        },\n        /**\n         * @description 处理切换身份\n         */\n        handleSwitchRole() {\n            if (this.switching)\n                return null;\n            // 确定切换的目标角色\n            const newRole = this.isTeacher ? 'student' : 'teacher';\n            uni.showModal({\n                title: '切换身份',\n                content: `确定要切换到${newRole === 'teacher' ? '老师' : '学生'}模式吗？`,\n                success: (res) => { return __awaiter(this, void 0, void 0, function* () {\n                    if (res.confirm) {\n                        try {\n                            this.switching = true;\n                            // 使用store.dispatch调用action\n                            yield store.dispatch('user/baseInfo/updateRole', newRole);\n                            uni.showToast({\n                                title: newRole === 'teacher' ? '已切换为老师模式' : '已切换为学生模式',\n                                icon: 'none'\n                            });\n                            // 返回到\"我的\"页面并刷新\n                            setTimeout(() => {\n                                Navigator.reLaunch('/pages/mine/mine/mine_common');\n                            }, 1500);\n                        }\n                        catch (error) {\n                            uni.__f__('error', 'at pages/mine/settings.vue:168', '切换角色失败:', error);\n                            uni.showToast({\n                                title: '切换角色失败',\n                                icon: 'none'\n                            });\n                        }\n                        finally {\n                            this.switching = false;\n                        }\n                    }\n                }); }\n            });\n        },\n        /**\n         * @description 处理联系我们\n         */\n        handleContactUs() {\n            uni.showModal({\n                title: '联系我们',\n                content: '客服电话：400-123-4567\\n客服邮箱：support@example.com\\n工作时间：周一至周五 9:00-18:00',\n                showCancel: false\n            });\n        },\n        /**\n         * @description 处理退出登录\n         */\n        handleLogout() {\n            uni.showModal({\n                title: '提示',\n                content: '确定要退出登录吗？',\n                success: (res) => { return __awaiter(this, void 0, void 0, function* () {\n                    if (res.confirm) {\n                        try {\n                            // 使用store.dispatch调用登出action\n                            yield store.dispatch('user/baseInfo/logout');\n                            uni.showToast({\n                                title: '已退出登录',\n                                icon: 'success'\n                            });\n                            // 增加延迟确保数据清除\n                            setTimeout(() => {\n                                // 返回到\"我的\"页面\n                                Navigator.reLaunch('/pages/mine/mine/mine_common');\n                            }, 1500);\n                        }\n                        catch (error) {\n                            uni.__f__('error', 'at pages/mine/settings.vue:216', '退出登录时出错:', error);\n                            uni.showToast({\n                                title: '退出登录时出错',\n                                icon: 'none'\n                            });\n                        }\n                    }\n                }); }\n            });\n        },\n        /**\n         * @description 切换模拟数据开关\n         */\n        toggleMockData() {\n            // 切换设置\n            this.useMockData = !this.useMockData;\n            // 保存设置\n            uni.setStorageSync('use_mock_api', this.useMockData ? 'true' : 'false');\n            // 更新模拟用户信息\n            this.getMockUserInfo();\n            uni.showToast({\n                title: this.useMockData ? '已开启模拟数据' : '已关闭模拟数据',\n                icon: 'none'\n            });\n            // 提示需要重启应用\n            setTimeout(() => {\n                uni.showModal({\n                    title: '提示',\n                    content: '设置已更改，推荐刷新或重启应用以使更改完全生效',\n                    showCancel: true,\n                    confirmText: '刷新',\n                    success: (res) => {\n                        if (res.confirm) {\n                            // 刷新当前页面\n                            Navigator.reLaunch('/pages/mine/settings');\n                        }\n                    }\n                });\n            }, 1000);\n        }\n    }\n});\n//# sourceMappingURL=D:/github/teacherDirectory/vue%E5%AE%9E%E7%8E%B0Lottie%E5%8A%A8%E7%94%BB%E4%BB%A3%E7%A0%81/pages/mine/settings.vue?vue&type=script&lang.uts.js.map","references":["D:/github/teacherDirectory/vue实现Lottie动画代码/router/Router.js","D:/github/teacherDirectory/vue实现Lottie动画代码/store/index.js","D:/github/teacherDirectory/vue实现Lottie动画代码/store/user/baseInfo/config.js"],"uniExtApis":["uni.getStorageSync","uni.__f__","uni.showModal","uni.showToast","uni.setStorageSync"],"map":"{\"version\":3,\"file\":\"settings.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"settings.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
