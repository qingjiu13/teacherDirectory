{"code":"import { defineComponent } from \"vue\";\nimport { Navigator } from '../../router/Router';\nimport { mapState } from 'vuex';\nexport default defineComponent(new UTSJSONObject({\n    data() {\n        return {\n            hasLogin: false,\n            userInfo: new UTSJSONObject({\n                nickName: '',\n                avatarUrl: ''\n            }),\n            showAgreementModal: false,\n            showPrivacyModal: false\n        };\n    },\n    computed: new UTSJSONObject(Object.assign({}, mapState(['isRegistered']))),\n    onLoad() {\n        this.checkLoginStatus();\n    },\n    methods: new UTSJSONObject({\n        // 检查登录状态\n        checkLoginStatus() {\n            const userInfo = uni.getStorageSync('userInfo');\n            const token = uni.getStorageSync('token');\n            if (userInfo && token) {\n                this.userInfo = userInfo;\n                this.hasLogin = true;\n            }\n        },\n        // 获取用户信息\n        onGetUserInfo(e = null) {\n            if (e.detail.errMsg === 'getUserInfo:ok') {\n                // 用户授权成功\n                this.userInfo = e.detail.userInfo;\n                this.loginWithWechat();\n            }\n            else {\n                // 用户拒绝授权\n                uni.showToast({\n                    title: '您已拒绝授权',\n                    icon: 'none'\n                });\n            }\n        },\n        // 微信登录\n        loginWithWechat() {\n            uni.showLoading({\n                title: '登录中...'\n            });\n            // 这里替换为你的实际登录逻辑\n            // 1. 调用微信登录接口获取code\n            uni.login(new UTSJSONObject({\n                provider: 'weixin',\n                success: (loginRes) => {\n                    // 2. 将code发送到你的后端服务器获取token\n                    // 这里模拟一个登录请求\n                    setTimeout(() => {\n                        uni.hideLoading();\n                        // 模拟登录成功\n                        const token = 'mock_token_' + Date.now();\n                        uni.setStorageSync('token', token);\n                        uni.setStorageSync('userInfo', this.userInfo);\n                        this.hasLogin = true;\n                        uni.showToast({\n                            title: '登录成功',\n                            icon: 'success'\n                        });\n                        // 登录成功后跳转页面\n                        this.toHome();\n                    }, 1500);\n                },\n                fail: (err) => {\n                    uni.hideLoading();\n                    uni.showToast({\n                        title: '登录失败',\n                        icon: 'none'\n                    });\n                    uni.__f__('error', 'at pages/login/wechat_login.vue:172', '微信登录失败:', err);\n                }\n            }));\n        },\n        /**\n         * 根据注册状态跳转到相应页面\n         * @returns {void}\n         */\n        toHome() {\n            // 如果已经注册过，则跳转到主页\n            if (this.isRegistered) {\n                Navigator.toIndex();\n            }\n            else {\n                // 如果未注册过，使用原有的跳转逻辑\n                Navigator.toLogin();\n            }\n        },\n        /**\n         * 显示用户协议弹窗\n         * @returns {void}\n         */\n        showAgreement() {\n            this.showAgreementModal = true;\n        },\n        /**\n         * 显示隐私政策弹窗\n         * @returns {void}\n         */\n        showPrivacy() {\n            this.showPrivacyModal = true;\n        },\n        /**\n         * 关闭弹窗\n         * @param {string} type - 要关闭的弹窗类型（'agreement'或'privacy'）\n         * @returns {void}\n         */\n        closeModal(type = null) {\n            if (type === 'agreement') {\n                this.showAgreementModal = false;\n            }\n            else if (type === 'privacy') {\n                this.showPrivacyModal = false;\n            }\n        }\n    })\n}));\n//# sourceMappingURL=E:/%E7%A0%94%E5%B8%88%E5%BD%95%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/teacherDirectory/vue%E5%AE%9E%E7%8E%B0Lottie%E5%8A%A8%E7%94%BB%E4%BB%A3%E7%A0%81/pages/login/wechat_login.vue?vue&type=script&lang.uts.js.map","references":["E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/router/Router.js","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/vuex/types/index.d.ts"],"uniExtApis":["uni.getStorageSync","uni.showToast","uni.showLoading","uni.login","uni.hideLoading","uni.setStorageSync","uni.__f__"],"map":"{\"version\":3,\"file\":\"wechat_login.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"wechat_login.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
