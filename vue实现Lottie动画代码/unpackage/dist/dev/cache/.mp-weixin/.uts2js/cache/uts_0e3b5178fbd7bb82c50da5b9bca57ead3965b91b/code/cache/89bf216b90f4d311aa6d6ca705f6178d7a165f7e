{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\nimport choiceSelected from '../../components/combobox/combobox';\nimport CascadeContainer from '../../components/cascade-container/cascade-container';\nimport { Navigator } from '@/router/Router.js';\nimport store from '@/store/index.js';\nimport { mapState, mapGetters } from 'vuex';\nexport default defineComponent({\n    components: {\n        choiceSelected,\n        CascadeContainer\n    },\n    data() {\n        return {\n            // 筛选相关数据\n            sortList: [\n                new UTSJSONObject({\n                    choiceItemContent: '综合排序',\n                    choiceItemValue: 'comprehensive'\n                }),\n                new UTSJSONObject({\n                    choiceItemContent: '评分最高',\n                    choiceItemValue: 'score_desc'\n                }),\n                new UTSJSONObject({\n                    choiceItemContent: '价格最低',\n                    choiceItemValue: 'price_asc'\n                }),\n                new UTSJSONObject({\n                    choiceItemContent: '价格最高',\n                    choiceItemValue: 'price_desc'\n                })\n            ],\n            // 排序筛选\n            tempSelectedSort: '综合排序',\n            // 下拉框索引\n            sortIndex: -1,\n            // 页面状态\n            isLoading: false,\n        };\n    },\n    computed: new UTSJSONObject(Object.assign(Object.assign({}, mapGetters('match', ['filteredMatchList', 'teacherInfo'])), { \n        /**\n         * @description 获取页面展示的老师列表\n         * @returns {Array} 要展示的老师列表\n         */\n        matchTeachers() {\n            return this.filteredMatchList || [];\n        } })),\n    onLoad() {\n        uni.__f__('log', 'at pages/match/match.vue:114', '匹配页面已加载');\n        // 初始化页面数据\n        this.initPage();\n    },\n    methods: {\n        /**\n         * @description 初始化页面\n         */\n        initPage() {\n            return __awaiter(this, void 0, void 0, function* () {\n                // 每次页面初始化时都重新加载数据\n                uni.__f__('log', 'at pages/match/match.vue:124', '初始化页面 - 开始加载数据');\n                yield this.loadData(true);\n            });\n        },\n        /**\n         * @description 获取老师的一对一辅导服务价格\n         * @param {Object} teacher - 老师对象\n         * @returns {String} 格式化后的价格，如果没有一对一辅导服务则返回\"暂无价格\"\n         */\n        getOneOnOnePrice(teacher = null) {\n            if (!teacher || !teacher.service || teacher.service.length === 0) {\n                return \"暂无一对一辅导价格\";\n            }\n            // 查找类型为\"一对一辅导\"的服务\n            const oneOnOneService = teacher.service.find((s = null) => { return s.type === '一对一辅导'; });\n            if (oneOnOneService && oneOnOneService.price) {\n                return `¥${oneOnOneService.price}/小时`;\n            }\n            else {\n                return \"暂无价格\";\n            }\n        },\n        /**\n         * @description 处理筛选器应用事件\n         * @param {Object} filters - 筛选条件对象\n         */\n        onFilterApply(filters = null) {\n            uni.__f__('log', 'at pages/match/match.vue:153', '应用筛选条件:', filters);\n            // 设置临时选择变量\n            this.tempSelectedSchool = filters.school;\n            this.tempSelectedMajor = filters.major;\n            this.tempSelectedSubject = filters.subject;\n            // 应用筛选\n            this.applyFilter();\n        },\n        /**\n         * @description 加载数据\n         * @param {Boolean} forceRefresh - 是否强制刷新数据\n         */\n        loadData(forceRefresh = false) {\n            return __awaiter(this, void 0, void 0, function* () {\n                try {\n                    this.isLoading = true;\n                    // 显示加载提示\n                    uni.showLoading({\n                        title: '加载中...'\n                    });\n                    // 从级联选择器中获取筛选值\n                    const cascadeValues = this.$refs.cascadeFilter ?\n                        this.$refs.cascadeFilter.getSelectedValues() : new UTSJSONObject({ school: '', major: '', subject: '' });\n                    // 构建筛选条件对象\n                    const filters = new UTSJSONObject({\n                        school: cascadeValues.school,\n                        major: cascadeValues.major,\n                        subject: cascadeValues.subject,\n                        sort: this.tempSelectedSort\n                    });\n                    // 如果强制刷新或者有筛选条件，则重新获取数据\n                    if (forceRefresh || filters.school || filters.major || filters.subject || filters.sort !== '综合排序') {\n                        // 调用Vuex action获取数据\n                        yield store.dispatch('match/getFilteredMatchList', filters);\n                    }\n                    else if (this.matchTeachers && this.matchTeachers.length > 0) {\n                        // 如果有缓存数据且没有筛选条件，则使用缓存数据\n                        uni.__f__('log', 'at pages/match/match.vue:194', '使用已缓存的数据');\n                    }\n                    else {\n                        // 没有缓存数据，也需要获取\n                        yield store.dispatch('match/getFilteredMatchList', filters);\n                    }\n                }\n                catch (error) {\n                    uni.__f__('error', 'at pages/match/match.vue:200', '加载数据失败:', error);\n                    // 显示错误信息\n                    uni.showToast({\n                        title: error.message || '加载失败，请重试',\n                        icon: 'none'\n                    });\n                }\n                finally {\n                    this.isLoading = false;\n                    uni.hideLoading();\n                }\n            });\n        },\n        /**\n         * @description 加载更多数据\n         */\n        loadMore() {\n            return __awaiter(this, void 0, void 0, function* () {\n                // 滚动到底部时加载更多数据\n                uni.__f__('log', 'at pages/match/match.vue:217', '加载更多数据');\n                // 在实际应用中，这里应该触发新的API请求，加载下一页数据\n            });\n        },\n        // 页面点击事件\n        onPageClick() {\n            // 关闭所有下拉框\n            // 1. 关闭排序选择下拉框\n            let comboboxComponents = this.$children.filter(child => { return child.$options.name === 'ChoiceSelected'; });\n            comboboxComponents.forEach(component => {\n                if (component.closeDropdown) {\n                    component.closeDropdown();\n                }\n            });\n            // 2. 关闭级联选择器下拉框\n            if (this.$refs.cascadeFilter) {\n                const cascadeSelectors = this.$refs.cascadeFilter.$children.filter((child = null) => {\n                    return child.$options.name === 'CascadeSelector';\n                });\n                cascadeSelectors.forEach((selector = null) => {\n                    if (selector.closeDropdown) {\n                        selector.closeDropdown();\n                    }\n                });\n            }\n        },\n        // 应用筛选\n        applyFilter() {\n            return __awaiter(this, void 0, void 0, function* () {\n                // 重新加载数据，强制刷新\n                yield this.loadData(true);\n            });\n        },\n        // 排序下拉框选择处理\n        onSortClick(position = null) {\n            this.sortIndex = position;\n            // 只更新临时选择，不立即应用\n            this.tempSelectedSort = this.sortList[position].choiceItemContent;\n        },\n        /**\n         * @description 查看老师详情\n         * @param {String} teacherId - 老师ID\n         */\n        viewTeacherDetail(teacherId = null) {\n            return __awaiter(this, void 0, void 0, function* () {\n                try {\n                    // 显示加载提示\n                    uni.showLoading({\n                        title: '加载中...'\n                    });\n                    // 首先尝试从现有列表中获取老师基本信息\n                    const teacherExists = this.teacherInfo(teacherId);\n                    if (teacherExists) {\n                        // 如果老师已存在于列表中，则直接获取ID并跳转\n                        Navigator.toTeacher(teacherId);\n                    }\n                    else {\n                        // 如果老师不在列表中，则需要先获取信息\n                        yield store.dispatch('match/getTeacherById', teacherId);\n                        Navigator.toTeacher(teacherId);\n                    }\n                }\n                catch (error) {\n                    uni.__f__('error', 'at pages/match/match.vue:281', '获取老师详情失败:', error);\n                    // 显示来自后端的错误信息\n                    uni.showToast({\n                        title: error.message || '加载失败，请重试',\n                        icon: 'none'\n                    });\n                }\n                finally {\n                    uni.hideLoading();\n                }\n            });\n        },\n        /**\n         * @description 处理沟通按钮点击\n         * @param {String} teacherId - 老师ID\n         */\n        handleCommunicate(teacherId = null) {\n            // 处理沟通按钮点击事件，可以直接导航到聊天页面\n            Navigator.toChat(teacherId);\n        }\n    }\n});\n//# sourceMappingURL=E:/%E7%A0%94%E5%B8%88%E5%BD%95%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/teacherDirectory/vue%E5%AE%9E%E7%8E%B0Lottie%E5%8A%A8%E7%94%BB%E4%BB%A3%E7%A0%81/pages/match/match.vue?vue&type=script&lang.uts.js.map","references":["E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/components/combobox/combobox.vue.ts","E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/components/cascade-container/cascade-container.vue.ts","E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/router/Router.js","E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/store/index.js","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/vuex/types/index.d.ts"],"uniExtApis":["uni.__f__","uni.showLoading","uni.showToast","uni.hideLoading"],"map":"{\"version\":3,\"file\":\"match.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"match.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\";;AACC,OAAO,cAAc,MAAM,oCAAoC,CAAA;AAC/D,OAAO,gBAAgB,MAAM,sDAAsD,CAAA;AACnF,OAAO,EAAE,SAAS,EAAE,MAAM,oBAAoB,CAAA;AAC9C,OAAO,KAAK,MAAM,kBAAkB,CAAA;AACpC,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,MAAM,MAAM,CAAA;AAE3C,+BAAe;IACd,UAAU,EAAE;QACX,cAAc;QACd,gBAAgB;KAChB;IACD,IAAI;QACH,OAAO;YACN,SAAS;YACT,QAAQ,EAAE;kCACT;oBACC,iBAAiB,EAAE,MAAM;oBACzB,eAAe,EAAE,eAAe;iBAChC;kCACD;oBACC,iBAAiB,EAAE,MAAM;oBACzB,eAAe,EAAE,YAAY;iBAC7B;kCACD;oBACC,iBAAiB,EAAE,MAAM;oBACzB,eAAe,EAAE,WAAW;iBAC5B;kCACD;oBACC,iBAAiB,EAAE,MAAM;oBACzB,eAAe,EAAE,YAAY;iBAC7B;aACD;YACD,OAAO;YACP,gBAAgB,EAAE,MAAM;YACxB,QAAQ;YACR,SAAS,EAAE,CAAC,CAAC;YACb,OAAO;YACP,SAAS,EAAE,KAAK;SAChB,CAAA;IACF,CAAC;IACD,QAAQ,oDAKJ,UAAU,CAAC,OAAO,EAAE,CAAC,mBAAmB,EAAE,aAAa,CAAC,CAAC;QAE5D;;;WAGG;QACH,aAAa;YACZ,OAAO,IAAI,CAAC,iBAAiB,IAAI,EAAE,CAAC;QACrC,CAAC,IACD;IACD,MAAM;QACL,GAAG,CAAC,KAAK,CAAC,KAAK,EAAC,8BAA8B,EAAC,SAAS,CAAC,CAAC;QAC1D,UAAU;QACV,IAAI,CAAC,QAAQ,EAAE,CAAC;IACjB,CAAC;IACD,OAAO,EAAE;QACR;;WAEG;QACG,QAAQ;;gBACb,kBAAkB;gBAClB,GAAG,CAAC,KAAK,CAAC,KAAK,EAAC,8BAA8B,EAAC,gBAAgB,CAAC,CAAC;gBACjE,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YAC3B,CAAC;SAAA;QAED;;;;WAIG;QACH,gBAAgB,CAAC,OAAO,OAAA;YACvB,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;gBACjE,OAAO,WAAW,CAAC;aACnB;YAED,kBAAkB;YAClB,MAAM,eAAe,GAAG,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA,CAAC,OAAA,OAAI,OAAA,CAAC,CAAC,IAAI,KAAK,OAAO,EAAlB,CAAkB,CAAC,CAAC;YAEtE,IAAI,eAAe,IAAI,eAAe,CAAC,KAAK,EAAE;gBAC7C,OAAO,IAAI,eAAe,CAAC,KAAK,KAAK,CAAC;aACtC;iBAAM;gBACN,OAAO,MAAM,CAAC;aACd;QACF,CAAC;QAED;;;WAGG;QACH,aAAa,CAAC,OAAO,OAAA;YACpB,GAAG,CAAC,KAAK,CAAC,KAAK,EAAC,8BAA8B,EAAC,SAAS,EAAE,OAAO,CAAC,CAAC;YACnE,WAAW;YACX,IAAI,CAAC,kBAAkB,GAAG,OAAO,CAAC,MAAM,CAAC;YACzC,IAAI,CAAC,iBAAiB,GAAG,OAAO,CAAC,KAAK,CAAC;YACvC,IAAI,CAAC,mBAAmB,GAAG,OAAO,CAAC,OAAO,CAAC;YAE3C,OAAO;YACP,IAAI,CAAC,WAAW,EAAE,CAAC;QACpB,CAAC;QAED;;;WAGG;QACG,QAAQ,CAAC,YAAY,GAAG,KAAK;;gBAClC,IAAI;oBACH,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;oBACtB,SAAS;oBACT,GAAG,CAAC,WAAW,CAAC;wBACf,KAAK,EAAE,QAAQ;qBACf,CAAC,CAAC;oBAEH,eAAe;oBACf,MAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;wBAC/C,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,iBAAiB,EAAE,CAAC,CAAC,mBAC9C,EAAE,MAAM,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,CAAA,CAAC;oBAExC,WAAW;oBACX,MAAM,OAAO,qBAAG;wBACf,MAAM,EAAE,aAAa,CAAC,MAAM;wBAC5B,KAAK,EAAE,aAAa,CAAC,KAAK;wBAC1B,OAAO,EAAE,aAAa,CAAC,OAAO;wBAC9B,IAAI,EAAE,IAAI,CAAC,gBAAgB;qBAC3B,CAAA,CAAC;oBAEF,wBAAwB;oBACxB,IAAI,YAAY,IAAI,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,KAAK,IAAI,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,IAAI,KAAK,MAAM,EAAE;wBAClG,oBAAoB;wBACpB,MAAM,KAAK,CAAC,QAAQ,CAAC,4BAA4B,EAAE,OAAO,CAAC,CAAC;qBAC5D;yBAAM,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;wBAC/D,yBAAyB;wBACzB,GAAG,CAAC,KAAK,CAAC,KAAK,EAAC,8BAA8B,EAAC,UAAU,CAAC,CAAC;qBAC3D;yBAAM;wBACN,eAAe;wBACf,MAAM,KAAK,CAAC,QAAQ,CAAC,4BAA4B,EAAE,OAAO,CAAC,CAAC;qBAC5D;iBACD;gBAAC,OAAO,KAAK,EAAE;oBACf,GAAG,CAAC,KAAK,CAAC,OAAO,EAAC,8BAA8B,EAAC,SAAS,EAAE,KAAK,CAAC,CAAC;oBACnE,SAAS;oBACT,GAAG,CAAC,SAAS,CAAC;wBACb,KAAK,EAAE,KAAK,CAAC,OAAO,IAAI,UAAU;wBAClC,IAAI,EAAE,MAAM;qBACZ,CAAC,CAAC;iBACH;wBAAS;oBACT,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;oBACvB,GAAG,CAAC,WAAW,EAAE,CAAC;iBAClB;YACF,CAAC;SAAA;QAED;;WAEG;QACG,QAAQ;;gBACb,eAAe;gBACf,GAAG,CAAC,KAAK,CAAC,KAAK,EAAC,8BAA8B,EAAC,QAAQ,CAAC,CAAC;gBACzD,+BAA+B;YAChC,CAAC;SAAA;QAED,SAAS;QACT,WAAW;YACV,UAAU;YACV,eAAe;YACf,IAAI,kBAAkB,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,MAAI,OAAA,KAAK,CAAC,QAAQ,CAAC,IAAI,KAAK,gBAAgB,EAAxC,CAAwC,CAAC,CAAC;YAClG,kBAAkB,CAAC,OAAO,CAAC,SAAS;gBACnC,IAAI,SAAS,CAAC,aAAa,EAAE;oBAC5B,SAAS,CAAC,aAAa,EAAE,CAAC;iBAC1B;YACF,CAAC,CAAC,CAAC;YAEH,gBAAgB;YAChB,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE;gBAC7B,MAAM,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,CAAA,KAAK,OAAA;oBACvE,OAAA,KAAK,CAAC,QAAQ,CAAC,IAAI,KAAK,iBAAiB;gBAAzC,CAAyC,CACzC,CAAC;gBACF,gBAAgB,CAAC,OAAO,CAAC,CAAA,QAAQ,OAAA;oBAChC,IAAI,QAAQ,CAAC,aAAa,EAAE;wBAC3B,QAAQ,CAAC,aAAa,EAAE,CAAC;qBACzB;gBACF,CAAC,CAAC,CAAC;aACH;QACF,CAAC;QAED,OAAO;QACD,WAAW;;gBAChB,cAAc;gBACd,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YAC3B,CAAC;SAAA;QAED,YAAY;QACZ,WAAW,CAAC,QAAQ,OAAA;YACnB,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;YAC1B,gBAAgB;YAChB,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,iBAAiB,CAAC;QACnE,CAAC;QAED;;;WAGG;QACG,iBAAiB,CAAC,SAAS,OAAA;;gBAChC,IAAI;oBACH,SAAS;oBACT,GAAG,CAAC,WAAW,CAAC;wBACf,KAAK,EAAE,QAAQ;qBACf,CAAC,CAAC;oBAEH,qBAAqB;oBACrB,MAAM,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;oBAElD,IAAI,aAAa,EAAE;wBAClB,yBAAyB;wBACzB,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;qBAC/B;yBAAM;wBACN,qBAAqB;wBACrB,MAAM,KAAK,CAAC,QAAQ,CAAC,sBAAsB,EAAE,SAAS,CAAC,CAAC;wBACxD,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;qBAC/B;iBACD;gBAAC,OAAO,KAAK,EAAE;oBACf,GAAG,CAAC,KAAK,CAAC,OAAO,EAAC,8BAA8B,EAAC,WAAW,EAAE,KAAK,CAAC,CAAC;oBACrE,cAAc;oBACd,GAAG,CAAC,SAAS,CAAC;wBACb,KAAK,EAAE,KAAK,CAAC,OAAO,IAAI,UAAU;wBAClC,IAAI,EAAE,MAAM;qBACZ,CAAC,CAAC;iBACH;wBAAS;oBACT,GAAG,CAAC,WAAW,EAAE,CAAC;iBAClB;YACF,CAAC;SAAA;QAED;;;WAGG;QACH,iBAAiB,CAAC,SAAS,OAAA;YAC1B,yBAAyB;YACzB,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAC7B,CAAC;KACD;CACD,EAAA\"}"}
