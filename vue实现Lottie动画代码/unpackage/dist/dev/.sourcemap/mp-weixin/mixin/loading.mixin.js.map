{"version":3,"file":"loading.mixin.js","sources":["mixin/loading.mixin.js"],"sourcesContent":["// mixin/loading.mixin.js\nlet timer = null\n\n/**\n * 全局加载动画混入\n * 在页面加载时自动显示和隐藏加载动画\n * @type {import('vue').ComponentOptions}\n */\nexport default {\n  onLoad() {\n    const app = getApp()\n    if (!app || !app.globalData || !app.globalData.$loading) {\n      console.warn('全局加载控制尚未初始化')\n      return\n    }\n    \n    // 延迟 300ms 显示 Loading，防止一闪而过\n    timer = setTimeout(() => {\n      try {\n        app.globalData.$loading.show()\n      } catch (err) {\n        console.error('显示加载动画失败:', err)\n      }\n    }, 300)\n  },\n  onReady() {\n    clearTimeout(timer)\n    timer = null\n    \n    const app = getApp()\n    if (!app || !app.globalData || !app.globalData.$loading) {\n      console.warn('全局加载控制尚未初始化')\n      return\n    }\n    \n    try {\n      app.globalData.$loading.hide()\n    } catch (err) {\n      console.error('隐藏加载动画失败:', err)\n    }\n  },\n  onUnload() {\n    // 确保组件卸载时清除定时器\n    if (timer) {\n      clearTimeout(timer)\n      timer = null\n    }\n    \n    // 确保离开页面时隐藏loading\n    const app = getApp()\n    if (app?.globalData?.$loading?.hide) {\n      app.globalData.$loading.hide()\n    }\n  }\n}\n"],"names":["uni"],"mappings":";;AACA,IAAI,QAAQ;AAOZ,MAAe,eAAA;AAAA,EACb,SAAS;AACP,UAAM,MAAM,OAAQ;AACpB,QAAI,CAAC,OAAO,CAAC,IAAI,cAAc,CAAC,IAAI,WAAW,UAAU;AACvDA,oBAAAA,MAAA,MAAA,QAAA,gCAAa,aAAa;AAC1B;AAAA,IACD;AAGD,YAAQ,WAAW,MAAM;AACvB,UAAI;AACF,YAAI,WAAW,SAAS,KAAM;AAAA,MAC/B,SAAQ,KAAK;AACZA,sBAAAA,MAAA,MAAA,SAAA,gCAAc,aAAa,GAAG;AAAA,MAC/B;AAAA,IACF,GAAE,GAAG;AAAA,EACP;AAAA,EACD,UAAU;AACR,iBAAa,KAAK;AAClB,YAAQ;AAER,UAAM,MAAM,OAAQ;AACpB,QAAI,CAAC,OAAO,CAAC,IAAI,cAAc,CAAC,IAAI,WAAW,UAAU;AACvDA,oBAAAA,MAAA,MAAA,QAAA,gCAAa,aAAa;AAC1B;AAAA,IACD;AAED,QAAI;AACF,UAAI,WAAW,SAAS,KAAM;AAAA,IAC/B,SAAQ,KAAK;AACZA,oBAAAA,MAAc,MAAA,SAAA,gCAAA,aAAa,GAAG;AAAA,IAC/B;AAAA,EACF;AAAA,EACD,WAAW;;AAET,QAAI,OAAO;AACT,mBAAa,KAAK;AAClB,cAAQ;AAAA,IACT;AAGD,UAAM,MAAM,OAAQ;AACpB,SAAI,sCAAK,eAAL,mBAAiB,aAAjB,mBAA2B,MAAM;AACnC,UAAI,WAAW,SAAS,KAAM;AAAA,IAC/B;AAAA,EACF;AACH;;"}