{"version":3,"file":"loading.mixin.js","sources":["mixin/loading.mixin.js"],"sourcesContent":["// mixin/loading.mixin.js\r\nlet timer = null\r\n\r\n/**\r\n * 全局加载动画混入\r\n * 在页面加载时自动显示和隐藏加载动画\r\n * @type {import('vue').ComponentOptions}\r\n */\r\nexport default {\r\n  onLoad() {\r\n    const app = getApp()\r\n    if (!app || !app.globalData || !app.globalData.$loading) {\r\n      console.warn('全局加载控制尚未初始化')\r\n      return\r\n    }\r\n    \r\n    // 延迟 300ms 显示 Loading，防止一闪而过\r\n    timer = setTimeout(() => {\r\n      try {\r\n        app.globalData.$loading.show()\r\n      } catch (err) {\r\n        console.error('显示加载动画失败:', err)\r\n      }\r\n    }, 300)\r\n  },\r\n  onReady() {\r\n    clearTimeout(timer)\r\n    timer = null\r\n    \r\n    const app = getApp()\r\n    if (!app || !app.globalData || !app.globalData.$loading) {\r\n      console.warn('全局加载控制尚未初始化')\r\n      return\r\n    }\r\n    \r\n    try {\r\n      app.globalData.$loading.hide()\r\n    } catch (err) {\r\n      console.error('隐藏加载动画失败:', err)\r\n    }\r\n  },\r\n  onUnload() {\r\n    // 确保组件卸载时清除定时器\r\n    if (timer) {\r\n      clearTimeout(timer)\r\n      timer = null\r\n    }\r\n    \r\n    // 确保离开页面时隐藏loading\r\n    const app = getApp()\r\n    if (app?.globalData?.$loading?.hide) {\r\n      app.globalData.$loading.hide()\r\n    }\r\n  }\r\n}\r\n"],"names":["uni"],"mappings":";;AACA,IAAI,QAAQ;AAOZ,MAAe,eAAA;AAAA,EACb,SAAS;AACP,UAAM,MAAM,OAAQ;AACpB,QAAI,CAAC,OAAO,CAAC,IAAI,cAAc,CAAC,IAAI,WAAW,UAAU;AACvDA,oBAAAA,MAAa,MAAA,QAAA,gCAAA,aAAa;AAC1B;AAAA,IACD;AAGD,YAAQ,WAAW,MAAM;AACvB,UAAI;AACF,YAAI,WAAW,SAAS,KAAM;AAAA,MAC/B,SAAQ,KAAK;AACZA,sBAAAA,MAAA,MAAA,SAAA,gCAAc,aAAa,GAAG;AAAA,MAC/B;AAAA,IACF,GAAE,GAAG;AAAA,EACP;AAAA,EACD,UAAU;AACR,iBAAa,KAAK;AAClB,YAAQ;AAER,UAAM,MAAM,OAAQ;AACpB,QAAI,CAAC,OAAO,CAAC,IAAI,cAAc,CAAC,IAAI,WAAW,UAAU;AACvDA,oBAAAA,MAAa,MAAA,QAAA,gCAAA,aAAa;AAC1B;AAAA,IACD;AAED,QAAI;AACF,UAAI,WAAW,SAAS,KAAM;AAAA,IAC/B,SAAQ,KAAK;AACZA,oBAAAA,MAAc,MAAA,SAAA,gCAAA,aAAa,GAAG;AAAA,IAC/B;AAAA,EACF;AAAA,EACD,WAAW;;AAET,QAAI,OAAO;AACT,mBAAa,KAAK;AAClB,cAAQ;AAAA,IACT;AAGD,UAAM,MAAM,OAAQ;AACpB,SAAI,sCAAK,eAAL,mBAAiB,aAAjB,mBAA2B,MAAM;AACnC,UAAI,WAAW,SAAS,KAAM;AAAA,IAC/B;AAAA,EACF;AACH;;"}