{"version":3,"file":"undergraduate.js","sources":["components/combobox/undergraduate.js"],"sourcesContent":["import Fuse from 'fuse.js'\r\n\r\nexport default function createDataModule(dataList) {\r\n  return {\r\n    state: {\r\n      data: dataList,\r\n      filterKeyword: '',\r\n      dataFuse: null // 存储 Fuse 实例\r\n    },\r\n\r\n    mutations: {\r\n      setFilterKeyword(state, keyword) {\r\n        state.filterKeyword = keyword\r\n      },\r\n\r\n      // 初始化 Fuse 实例\r\n      initFuse(state) {\r\n        const dataItems = state.data.map(name => {\r\n          const shortNames = generateShortNames(name)\r\n          return {\r\n            name: name,         // 原数据名\r\n            short: shortNames,  // 生成的简称组合\r\n            display: name       // 可显示名（备用）\r\n          }\r\n        })\r\n\r\n        state.dataFuse = new Fuse(\r\n          dataItems,\r\n          {\r\n            keys: [\r\n              { name: 'name', weight: 0.7 },   // 正式全名匹配，权重大\r\n              { name: 'short', weight: 0.3 }   // 简称匹配，权重小\r\n            ],\r\n            threshold: 0.6,          // 宽松匹配\r\n            includeScore: true,\r\n            shouldSort: true,\r\n            minMatchCharLength: 1,\r\n            ignoreLocation: true,\r\n            findAllMatches: true,\r\n            distance: 1000,\r\n            location: 0,\r\n            includeMatches: true\r\n          }\r\n        )\r\n\r\n        console.log('数据搜索引擎初始化完成，总数量:', dataItems.length)\r\n      }\r\n    },\r\n\r\n    getters: {\r\n      filteredData(state) {\r\n        if (!state.filterKeyword) {\r\n          return state.data.slice(0, 50) // 限制初始显示数量（比如前50个）\r\n        }\r\n\r\n        if (!state.dataFuse) {\r\n          this.mutations.initFuse(state)\r\n        }\r\n\r\n        const keyword = state.filterKeyword.trim()\r\n\r\n        const results = state.dataFuse.search(keyword)\r\n\r\n        if (results.length > 0) {\r\n          console.log('搜索关键词:', keyword, '找到结果数:', results.length)\r\n        }\r\n\r\n        return results.map(result => result.item.name)\r\n      },\r\n\r\n      // 获取最佳匹配的数据（用于自动完成）\r\n      bestMatchedData(state, getters) {\r\n        if (!state.filterKeyword || !state.dataFuse) return ''\r\n\r\n        const results = state.dataFuse.search(state.filterKeyword.trim())\r\n        return results.length > 0 ? results[0].item.name : ''\r\n      }\r\n    },\r\n\r\n    actions: {\r\n      updateFilterKeyword({ commit }, keyword) {\r\n        commit('setFilterKeyword', keyword)\r\n      },\r\n\r\n      initSearch({ commit }) {\r\n        commit('initFuse')\r\n      },\r\n\r\n      autoSelectBestMatch({ state, getters }) {\r\n        return getters.bestMatchedData\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * @description 为名称生成可能的简称组合，用于提高模糊搜索能力\r\n * @param {String} name - 完整名称\r\n * @returns {String} - 可能的简称组合（空格分隔）\r\n */\r\nfunction generateShortNames(name) {\r\n  let shortNames = []\r\n\r\n  const chineseChars = name.split('').filter(char => /[\\u4e00-\\u9fa5]/.test(char)).join('')\r\n\r\n  if (chineseChars.length >= 2) {\r\n    shortNames.push(chineseChars.substring(0, 2)) // 前两个字\r\n  }\r\n\r\n  if (chineseChars.length >= 3) {\r\n    shortNames.push(chineseChars.substring(0, 3)) // 前三个字\r\n    const match = chineseChars.match(/^([\\u4e00-\\u9fa5]{2})([\\u4e00-\\u9fa5]{1,3})/)\r\n    if (match) {\r\n      shortNames.push(match[1][0] + match[2]) // 地名+关键词，比如\"北理\"\r\n    }\r\n  }\r\n\r\n  if (chineseChars.length >= 4 && (name.includes('大学') || name.includes('学院'))) {\r\n    shortNames.push(chineseChars.substring(2)) // 去掉地名\r\n  }\r\n\r\n  return shortNames.join(' ')\r\n}\r\n"],"names":["Fuse","uni"],"mappings":"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"}