{"version":3,"file":"undergraduate_school.js","sources":["components/combobox/undergraduate_school.js"],"sourcesContent":["import Fuse from 'fuse.js'\r\nimport schoolList from '../../static/data/2886所大学.json'\r\n\r\nexport default {\r\n  state: {\r\n    schools: schoolList,\r\n    filterKeyword: '',\r\n    schoolFuse: null // 存储 Fuse 实例\r\n  },\r\n  \r\n  mutations: {\r\n    setFilterKeyword(state, keyword) {\r\n      state.filterKeyword = keyword\r\n    },\r\n    \r\n    // 初始化 Fuse 实例\r\n    initFuse(state) {\r\n      state.schoolFuse = new Fuse(\r\n        state.schools.map(name => ({ name })),\r\n        {\r\n          keys: ['name'],\r\n          threshold: 0.4, // 匹配阈值（0-1之间，越小越严格）\r\n          includeScore: true,\r\n          shouldSort: true, // 按匹配度排序\r\n          minMatchCharLength: 2, // 最小匹配字符长度\r\n          ignoreLocation: true, // 忽略字符位置\r\n          distance: 100 // 最大匹配距离\r\n        }\r\n      )\r\n    }\r\n  },\r\n  \r\n  getters: {\r\n    filteredSchools(state) {\r\n      if (!state.filterKeyword) {\r\n        return state.schools\r\n      }\r\n      \r\n      // 如果关键词太短，使用简单匹配\r\n      if (state.filterKeyword.length < 2) {\r\n        return state.schools.filter(name =>\r\n          name.toLowerCase().includes(state.filterKeyword.toLowerCase())\r\n        )\r\n      }\r\n      \r\n      if (!state.schoolFuse) {\r\n        // 如果 Fuse 未初始化，回退到简单搜索\r\n        return state.schools.filter(name =>\r\n          name.toLowerCase().includes(state.filterKeyword.toLowerCase())\r\n        )\r\n      }\r\n\r\n      // 使用 Fuse.js 进行模糊搜索\r\n      const results = state.schoolFuse.search(state.filterKeyword)\r\n      return results.map(result => result.item.name)\r\n    },\r\n    \r\n    // 获取最佳匹配的学校（用于自动完成）\r\n    bestMatchedSchool(state, getters) {\r\n      if (!state.filterKeyword || !state.schoolFuse) return ''\r\n      \r\n      const results = state.schoolFuse.search(state.filterKeyword)\r\n      return results.length > 0 ? results[0].item.name : ''\r\n    }\r\n  },\r\n  \r\n  actions: {\r\n    updateFilterKeyword({ commit }, keyword) {\r\n      commit('setFilterKeyword', keyword)\r\n    },\r\n    \r\n    // 初始化搜索\r\n    initSearch({ commit }) {\r\n      commit('initFuse')\r\n    },\r\n    \r\n    // 自动选择最佳匹配\r\n    autoSelectBestMatch({ state, getters }) {\r\n      return getters.bestMatchedSchool\r\n    }\r\n  }\r\n}"],"names":["Fuse"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,MAAe,qBAAA;AAAA,EACb,OAAO;AAAA,IACL,SAAS;AAAA,IACT,eAAe;AAAA,IACf,YAAY;AAAA;AAAA,EACb;AAAA,EAED,WAAW;AAAA,IACT,iBAAiB,OAAO,SAAS;AAC/B,YAAM,gBAAgB;AAAA,IACvB;AAAA;AAAA,IAGD,SAAS,OAAO;AACd,YAAM,aAAa,IAAIA,cAAI;AAAA,QACzB,MAAM,QAAQ,IAAI,WAAS,EAAE,KAAM,EAAC;AAAA,QACpC;AAAA,UACE,MAAM,CAAC,MAAM;AAAA,UACb,WAAW;AAAA;AAAA,UACX,cAAc;AAAA,UACd,YAAY;AAAA;AAAA,UACZ,oBAAoB;AAAA;AAAA,UACpB,gBAAgB;AAAA;AAAA,UAChB,UAAU;AAAA;AAAA,QACX;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EAED,SAAS;AAAA,IACP,gBAAgB,OAAO;AACrB,UAAI,CAAC,MAAM,eAAe;AACxB,eAAO,MAAM;AAAA,MACd;AAGD,UAAI,MAAM,cAAc,SAAS,GAAG;AAClC,eAAO,MAAM,QAAQ;AAAA,UAAO,UAC1B,KAAK,YAAW,EAAG,SAAS,MAAM,cAAc,aAAa;AAAA,QAC9D;AAAA,MACF;AAED,UAAI,CAAC,MAAM,YAAY;AAErB,eAAO,MAAM,QAAQ;AAAA,UAAO,UAC1B,KAAK,YAAW,EAAG,SAAS,MAAM,cAAc,aAAa;AAAA,QAC9D;AAAA,MACF;AAGD,YAAM,UAAU,MAAM,WAAW,OAAO,MAAM,aAAa;AAC3D,aAAO,QAAQ,IAAI,YAAU,OAAO,KAAK,IAAI;AAAA,IAC9C;AAAA;AAAA,IAGD,kBAAkB,OAAO,SAAS;AAChC,UAAI,CAAC,MAAM,iBAAiB,CAAC,MAAM;AAAY,eAAO;AAEtD,YAAM,UAAU,MAAM,WAAW,OAAO,MAAM,aAAa;AAC3D,aAAO,QAAQ,SAAS,IAAI,QAAQ,CAAC,EAAE,KAAK,OAAO;AAAA,IACpD;AAAA,EACF;AAAA,EAED,SAAS;AAAA,IACP,oBAAoB,EAAE,OAAQ,GAAE,SAAS;AACvC,aAAO,oBAAoB,OAAO;AAAA,IACnC;AAAA;AAAA,IAGD,WAAW,EAAE,UAAU;AACrB,aAAO,UAAU;AAAA,IAClB;AAAA;AAAA,IAGD,oBAAoB,EAAE,OAAO,WAAW;AACtC,aAAO,QAAQ;AAAA,IAChB;AAAA,EACF;AACH;;;"}