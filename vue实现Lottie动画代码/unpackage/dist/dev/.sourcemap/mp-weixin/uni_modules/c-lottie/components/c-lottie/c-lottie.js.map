{"version":3,"file":"c-lottie.js","sources":["uni_modules/c-lottie/components/c-lottie/c-lottie.vue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTov56CU5biI5b2V5LiO5YW25LuW5Lq65YWx5Lqr5paH5Lu2L3RlYWNoZXJEaXJlY3RvcnkvdnVl5a6e546wTG90dGll5Yqo55S75Luj56CBL3VuaV9tb2R1bGVzL2MtbG90dGllL2NvbXBvbmVudHMvYy1sb3R0aWUvYy1sb3R0aWUudnVl"],"sourcesContent":["<template>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t<view class=\"c-lottie\" :style=\"{width,height}\">\r\n\t\t<canvas class=\"canvas\" :id=\"myCanvasId\" type=\"2d\"></canvas>\r\n\t</view>\r\n\r\n</template>\r\n<script lang=\"uts\">\r\n\t/**\r\n\t * c-lottie Lottie组件\r\n\t * @property {String} canvasId 画布id\r\n\t * @property {String} width 图像宽度 默认750rpx 单位rpx/px\r\n\t * @property {String} height 图像高度 默认750rpx 单位rpx/px\r\n\t * @property {String} src Lottie文件地址 小程序只支持网络地址\r\n\t * @property {String} data Lottie文件data\r\n\t * @property {Boolean} autoPlay 是否自动播放 默认true\r\n\t * @property {Boolean} loop 是否循环播放 默认值为 true\r\n\t * @property {String} renderer 渲染模式 默认值为canvas 可选值 svg|canvas 小程序不支持\r\n\t * @property {Boolean} isOnChange 是否开启播放进度监听 默认false false时不触发EnterFrame\r\n\t * @event {Function()} Complete 监听动画播放完成\r\n\t * @event {Function()} LoopComplete 监听当前循环播放完成\r\n\t * @event {Function()} EnterFrame 监听动画播放进度\r\n\t * @event {Function()} SegmentStart 监听开始播放一个动画片段\r\n\t * @event {Function()} dataReady 当动画的所有部分都已加载时触发\r\n\t * @event {Function()} dataFailed 当部分动画无法加载时触发\r\n\t * 组件内方法统一使用 call(funName, args) 调用player实例方法 详见文档\r\n\t * */\r\n\timport uuid from './js/uuid.js'\r\n\r\n\timport lottie from 'lottie-miniprogram'\r\n\r\n\r\n\r\n\r\n\texport default {\r\n\t\tprops: {\r\n\t\t\tcanvasId: {\r\n\t\t\t\ttype: String\r\n\t\t\t},\r\n\t\t\twidth: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '750rpx'\r\n\t\t\t},\r\n\t\t\theight: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '750rpx'\r\n\t\t\t},\r\n\t\t\tsrc: {\r\n\t\t\t\ttype: String,\r\n\t\t\t},\r\n\t\t\tdata: {\r\n\t\t\t\ttype: String,\r\n\t\t\t},\r\n\t\t\tautoPlay: { //是否自动播放\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\tloop: { //是否循环播放 默认值为 true\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\trenderer: { //渲染模式 默认值为canvas 可选值 svg\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'canvas',\r\n\t\t\t},\r\n\t\t\tisOnChange: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t}\r\n\t\t},\r\n\t\temits: ['Complete', 'LoopComplete', 'EnterFrame', 'SegmentStart','dataReady','dataFailed'],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tfun: {}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tmyCanvasId() {\r\n\t\t\t\tif (!this.canvasId) {\r\n\t\t\t\t\treturn 'c' + uuid(18)\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.canvasId\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlottieData() {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tmyCanvasId: this.myCanvasId,\r\n\t\t\t\t\twidth: this.width,\r\n\t\t\t\t\theight: this.height,\r\n\t\t\t\t\tsrc: this.src,\r\n\t\t\t\t\tdata: this.data,\r\n\t\t\t\t\tautoPlay: this.autoPlay,\r\n\t\t\t\t\tloop: this.loop,\r\n\t\t\t\t\trenderer: this.renderer,\r\n\t\t\t\t\tisOnChange: this.isOnChange\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tlottieData() {\r\n\r\n\t\t\t\tthis.render()\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tcall(name, args) {\r\n\t\t\t\tthis.fun = {name,args}\r\n\r\n\t\t\t\tthis.callPlayer(this.fun)\r\n\r\n\t\t\t},\r\n\r\n\t\t\tgetContext() {\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tconst {\r\n\t\t\t\t\t\tpixelRatio\r\n\t\t\t\t\t} = uni.getSystemInfoSync()\r\n\t\t\t\t\tuni.createSelectorQuery()\r\n\t\t\t\t\t\t.in(this)\r\n\t\t\t\t\t\t.select(`#${this.myCanvasId}`)\r\n\t\t\t\t\t\t.fields({\r\n\t\t\t\t\t\t\tnode: true,\r\n\t\t\t\t\t\t\tsize: true\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.exec(res => {\r\n\t\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\t\twidth,\r\n\t\t\t\t\t\t\t\theight\r\n\t\t\t\t\t\t\t} = res[0]\r\n\t\t\t\t\t\t\tconst canvas = res[0].node\r\n\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\tcanvas,\r\n\t\t\t\t\t\t\t\twidth,\r\n\t\t\t\t\t\t\t\theight,\r\n\t\t\t\t\t\t\t\tpixelRatio\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tasync render() {\r\n\t\t\t\tif (this.player) {\r\n\t\t\t\t\t// uni.__f__('log','at uni_modules/c-lottie/components/c-lottie/c-lottie.vue:149',player);\r\n\t\t\t\t\t// call('stop')\r\n\t\t\t\t\tthis.call('destroy', this.player)\r\n\t\t\t\t}\r\n\t\t\t\tlet {\r\n\t\t\t\t\tcanvas,\r\n\t\t\t\t\twidth,\r\n\t\t\t\t\theight,\r\n\t\t\t\t\tpixelRatio\r\n\t\t\t\t} = await this.getContext()\r\n\t\t\t\tthis.myCanvas = canvas\r\n\t\t\t\tthis.context = canvas.getContext('2d')\r\n\t\t\t\t//避免出现锯齿问题\r\n\t\t\t\tthis.context.scale(pixelRatio, pixelRatio)\r\n\t\t\t\tcanvas.width = width * pixelRatio\r\n\t\t\t\tcanvas.height = height * pixelRatio\r\n\t\t\t\tlottie.setup(this.myCanvas)\r\n\t\t\t\tthis.player = lottie.loadAnimation({\r\n\t\t\t\t\tloop: this.loop,\r\n\t\t\t\t\tautoplay: this.autoPlay,\r\n\t\t\t\t\t// 动画json的本地数据\r\n\t\t\t\t\tanimationData: this.data,\r\n\t\t\t\t\t//远程动画。一定要把json格式的文件放到服务器中，并且注意域名是合法的\r\n\t\t\t\t\tpath: this.src,\r\n\t\t\t\t\trendererSettings: {\r\n\t\t\t\t\t\tcontext:this.context,\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t\tthis.player.addEventListener('data_ready',(val)=>{ //当动画的所有部分都已加载时\r\n\t\t\t\t\tthis.$emit('dataReady', val)\r\n\t\t\t\t})\r\n\t\t\t\tthis.player.addEventListener('data_failed',(val)=>{ //当部分动画无法加载时\r\n\t\t\t\t\tthis.$emit('dataFailed', val)\r\n\t\t\t\t})\r\n\t\t\t\tthis.player.onComplete = (val) => { //动画播放完成触发\r\n\t\t\t\t\t// uni.__f__('log','at uni_modules/c-lottie/components/c-lottie/c-lottie.vue:184','动画播放完成触发',val);\r\n\t\t\t\t\tthis.$emit('Complete', val)\r\n\t\t\t\t}\r\n\t\t\t\tthis.player.onLoopComplete = (val) => { //当前循环播放完成触发\r\n\t\t\t\t\t// uni.__f__('log','at uni_modules/c-lottie/components/c-lottie/c-lottie.vue:188','当前循环播放完成触发',val);\r\n\t\t\t\t\tthis.$emit('LoopComplete', val)\r\n\t\t\t\t}\r\n\t\t\t\tif (this.isOnChange) {\r\n\t\t\t\t\tthis.player.onEnterFrame = (val) => { //播放动画的时候触发\r\n\t\t\t\t\t\t// uni.__f__('log','at uni_modules/c-lottie/components/c-lottie/c-lottie.vue:193','播放动画的时候触发',val);\r\n\t\t\t\t\t\tthis.$emit('EnterFrame', val)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.player.onSegmentStart = (val) => { //开始播放一个动画片段的时候触发\r\n\t\t\t\t\t// uni.__f__('log','at uni_modules/c-lottie/components/c-lottie/c-lottie.vue:198','开始播放一个动画片段的时候触发',val);\r\n\t\t\t\t\tthis.$emit('SegmentStart', val)\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tcallPlayer(val) {\r\n\t\t\t\tif (!val.name) return;\r\n\t\t\t\tlet {name,args} = val\r\n\t\t\t\t// uni.__f__('log','at uni_modules/c-lottie/components/c-lottie/c-lottie.vue:206',name, args);\r\n\t\t\t\tif (Array.isArray(args)) {\r\n\t\t\t\t\tthis.player[name](...args)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.player[name](args)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t},\r\n\t\tmounted() {\r\n\r\n\t\t\tthis.render()\r\n\r\n\t\t},\r\n\t\tbeforeDestroy() {\r\n\t\t\t// 组件卸载销毁实例\r\n\t\t\tthis.call('destroy')\r\n\t\t}\r\n\r\n\t}\r\n</script>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.c-lottie {\r\n\t\t// width: v-bind(width);\r\n\t\t// height: v-bind(height);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t.canvas {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100%;\r\n\t\t}\r\n\t}\r\n</style>","import Component from 'E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/uni_modules/c-lottie/components/c-lottie/c-lottie.vue'\nwx.createComponent(Component)"],"names":["_sfc_main","defineComponent","uuid","name","args","resolve","pixelRatio","uni","res","_a","width","height","canvas","lottie","val","Component"],"mappings":"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"}