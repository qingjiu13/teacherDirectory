{"version":3,"file":"LsjFile.js","sources":["uni_modules/lsj-upload/components/lsj-upload/LsjFile.js"],"sourcesContent":["export class LsjFile {\n\tconstructor(data) {\n\t\tthis.dom = null;\n\t\t// files.type = waiting（等待上传）|| loading（上传中）|| success（成功） || fail（失败）\n\t\tthis.files = new Map();\n\t\tthis.debug = data.debug || false;\n\t\tthis.id = data.id;\n\t\tthis.width = data.width;\n\t\tthis.height = data.height;\n\t\tthis.option = data.option;\n\t\tthis.instantly = data.instantly;\n\t\tthis.prohibited = data.prohibited;\n\t\tthis.onchange = data.onchange;\n\t\tthis.onprogress = data.onprogress;\n\t\tthis.uploadHandle = this._uploadHandle;\n\t\t// #ifdef MP-WEIXIN\n\t\tthis.uploadHandle = this._uploadHandleWX;\n\t\t// #endif\n\t}\n\t\n\t\n\t/**\n\t * 创建File节点\n\t * @param {string}path webview地址\n\t */\n\tcreate(path) {\n\t\tif (!this.dom) {\n\t\t\t// #ifdef H5\n\t\t\t\tlet dom = document.createElement('input');\n\t\t\t\tdom.type = 'file'\n\t\t\t\tdom.value = ''\n\t\t\t\tdom.style.height = this.height\n\t\t\t\tdom.style.width = this.width\n\t\t\t\tdom.style.position = 'absolute'\n\t\t\t\tdom.style.top = 0\n\t\t\t\tdom.style.left = 0\n\t\t\t\tdom.style.right = 0\n\t\t\t\tdom.style.bottom = 0\n\t\t\t\tdom.style.opacity = 0\n\t\t\t\tdom.style.zIndex = 999\n\t\t\t\tdom.accept = this.prohibited.accept;\n\t\t\t\tif (this.prohibited.multiple) {\n\t\t\t\tdom.multiple = 'multiple';\n\t\t\t\t}\n\t\t\t\tdom.onchange = event => {\n\t\t\t\t\tfor (let file of event.target.files) {\n\t\t\t\t\t\tif (this.files.size >= this.prohibited.count) {\n\t\t\t\t\t\t\tthis.toast(`只允许上传${this.prohibited.count}个文件`);\n\t\t\t\t\t\t\tthis.dom.value = '';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.addFile(file);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis._uploadAfter();\n\t\t\t\t\t\n\t\t\t\t\tthis.dom.value = '';\n\t\t\t\t};\n\t\t\t\tthis.dom = dom;\n\t\t\t// #endif\n\t\t\n\t\t\t// #ifdef APP-PLUS\n\t\t\t\tlet styles = {\n\t\t\t\t\ttop: '-200px',\n\t\t\t\t\tleft: 0,\n\t\t\t\t\twidth: '1px',\n\t\t\t\t\theight: '200px',\n\t\t\t\t\tbackground: 'transparent' \n\t\t\t\t};\n\t\t\t\tlet extras = {\n\t\t\t\t\tdebug: this.debug,\n\t\t\t\t\tinstantly: this.instantly,\n\t\t\t\t\tprohibited: this.prohibited,\n\t\t\t\t}\n\t\t\t\tthis.dom = plus.webview.create(path, this.id, styles,extras);\n\t\t\t\tthis.setData(this.option); \n\t\t\t\tthis._overrideUrlLoading();\n\t\t\t// #endif\n\t\t\treturn this.dom;\n\t\t}\n\t}\n\t\n\t\n\t/**\n\t * 设置上传参数\n\t * @param {object|string}name 上传参数,支持a.b 和 a[b]\n\t */\n\tsetData() {\n\t\tlet [name,value = ''] = arguments;\n\t\tif (typeof name === 'object') {\n\t\t\tObject.assign(this.option,name);\n\t\t}\n\t\telse {\n\t\t\tthis._setValue(this.option,name,value);\n\t\t}\n\t\t\n\t\tthis.debug&&console.log(JSON.stringify(this.option));\n\t\t\n\t\t// #ifdef APP-PLUS\n\t\t\tthis.dom.evalJS(`vm.setData('${JSON.stringify(this.option)}')`);\n\t\t// #endif\n\t}\n\t\n\t/**\n\t * 上传\n\t * @param {string}name 文件名称\n\t */\n\tasync upload(name='') {\n\t\tif (!this.option.url) {\n\t\t\tthrow Error('未设置上传地址');\n\t\t}\n\t\t\n\t\t// #ifndef APP-PLUS\n\t\t\tif (name && this.files.has(name)) {\n\t\t\t\tawait this.uploadHandle(this.files.get(name));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (let item of this.files.values()) {\n\t\t\t\t\tif (item.type === 'waiting' || item.type === 'fail') {\n\t\t\t\t\t\tawait this.uploadHandle(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t// #endif\n\t\t\n\t\t// #ifdef APP-PLUS\n\t\t\tthis.dom&&this.dom.evalJS(`vm.upload('${name}')`);\n\t\t// #endif\n\t}\n\t\n\t// 选择文件change\n\taddFile(file,isCallChange) {\n\t\t\n\t\tlet name = file.name;\n\t\tthis.debug&&console.log('文件名称',name,'大小',file.size);\n\t\t\n\t\tif (file) {\n\t\t\t// 限制文件格式\n\t\t\tlet path = '';\n\t\t\tlet suffix = name.substring(name.lastIndexOf(\".\")+1).toLowerCase();\n\t\t\tlet formats = this.prohibited.formats.toLowerCase();\n\t\t\t\n\t\t\t// #ifndef MP-WEIXIN\n\t\t\t\tpath = URL.createObjectURL(file);\n\t\t\t// #endif\n\t\t\t// #ifdef MP-WEIXIN\n\t\t\t\tpath = file.path;\n\t\t\t// #endif\n\t\t\tif (formats&&!formats.includes(suffix)) {\n\t\t\t\tthis.toast(`不支持上传${suffix.toUpperCase()}格式文件`);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// 限制文件大小\n\t\t\tif (file.size > 1024 * 1024 * Math.abs(this.prohibited.size)) {\n\t\t\t\tthis.toast(`附件大小请勿超过${this.prohibited.size}M`)\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\ttry{\n\t\t\t\tif (!this.prohibited.distinct) {\n\t\t\t\t\tlet homonymIndex = [...this.files.keys()].findIndex(item=>{\n\t\t\t\t\t\treturn (item.substring(0,item.lastIndexOf(\"(\"))||item.substring(0,item.lastIndexOf(\".\"))) == name.substring(0,name.lastIndexOf(\".\")) &&\n\t\t\t\t\t\titem.substring(item.lastIndexOf(\".\")+1).toLowerCase() === suffix;\n\t\t\t\t\t})\n\t\t\t\t\tif (homonymIndex > -1) {\n\t\t\t\t\t\tname = `${name.substring(0,name.lastIndexOf(\".\"))}(${homonymIndex+1}).${suffix}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\t//TODO handle the exception\n\t\t\t}\n\t\t\t\n\t\t\tthis.files.set(name,{file,path,name: name,size: file.size,progress: 0,type: 'waiting'});\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n\t/**\n\t * 移除文件\n\t * @param {string}name 不传name默认移除所有文件，传入name移除指定name的文件\n\t */\n\tclear(name='') {\n\t\t// #ifdef APP-PLUS\n\t\tthis.dom&&this.dom.evalJS(`vm.clear('${name}')`);\n\t\t// #endif\n\t\t\n\t\tif (!name) {\n\t\t\tthis.files.clear();\n\t\t}\n\t\telse {\n\t\t\tthis.files.delete(name); \n\t\t}\n\t\treturn this.onchange(this.files);\n\t}\n\t\n\t/**\n\t * 提示框\n\t * @param {string}msg 轻提示内容\n\t */\n\ttoast(msg) {\n\t\tuni.showToast({\n\t\t\ttitle: msg,\n\t\t\ticon: 'none'\n\t\t});\n\t}\n\t\n\t/**\n\t * 微信小程序选择文件\n\t * @param {number}count 可选择文件数量\n\t */\n\tchooseMessageFile(type,count) {\n\t\twx.chooseMessageFile({\n\t\t\tcount: count,\n\t\t\ttype: type,\n\t\t\tsuccess: ({ tempFiles }) => {\n\t\t\t\tfor (let file of tempFiles) {\n\t\t\t\t\tthis.addFile(file);\n\t\t\t\t}\n\t\t\t\tthis._uploadAfter();\n\t\t\t},\n\t\t\tfail: () => {\n\t\t\t\tthis.toast(`打开失败`);\n\t\t\t}\n\t\t})\n\t}\n\t\n\t_copyObject(obj) {\n\t\tif (typeof obj !== \"undefined\") {\n\t\t\treturn JSON.parse(JSON.stringify(obj));\n\t\t} else {\n\t\t\treturn obj;\n\t\t}\n\t}\n\t\n\t/**\n\t * 自动根据字符串路径设置对象中的值 支持.和[]\n\t * @param\t{Object} dataObj 数据源\n\t * @param\t{String} name 支持a.b 和 a[b]\n\t * @param\t{String} value 值\n\t * setValue(dataObj, name, value);\n\t */\n\t_setValue(dataObj, name, value) {\n\t\t// 通过正则表达式  查找路径数据\n\t\tlet dataValue;\n\t\tif (typeof value === \"object\") {\n\t\t\tdataValue = this._copyObject(value);\n\t\t} else {\n\t\t\tdataValue = value;\n\t\t}\n\t\tlet regExp = new RegExp(\"([\\\\w$]+)|\\\\[(:\\\\d)\\\\]\", \"g\");\n\t\tconst patten = name.match(regExp);\n\t\t// 遍历路径  逐级查找  最后一级用于直接赋值\n\t\tfor (let i = 0; i < patten.length - 1; i++) {\n\t\t\tlet keyName = patten[i];\n\t\t\tif (typeof dataObj[keyName] !== \"object\") dataObj[keyName] = {};\n\t\t\tdataObj = dataObj[keyName];\n\t\t}\n\t\t// 最后一级\n\t\tdataObj[patten[patten.length - 1]] = dataValue;\n\t\tthis.debug&&console.log('参数更新后',JSON.stringify(this.option));\n\t}\n\t\n\t_uploadAfter() {\n\t\tthis.onchange(this.files);\n\t\tsetTimeout(()=>{\n\t\t\tthis.instantly&&this.upload();\n\t\t},1000)\n\t}\n\t\n\t_overrideUrlLoading() {\n\t\tthis.dom.overrideUrlLoading({ mode: 'reject' }, e => {\n\t\t\tlet {retype,item,files,end} = this._getRequest(\n\t\t\t\te.url\n\t\t\t);\n\t\t\tlet _this = this;\n\t\t\tswitch (retype) {\n\t\t\t\tcase 'updateOption':\n\t\t\t\t\tthis.dom.evalJS(`vm.setData('${JSON.stringify(_this.option)}')`);\n\t\t\t\t\tbreak\n\t\t\t\tcase 'change':\n\t\t\t\t\ttry {\n\t\t\t\t\t\t_this.files = new Map([..._this.files,...JSON.parse(unescape(files))]);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn console.error('出错了，请检查代码')\n\t\t\t\t\t}\n\t\t\t\t\t_this.onchange(_this.files);\n\t\t\t\t\tbreak\n\t\t\t\tcase 'progress':\n\t\t\t\t\ttry {\n\t\t\t\t\t\titem = JSON.parse(unescape(item));\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn console.error('出错了，请检查代码')\n\t\t\t\t\t}\n\t\t\t\t\t_this._changeFilesItem(item,end);\n\t\t\t\t\tbreak\n\t\t\t\tdefault:\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t})\n\t}\n\t\n\t_getRequest(url) {\n\t\tlet theRequest = new Object()\n\t\tlet index = url.indexOf('?')\n\t\tif (index != -1) {\n\t\t\tlet str = url.substring(index + 1)\n\t\t\tlet strs = str.split('&')\n\t\t\tfor (let i = 0; i < strs.length; i++) {\n\t\t\t\ttheRequest[strs[i].split('=')[0]] = unescape(strs[i].split('=')[1])\n\t\t\t}\n\t\t}\n\t\treturn theRequest\n\t}\n\t\n\t_changeFilesItem(item,end=false) {\n\t\tthis.debug&&console.log('onprogress',JSON.stringify(item));\n\t\tthis.onprogress(item,end);\n\t\tthis.files.set(item.name,item);\n\t}\n\t\n\t_uploadHandle(item) {\n\t\titem.type = 'loading';\n\t\tdelete item.responseText;\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tthis.debug&&console.log('option',JSON.stringify(this.option));\n\t\t\tlet {url,name,method='POST',header,formData} = this.option;\n\t\t\tlet form = new FormData();\n\t\t\tfor (let keys in formData) {\n\t\t\t\tform.append(keys, formData[keys])\n\t\t\t}\n\t\t\tform.append(name, item.file);\n\t\t\tlet xmlRequest = new XMLHttpRequest();\n\t\t\txmlRequest.open(method, url, true);\n\t\t\tfor (let keys in header) {\n\t\t\t\txmlRequest.setRequestHeader(keys, header[keys])\n\t\t\t}\n\t\t\t\n\t\t\txmlRequest.upload.addEventListener(\n\t\t\t\t'progress',\n\t\t\t\tevent => {\n\t\t\t\t\tif (event.lengthComputable) {\n\t\t\t\t\t\tlet progress = Math.ceil((event.loaded * 100) / event.total)\n\t\t\t\t\t\tif (progress <= 100) {\n\t\t\t\t\t\t\titem.progress = progress;\n\t\t\t\t\t\t\tthis._changeFilesItem(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfalse\n\t\t\t);\n\t\t\t\n\t\t\txmlRequest.ontimeout = () => {\n\t\t\t\tconsole.error('请求超时')\n\t\t\t\titem.type = 'fail';\n\t\t\t\tthis._changeFilesItem(item,true);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\t\t\t\n\t\t\txmlRequest.onreadystatechange = ev => {\n\t\t\t\tif (xmlRequest.readyState == 4) {\n\t\t\t\t\tif (xmlRequest.status == 200) {\n\t\t\t\t\t\tthis.debug&&console.log('上传完成：' + xmlRequest.responseText)\n\t\t\t\t\t\titem['responseText'] = xmlRequest.responseText;\n\t\t\t\t\t\titem.type = 'success';\n\t\t\t\t\t\tthis._changeFilesItem(item,true);\n\t\t\t\t\t\treturn resolve(true);\n\t\t\t\t\t} else if (xmlRequest.status == 0) {\n\t\t\t\t\t\tconsole.error('status = 0 :请检查请求头Content-Type与服务端是否匹配，服务端已正确开启跨域，并且nginx未拦截阻止请求')\n\t\t\t\t\t}\n\t\t\t\t\tconsole.error('--ERROR--：status = ' + xmlRequest.status)\n\t\t\t\t\titem.type = 'fail';\n\t\t\t\t\tthis._changeFilesItem(item,true);\n\t\t\t\t\treturn resolve(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\txmlRequest.send(form)\n\t\t});\n\t}\n\t\n\t_uploadHandleWX(item) {\n\t\titem.type = 'loading';\n\t\tdelete item.responseText;\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tthis.debug&&console.log('option',JSON.stringify(this.option));\n\t\t\tlet form = {filePath: item.file.path,...this.option };\n\t\t\tform['fail'] = ({ errMsg = '' }) => {\n\t\t\t\tconsole.error('--ERROR--：' + errMsg)\n\t\t\t\titem.type = 'fail';\n\t\t\t\tthis._changeFilesItem(item,true);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\t\t\tform['success'] = res => {\n\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\tthis.debug&&console.log('上传完成,微信端返回不一定是字符串，根据接口返回格式判断是否需要JSON.parse：' + res.data)\n\t\t\t\t\titem['responseText'] = res.data;\n\t\t\t\t\titem.type = 'success';\n\t\t\t\t\tthis._changeFilesItem(item,true);\n\t\t\t\t\treturn resolve(true);\n\t\t\t\t}\n\t\t\t\titem.type = 'fail';\n\t\t\t\tthis._changeFilesItem(item,true);\n\t\t\t\treturn resolve(false);\n\t\t\t}\n\t\t\t\n\t\t\tlet xmlRequest = uni.uploadFile(form);\n\t\t\txmlRequest.onProgressUpdate(({ progress = 0 }) => {\n\t\t\t\tif (progress <= 100) {\n\t\t\t\t\titem.progress = progress;\n\t\t\t\t\tthis._changeFilesItem(item);\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\t}\n}"],"names":["LsjFile","data","path","name","value","uni","item","file","isCallChange","suffix","formats","homonymIndex","msg","type","count","wx","tempFiles","obj","dataObj","dataValue","regExp","patten","i","keyName","retype","files","end","_this","url","theRequest","index","strs","resolve","reject","method","header","formData","form","keys","xmlRequest","event","progress","ev","errMsg","res"],"mappings":"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"}