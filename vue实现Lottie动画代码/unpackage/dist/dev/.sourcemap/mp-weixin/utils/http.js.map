{"version":3,"file":"http.js","sources":["utils/http.js"],"sourcesContent":["import { UPLOAD_FILE_URL, API_BASE_URL } from \"@/store/user/API.js\";\r\nimport { safeJsonParse } from \"@/utils/safeJsonParse.js\";\r\n\r\nexport const http = (options) => {\r\n  return new Promise((resolve, reject) => {\r\n    const header = { \"Content-Type\": \"application/json\" };\r\n    const jwtToken = uni.getStorageSync(\"jwtToken\");\r\n    if (jwtToken) {\r\n      header.Authorization = jwtToken;\r\n    }\r\n    uni.request({\r\n      url: API_BASE_URL + options.url,\r\n      method: options.method || \"GET\",\r\n      data: options.data || {},\r\n      header,\r\n      success: (res) => {\r\n        if (res.statusCode === 200) {\r\n          resolve(res.data);\r\n        } else {\r\n          reject(res.data);\r\n        }\r\n      },\r\n      fail: (err) => {\r\n        reject(err);\r\n      },\r\n    });\r\n  });\r\n};\r\n\r\nexport const uploadFile = (filePath, userId, fileType = \"file\") => {\r\n  return new Promise((resolve, reject) => {\r\n    uni.uploadFile({\r\n      url: UPLOAD_FILE_URL,\r\n      filePath,\r\n      name: fileType,\r\n      formData: {\r\n        userId: userId,\r\n      },\r\n      success: (res) => {\r\n        const data = safeJsonParse(res.data, {\r\n          code: 500,\r\n          message: \"响应数据格式错误\",\r\n        });\r\n\r\n        if (data.code === 200) {\r\n          resolve(data);\r\n        } else {\r\n          reject(data);\r\n        }\r\n      },\r\n      fail: (err) => {\r\n        reject(err);\r\n      },\r\n    });\r\n  });\r\n};\r\n"],"names":["uploadFile","filePath","userId","fileType","resolve","reject","uni","UPLOAD_FILE_URL","res","data","safeJsonParse","err"],"mappings":"sHA6BaA,EAAa,CAACC,EAAUC,EAAQC,EAAW,SAC/C,IAAI,QAAQ,CAACC,EAASC,IAAW,CACtCC,EAAAA,MAAI,WAAW,CACb,IAAKC,EAAe,gBACpB,SAAAN,EACA,KAAME,EACN,SAAU,CACR,OAAQD,CACT,EACD,QAAUM,GAAQ,CAChB,MAAMC,EAAOC,EAAAA,cAAcF,EAAI,KAAM,CACnC,KAAM,IACN,QAAS,UACnB,CAAS,EAEGC,EAAK,OAAS,IAChBL,EAAQK,CAAI,EAEZJ,EAAOI,CAAI,CAEd,EACD,KAAOE,GAAQ,CACbN,EAAOM,CAAG,CACX,CACP,CAAK,CACL,CAAG"}