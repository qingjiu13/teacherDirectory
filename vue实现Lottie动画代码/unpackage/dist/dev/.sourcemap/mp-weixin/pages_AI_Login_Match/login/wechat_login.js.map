{"version":3,"file":"wechat_login.js","sources":["pages_AI_Login_Match/login/wechat_login.vue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNfQUlfTG9naW5fTWF0Y2hcbG9naW5cd2VjaGF0X2xvZ2luLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"background-image\">\n    <image\n      class=\"background-image-img\"\n      src=\"/static/image/bgPicture/background1.png\"\n      mode=\"aspectFill\" alt=\"背景图\"\n    />\n  </view>\n  <view class=\"background-image\">\n    <image\n      class=\"background-image-img\"\n      src=\"/static/image/bgPicture/background.png\"\n      mode=\"aspectFill\" alt=\"背景图\"\n    />\n  </view>\n  <image\n      class=\"nav-back\"\n      src=\"/static/image/navBack.png\"\n      mode=\"aspectFit\"\n      @click=\"goBack\"\n  />\n  <view class=\"login-container\">\n    <!-- 内容区域 -->\n    <view class=\"content\">\n      <!-- 欢迎文案 -->\n      <view class=\"welcome-text\">\n        <text class=\"title\">欢迎使用</text>\n        <text class=\"subtitle\">请先登录以享受完整服务</text>\n      </view>\n      \n      <!-- 用户头像占位 -->\n      <view class=\"avatar-container\">\n        <view class=\"avatar-mask-outer\" @click=\"changeAvatar\">\n          <view class=\"avatar-mask-inner\"></view>\n          <image class=\"avatar-img\" :src=\"currentAvatar\" mode=\"aspectFill\"></image>\n        </view>\n        <view class=\"nickname-container\" @click=\"editNickname\">\n          <view class=\"nickname-text-container\">\n            <text class=\"nickname\">{{currentNickname}}</text>\n            <view class=\"nickname-underline\" :style=\"{width: nicknameWidth + 'px'}\"></view>\n          </view>\n          <image class=\"edit-icon\" src=\"../static/login/edit.png\" mode=\"aspectFill\"></image>\n        </view>\n      </view>\n      <!-- 一键登录按钮 -->\n      <button class=\"login-btn\" open-type=\"getPhoneNumber\"  @getphonenumber=\"getPhoneNumber\" v-if=\"!loginstate\">\n        <view class=\"btn-content\">\n          <text class=\"login-text\">一键登录</text>\n        </view>\n      </button>\n\n      \n      \n      <!-- 已登录状态 -->\n      <button class=\"login-btn logged-in\" v-else @click=\"toHome\">\n        <text>进入应用</text>\n      </button>\n      \n      <!-- 协议声明 -->\n      <view class=\"agreement\">\n        <text>登录即表示同意</text>\n        <view class=\"link-group\">\n          <text class=\"link\" @click=\"showAgreement\">《用户协议》</text>\n          <text>和</text>\n          <text class=\"link\" @click=\"showPrivacy\">《隐私政策》</text>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 用户协议弹窗 -->\n    <view class=\"modal-overlay\" v-if=\"showAgreementModal\" @click.stop=\"closeModal('agreement')\">\n      <view class=\"modal-content\" @click.stop>\n        <view class=\"modal-title\">用户协议</view>\n        <view class=\"modal-body\">\n          <view class=\"agreement-text\">\n            <view class=\"agreement-item\">就平台使用涉及的权利和义务与您做出如下约定：</view>\n            <view class=\"agreement-item\">1、您知晓并同意，登署本协议即代表您依照本协议公布的规则履行义务并享有权利。</view>\n            <view class=\"agreement-item\">2、您同意，注册并使用本平台服务时，需遵守相关法律法规和平台规定。</view>\n            <view class=\"agreement-item\">3、您同意，在使用平台服务过程中，遵守诚实信用原则，不发布违法、虚假或侵害他人权益的信息。</view>\n            <view class=\"agreement-item\">4、本平台保留对用户资料进行审核的权利，对违反协议的用户有权封禁账号。</view>\n          </view>\n        </view>\n        <view class=\"modal-footer\">\n          <button class=\"agree-btn\" @click=\"closeModal('agreement')\">我已悉知并同意</button>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 隐私政策弹窗 -->\n    <view class=\"modal-overlay\" v-if=\"showPrivacyModal\" @click.stop=\"closeModal('privacy')\">\n      <view class=\"modal-content\" @click.stop>\n        <view class=\"modal-title\">隐私政策</view>\n        <view class=\"modal-body\">\n          <view class=\"agreement-text\">\n            <view class=\"agreement-item\">本应用非常重视用户隐私政策并严格遵守相关法律法规：</view>\n            <view class=\"agreement-item\">1、我们只会收集必要的用户信息，包括但不限于用户昵称、头像等基本信息。</view>\n            <view class=\"agreement-item\">2、我们采取业界标准的安全防护措施保护您的个人信息安全。</view>\n            <view class=\"agreement-item\">3、未经您的同意，我们不会向任何第三方提供、出售、出租、分享或交易您的个人信息。</view>\n            <view class=\"agreement-item\">4、我们会通过合理有效的管理措施和技术手段，保护您提供的个人信息安全，防止信息泄露、损毁或丢失。</view>\n          </view>\n        </view>\n        <view class=\"modal-footer\">\n          <button class=\"agree-btn\" @click=\"closeModal('privacy')\">我已悉知并同意</button>\n        </view>\n      </view>\n    </view>\n    \n\n    \n    <!-- 头像选择弹窗 -->\n    <view class=\"avatar-modal\" v-if=\"showAvatarModal\" @click.stop=\"hideAvatarModal\">\n      <view class=\"avatar-modal-content\" @click.stop>\n        <view class=\"avatar-modal-title\">选择头像</view>\n        <view class=\"avatar-grid\">\n          <view \n            class=\"avatar-item\" \n            v-for=\"(avatar, index) in avatarList\" \n            :key=\"index\"\n            @click=\"selectAvatar(avatar)\"\n          >\n            <image class=\"avatar-option\" :src=\"avatar\" mode=\"aspectFill\"></image>\n          </view>\n          <!-- 自定义头像选项 -->\n          <view class=\"avatar-item custom-avatar-item\" @click=\"selectCustomAvatar\">\n            <view class=\"custom-avatar-container\">\n              <view class=\"custom-avatar-icon\">\n                <svg width=\"40\" height=\"40\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V21C3 22.11 3.89 23 5 23H19C20.11 23 21 22.11 21 21V9H21ZM15 3L19 7H15V3ZM5 5H13V9H19V21H5V5ZM12 10L10.5 12.5L9 11L6 15H18L15 11L12 10Z\" fill=\"#999\"/>\n                </svg>\n              </view>\n              <text class=\"custom-avatar-text\">自定义</text>\n            </view>\n          </view>\n        </view>\n        <button class=\"avatar-close-btn\" @click=\"hideAvatarModal\">取消</button>\n      </view>\n    </view>\n    \n    <!-- 昵称编辑弹窗 -->\n    <view class=\"nickname-modal\" v-if=\"showNicknameModal\" @click.stop=\"hideNicknameModal\">\n      <view class=\"nickname-modal-content\" @click.stop>\n        <view class=\"nickname-modal-title\">修改昵称</view>\n        <view class=\"nickname-input-container\">\n          <input \n            class=\"nickname-input\" \n            v-model=\"editingNickname\" \n            placeholder=\"请输入昵称\" \n            maxlength=\"20\"\n          />\n        </view>\n        <view class=\"nickname-modal-actions\">\n          <button class=\"nickname-cancel-btn\" @click=\"hideNicknameModal\">取消</button>\n          <button class=\"nickname-confirm-btn\" @click=\"confirmNickname\">确定</button>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script lang=\"uts\">\nimport { Navigator } from '../../router/Router';\nimport { generateRandomNickName } from './randomNickName.js';\nimport { useGlobalStore } from '@/store/global.js';\nimport { apiRequest } from '@/store/user/JWT';\nconst getApiPrefix = () => {\n  const globalStore = useGlobalStore()\n  return globalStore.apiBaseUrl\n}\n\nexport default {\n  data() {\n    return {\n      openid: \"\",\n      loginstate: \"\",\n      showPhoneModal: false, // 手机号授权弹窗\n      showAgreementModal: false,\n      showPrivacyModal: false,\n      showAvatarModal: false, // 头像选择弹窗\n      showNicknameModal: false, // 昵称编辑弹窗\n      currentNickname: \"\", // 当前昵称\n      editingNickname: \"\", // 编辑中的昵称\n      currentAvatar: '', // 当前头像，初始为空，从后端获取默认头像列表后设置\n      nicknameWidth: 0, // 昵称文字宽度\n      avatarList: [], // 从后端获取的默认头像列表\n      maskedPhoneNumber: \"\"\n    }\n  },\n  \n  /**\n   * 页面加载时初始化\n   */\n  onLoad() {\n    this.initializeUserInfo();\n    // this.getWechatOpenid();\n    this.checkLoginState();\n    this.loadDefaultAvatarList();\n  },\n  \n  mounted() {\n    // 计算昵称宽度\n    this.$nextTick(() => {\n      this.calculateNicknameWidth();\n    });\n  },\n  \n  watch: {\n    currentNickname() {\n      this.$nextTick(() => {\n        this.calculateNicknameWidth();\n      });\n    }\n  },\n  \n  methods: {\n    /**\n     * 初始化用户信息\n     */\n    initializeUserInfo() {\n      // 从缓存获取昵称，如果没有则生成随机昵称\n      uni.getStorage({\n        key: 'currentNickname',\n        success: (res) => {\n          this.currentNickname = res.data;\n        },\n        fail: () => {\n          this.currentNickname = generateRandomNickName();\n          uni.setStorage({\n            key: 'currentNickname',\n            data: this.currentNickname\n          });\n        }\n      });\n      \n      // 从缓存获取头像\n      uni.getStorage({\n        key: 'currentAvatar',\n        success: (res) => {\n          this.currentAvatar = res.data;\n        },\n        fail: () => {\n          // 如果缓存中没有头像，则等待从后端获取默认头像列表后设置\n        }\n      });\n    },\n    \n    /**\n     * 加载默认头像列表\n     */\n     async loadDefaultAvatarList() {\n        try {\n          const response = await apiRequest(\n            `${getApiPrefix()}/common/defaultAvatarList`,\n            'GET',\n            {},\n            { requireAuth: false }\n          );\n          uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:257','获取默认头像列表:', response);\n          this.avatarList = response.data.data;\n\n          // 如果当前没有设置头像，则使用第一个默认头像\n          if (!this.currentAvatar && this.avatarList.length > 0) {\n            this.currentAvatar = this.avatarList[0];\n            uni.setStorage({\n              key: 'currentAvatar',\n              data: this.currentAvatar\n            });\n          }\n        } catch (error) {\n          uni.__f__('error','at pages_AI_Login_Match/login/wechat_login.vue:269','获取默认头像列表失败:', error);\n\n          // 即使失败，也保证 currentAvatar 有默认值\n          if (!this.currentAvatar && this.avatarList?.length > 0) {\n            this.currentAvatar = this.avatarList[0];\n            uni.setStorage({\n              key: 'currentAvatar',\n              data: this.currentAvatar\n            });\n          }\n        }\n    },\n    \n\n    \n    /**\n     * 检查登录状态\n     */\n    checkLoginState() {\n      uni.getStorage({\n        key: 'loginstate',\n        success: (res) => {\n          this.loginstate = res.data;\n        }, \n        fail: () => {\n          uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:294',\"未登录\");\n        }\n      });\n    },\n    \n    /**\n     * 计算昵称文字宽度\n     */\n    calculateNicknameWidth() {\n      const query = uni.createSelectorQuery().in(this);\n      query.select('.nickname').boundingClientRect(data => {\n        if (data) {\n          this.nicknameWidth = data.width;\n        }\n      }).exec();\n    },\n    \n    /**\n     * 隐藏手机号授权弹窗\n     */\n    hidePhoneModal() {\n      this.showPhoneModal = false;\n    },\n    \n    /**\n     * 微信手机号授权回调 - 统一的登录入口\n     * @param {Object} e - 微信授权回调事件对象\n     * @param {Object} e.detail - 授权详情\n     * @param {string} e.detail.code - 动态令牌（新版API）\n     * @param {string} e.detail.errMsg - 错误信息\n     */\n    async getPhoneNumber(e) {\n      uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:326','微信手机号授权回调:', e);\n      \n      // 检查授权是否成功\n      if (e.detail.errMsg !== 'getPhoneNumber:ok') {\n        uni.__f__('error','at pages_AI_Login_Match/login/wechat_login.vue:330','用户拒绝授权或授权失败:', e.detail.errMsg);\n        this.handleAuthorizationFailed(e.detail.errMsg);\n        return;\n      }\n      \n      // 检查是否获取到code\n      if (!e.detail.code) {\n        uni.__f__('error','at pages_AI_Login_Match/login/wechat_login.vue:337','未获取到授权code');\n        uni.showToast({\n          title: '获取授权信息失败',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      // 执行登录流程\n      await this.performLogin(e.detail.code);\n    },\n\n    /**\n     * 处理授权失败的情况\n     * @param {string} errMsg - 错误信息\n     */\n    handleAuthorizationFailed(errMsg) {\n      // 根据不同的错误类型给出不同的提示\n      let title = '授权失败';\n      let content = '登录需要您的授权，请重新点击按钮进行授权。';\n      \n      if (errMsg.includes('deny') || errMsg.includes('cancel')) {\n        title = '授权被取消';\n        content = '您取消了手机号授权，无法完成登录。请重新点击按钮进行授权。';\n      } else if (errMsg.includes('fail')) {\n        title = '授权失败';\n        content = '授权过程中出现问题，请检查网络连接后重试。';\n      }\n      \n      uni.showModal({\n        title: title,\n        content: content,\n        confirmText: '知道了',\n        showCancel: false,\n        success: (res) => {\n          if (res.confirm) {\n            uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:373','用户确认授权失败提示');\n          }\n        }\n      });\n    },\n\n    /**\n     * 执行登录流程\n     * @param {string} phoneCode - 微信手机号授权code\n     */\n    async performLogin(phoneCode) {\n      try {\n        // 显示登录进度\n        uni.showLoading({\n          title: '登录中...',\n          mask: true\n        });\n        \n        // 1. 获取微信登录code\n        const wechatCode = await this.getWechatLoginCode();\n        uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:393','获取到微信登录code:', wechatCode);\n        \n        // 2. 准备登录请求数据\n        const loginData = {\n          phoneCode: phoneCode,           // 手机号授权code\n          wechatCode: wechatCode,         // 微信登录code\n          avatar: this.currentAvatar,     // 用户选择的头像\n          nickname: this.currentNickname  // 用户设置的昵称\n        };\n        \n        uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:403','发送登录请求数据:', loginData);\n        \n        // 3. 发送登录请求到后端\n        const response = await this.sendLoginRequest(loginData);\n        \n        // 4. 处理登录结果\n        await this.handleLoginResponse(response);\n        \n      } catch (error) {\n        // 处理登录过程中的异常\n        this.handleLoginError(error);\n      }\n    },\n\n    /**\n     * 发送登录请求到后端\n     * @param {Object} loginData - 登录数据\n     * @returns {Promise<Object>} 登录响应\n     */\n    async sendLoginRequest(loginData) {\n      const response = await apiRequest(`${getApiPrefix()}/auth/wechat/phoneLogin`, 'POST', loginData, {\n        requireAuth: false,  // 登录接口不需要认证\n        showError: false,    // 手动处理错误\n        timeout: 10000       // 10秒超时\n      });\n      \n      uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:429','登录响应:', response);\n      return response;\n    },\n\n    /**\n     * 处理登录响应\n     * @param {Object} response - 后端响应\n     */\n    async handleLoginResponse(response) {\n      if (response.success && response.data && response.data.token) {\n        // 登录成功\n        await this.handleLoginSuccess(response.data);\n      } else {\n        // 登录失败\n        const errorMsg = response.message || response.msg || '登录失败，请重试';\n        throw new Error(errorMsg);\n      }\n    },\n\n    /**\n     * 处理登录成功\n     * @param {Object} loginData - 登录成功返回的数据\n     */\n    async handleLoginSuccess(loginData) {\n      try {\n        // 存储JWT token到store\n        this.$store.commit('user/baseInfo/SET_JWT_TOKEN', loginData.token);\n        \n        // 如果后端返回了用户信息，也更新到store\n        if (loginData.userInfo) {\n          this.$store.commit('user/baseInfo/SET_USER_INFO', loginData.userInfo);\n        }\n        \n        // 更新登录状态\n        this.$store.commit('user/baseInfo/SET_LOGIN_STATUS', 1);\n        this.loginstate = 1;\n        \n        // 存储登录状态到本地缓存\n        await this.saveLoginStateToStorage();\n        \n        // 隐藏加载提示\n        uni.hideLoading();\n        \n        // 显示成功提示\n        uni.showToast({\n          title: '登录成功',\n          icon: 'success',\n          duration: 1500\n        });\n        \n        uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:479','登录成功，JWT token已存储:', loginData.token);\n        \n        // 延迟跳转到首页\n        setTimeout(() => {\n          this.toHome();\n        }, 1500);\n        \n      } catch (error) {\n        uni.__f__('error','at pages_AI_Login_Match/login/wechat_login.vue:487','处理登录成功数据时出错:', error);\n        throw new Error('登录成功但数据处理失败');\n      }\n    },\n\n    /**\n     * 保存登录状态到本地存储\n     */\n    async saveLoginStateToStorage() {\n      return new Promise((resolve, reject) => {\n        uni.setStorage({\n          key: 'loginstate',\n          data: 1,\n          success: () => {\n            uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:501','登录状态已保存到本地存储');\n            resolve();\n          },\n          fail: (error) => {\n            uni.__f__('error','at pages_AI_Login_Match/login/wechat_login.vue:505','保存登录状态失败:', error);\n            reject(error);\n          }\n        });\n      });\n    },\n\n    /**\n     * 处理登录错误\n     * @param {Error} error - 错误对象\n     */\n    handleLoginError(error) {\n      uni.hideLoading();\n      uni.__f__('error','at pages_AI_Login_Match/login/wechat_login.vue:518','登录过程中发生错误:', error);\n      \n      let errorMsg = '登录失败，请重试';\n      \n      // 根据不同的错误类型给出不同的提示\n      if (error.message) {\n        if (error.message.includes('网络')) {\n          errorMsg = '网络连接失败，请检查网络后重试';\n        } else if (error.message.includes('超时')) {\n          errorMsg = '登录超时，请重试';\n        } else if (error.message.includes('服务器')) {\n          errorMsg = '服务器繁忙，请稍后重试';\n        } else {\n          errorMsg = error.message;\n        }\n      }\n      \n      uni.showModal({\n        title: '登录失败',\n        content: errorMsg,\n        confirmText: '重试',\n        cancelText: '取消',\n        success: (res) => {\n          if (res.confirm) {\n            uni.__f__('log','at pages_AI_Login_Match/login/wechat_login.vue:542','用户选择重试登录');\n            // 可以在这里添加重试逻辑\n          }\n        }\n      });\n    },\n\n    /**\n     * 获取微信登录code\n     * @returns {Promise<string>} 返回微信登录code\n     */\n    getWechatLoginCode() {\n      return new Promise((resolve, reject) => {\n        uni.login({\n          provider: 'weixin',\n          success: (res) => {\n            if (res.code) {\n              resolve(res.code);\n            } else {\n              reject(new Error('获取微信登录code失败'));\n            }\n          },\n          fail: (err) => {\n            uni.__f__('error','at pages_AI_Login_Match/login/wechat_login.vue:565','uni.login失败:', err);\n            reject(new Error('获取微信登录code失败'));\n          }\n        });\n      });\n    },\n    \n    /**\n     * 使用其它号码\n     */\n    useOtherPhone() {\n      uni.showToast({\n        title: '暂不支持其它号码',\n        icon: 'none'\n      });\n    },\n    \n    /**\n     * 更换头像\n     */\n    changeAvatar() {\n      this.showAvatarModal = true;\n    },\n    \n    /**\n     * 隐藏头像选择弹窗\n     */\n    hideAvatarModal() {\n      this.showAvatarModal = false;\n    },\n    \n    /**\n     * 选择头像\n     * @param {string} avatar - 头像路径\n     */\n    selectAvatar(avatar) {\n      this.currentAvatar = avatar;\n      uni.setStorage({\n        key: 'currentAvatar',\n        data: avatar\n      });\n      this.hideAvatarModal();\n      uni.showToast({\n        title: '头像已更换',\n        icon: 'success'\n      });\n    },\n    \n    /**\n     * 编辑昵称\n     */\n    editNickname() {\n      this.editingNickname = this.currentNickname;\n      this.showNicknameModal = true;\n    },\n    \n    /**\n     * 隐藏昵称编辑弹窗\n     */\n    hideNicknameModal() {\n      this.showNicknameModal = false;\n      this.editingNickname = \"\";\n    },\n    \n    /**\n     * 确认昵称修改\n     */\n    confirmNickname() {\n      if (!this.editingNickname.trim()) {\n        uni.showToast({\n          title: '昵称不能为空',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      this.currentNickname = this.editingNickname.trim();\n      uni.setStorage({\n        key: 'currentNickname',\n        data: this.currentNickname\n      });\n      \n      this.hideNicknameModal();\n      uni.showToast({\n        title: '昵称已修改',\n        icon: 'success'\n      });\n    },\n    \n    /**\n     * 跳转到首页\n     */\n    toHome() {\n      Navigator.toIndex();\n    },\n    \n    /**\n     * 返回上一页\n     */\n    goBack() {\n      Navigator.toIndex();\n    },\n    \n    /**\n     * 显示用户协议弹窗\n     */\n    showAgreement() {\n      this.showAgreementModal = true;\n    },\n    \n    /**\n     * 显示隐私政策弹窗\n     */\n    showPrivacy() {\n      this.showPrivacyModal = true;\n    },\n    \n    /**\n     * 关闭弹窗\n     * @param {string} type - 要关闭的弹窗类型（'agreement'或'privacy'）\n     */\n    closeModal(type) {\n      if (type === 'agreement') {\n        this.showAgreementModal = false;\n      } else if (type === 'privacy') {\n        this.showPrivacyModal = false;\n      }\n    },\n\n    /**\n     * 上传用户自定义头像文件\n     * @param {string} filePath - 本地文件路径\n     * @returns {Promise<Object>} 返回上传结果，包含头像URL和文件信息\n     */\n    uploadAvatarFile(filePath) {\n      return new Promise((resolve, reject) => {\n        uni.uploadFile({\n          url: `${getApiPrefix()}/common/uploadAvatarFile`,\n          filePath: filePath,\n          name: 'avatar',\n          header: {\n            'content-type': 'multipart/form-data'\n          },\n          formData: {\n            type: 'avatar',\n            timestamp: Date.now()\n          },\n          success: (res) => {\n            try {\n              const data = JSON.parse(res.data);\n              // 实际返回格式：{\"msg\":\"操作成功\",\"code\":200,\"data\":{\"fileName\":\"...\",\"newFileName\":\"...\",\"url\":\"...\",\"originalFilename\":\"...\"}}\n              if (data.code === 200) {\n                resolve({\n                  url: data.data.url,\n                  fileName: data.data.fileName,\n                  newFileName: data.data.newFileName,\n                  originalFilename: data.data.originalFilename,\n                  message: data.msg || '上传成功'\n                });\n              } else {\n                reject(new Error(data.msg || '上传头像失败'));\n              }\n            } catch (error) {\n              reject(new Error('服务器响应格式错误'));\n            }\n          },\n          fail: (error) => {\n            reject(new Error('上传头像网络请求失败'));\n          }\n        });\n      });\n    },\n\n    /**\n     * 选择自定义头像\n     */\n    selectCustomAvatar() {\n      uni.chooseImage({\n        count: 1,\n        sizeType: ['compressed'],\n        sourceType: ['album', 'camera'],\n        success: async (res) => {\n          const tempFilePath = res.tempFilePaths[0];\n          \n          // 显示上传进度\n          uni.showLoading({\n            title: '上传头像中...'\n          });\n          \n          try {\n            // 上传头像到服务器\n            const uploadResult = await this.uploadAvatarFile(tempFilePath);\n            \n            // 使用服务器返回的URL\n            this.currentAvatar = uploadResult.url;\n            uni.setStorage({\n              key: 'currentAvatar',\n              data: uploadResult.url\n            });\n            \n            uni.hideLoading();\n            this.hideAvatarModal();\n            uni.showToast({\n              title: '头像已更换',\n              icon: 'success'\n            });\n          } catch (error) {\n            uni.hideLoading();\n            uni.__f__('error','at pages_AI_Login_Match/login/wechat_login.vue:773','上传头像失败:', error);\n            uni.showToast({\n              title: error.message || '上传头像失败',\n              icon: 'none'\n            });\n          }\n        },\n        fail: (err) => {\n          uni.__f__('error','at pages_AI_Login_Match/login/wechat_login.vue:781','选择图片失败:', err);\n          uni.showToast({\n            title: '选择图片失败',\n            icon: 'none'\n          });\n        }\n      });\n    }\n  }\n}\n</script>\n\n<style>\n.background-image {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  z-index: 0;\n  pointer-events: none;\n}\n.background-image-img {\n  width: 100vw;\n  height: 100vh;\n  object-fit: cover;\n  display: block;\n}\n.login-container {\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  background-color: transparent;\n}\n.header-bg {\n  width: 100%;\n  height: 600rpx;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n.bg-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n.content {\n  position: relative;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  z-index: 1;\n  background-color: transparent;\n}\n.blur-bottom-bg {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 0;\n  background: rgba(255, 255, 255, 0.5);\n  backdrop-filter: blur(100px);\n  pointer-events: none;\n}\n/* 返回按钮样式 */\n.nav-back {\n  position: absolute;\n  top: 134rpx;\n  left: 40rpx;\n  width: 72rpx;\n  height: 62rpx;\n  z-index: 100;\n}\n.welcome-text {\n  display: flex;\n  flex-direction: column;\n  margin-left: 100rpx;\n  margin-top: 270rpx;\n  width: 100%;\n}\n.welcome-text .title {\n  font-family: 'PingFang SC';\n  font-weight: 400;\n  font-size: 48rpx;\n  line-height: 70rpx;\n  letter-spacing: -1.1rpx;\n  color: rgba(0, 0, 0, 1);\n\n}\n.welcome-text .subtitle {\n  font-family: 'PingFang SC';\n  font-weight: 400;\n  font-size: 32rpx;\n  line-height: 70rpx;\n  letter-spacing: -1.1rpx;\n  color: #666;\n  text-align: left;\n}\n.avatar-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-bottom: 80rpx;\n  margin-top: 220rpx;\n}\n.avatar-mask-outer {\n  position: relative;\n  width: 180rpx; /* 外层尺寸 */\n  height: 180rpx;\n  border-radius: 30rpx; /* 外层圆角 */\n  background: rgba(95, 38, 247, 1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n.avatar-mask-inner {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  width: 168rpx; /* 内层尺寸 */\n  height: 168rpx;\n  border-radius: 24rpx; /* 内层圆角 */\n  z-index: 2;\n  /* 关键：内层透明，遮住外层 */\n  background: rgba(255, 255, 255, 1);\n  transform: translate(-50%, -50%);\n}\n.avatar-img {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  width: 168rpx; /* 头像尺寸略小于内层 */\n  height: 168rpx;\n  border-radius: 24rpx;\n  transform: translate(-50%, -50%);\n  z-index: 3;\n}\n\n/* 昵称容器样式 */\n.nickname-container {\n  position: relative;\n  margin-top: 20rpx;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  flex-direction: row;\n}\n\n.nickname {\n  font-size: 36rpx;\n  color: rgba(0, 0, 0, 1);\n  font-family: PingFang SC;\n  font-weight: 400;\n  line-height: 70rpx;\n  letter-spacing: -1.1rpx;\n}\n\n.nickname-underline {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  height: 4rpx;\n  background-color: #1989fa;\n  transition: width 0.3s ease;\n}\n\n.edit-icon {\n  width: 50rpx;\n  height: 50rpx;\n  margin-left: 10rpx;\n  margin-top: 20rpx;\n}\n\n.login-btn {\n  width: 318rpx;\n  height: 88rpx;\n  line-height: 50rpx;\n  border-radius: 20rpx;\n  background: rgba(22, 217, 26, 1);\n  color: #fff;\n  font-size: 32rpx;\n}\n\n.login-btn .btn-content {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.login-btn .wechat-icon {\n  width: 48rpx;\n  height: 38rpx;\n  margin-right: 40rpx;\n}\n.login-btn .login-text {\n  font-family: PingFang SC;\n  font-weight: 400;\n  font-size: 36rpx;\n  line-height: 100%;\n  letter-spacing: -0.68px;\n  text-align: center;\n}\n.agreement {\n  margin-top: 20rpx;\n  font-size: 24rpx;\n  color: rgba(0, 0, 0, 1);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-wrap: nowrap;\n  flex-direction: row;\n}\n.agreement .link-group {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  gap: 6rpx;\n  margin-left: 8rpx;\n}\n.agreement .link {\n  color: #1989fa;\n}\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 999;\n}\n.modal-content {\n  width: 80%;\n  max-height: 70vh;\n  background-color: #fff;\n  border-radius: 20rpx;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n.modal-title {\n  text-align: center;\n  font-size: 36rpx;\n  font-weight: bold;\n  padding: 30rpx 0;\n  color: #333;\n  border-bottom: 1px solid #f0f0f0;\n}\n.modal-body {\n  padding: 30rpx;\n  flex: 1;\n  overflow-y: auto;\n}\n.agreement-text {\n  font-size: 28rpx;\n  color: #333;\n  line-height: 1.6;\n}\n.agreement-item {\n  margin-bottom: 20rpx;\n}\n.modal-footer {\n  padding: 20rpx 30rpx 40rpx;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.modal-footer .agree-btn {\n  width: 80%;\n  height: 80rpx;\n  line-height: 80rpx;\n  text-align: center;\n  background: linear-gradient(to right, #1989fa, #3194fa);\n  color: #fff;\n  font-size: 30rpx;\n  border-radius: 40rpx;\n  border: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0;\n}\n\n/* 类似滴滴的手机号授权弹窗样式 */\n.phone-auth-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 999;\n  display: flex;\n  align-items: flex-end;\n  justify-content: center;\n}\n\n.phone-modal-mask {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n\n.phone-modal-content {\n  width: 100%;\n  background-color: #fff;\n  border-radius: 40rpx 40rpx 0 0;\n  padding: 60rpx 40rpx 60rpx;\n  position: relative;\n  transform: translateY(100%);\n  transition: transform 0.3s ease-out;\n  z-index: 1000;\n}\n\n.phone-modal-content.show {\n  position: absolute;\n  transform: translateY(0);\n  bottom: 0;\n}\n\n.phone-modal-header {\n  margin-bottom: 60rpx;\n}\n\n.phone-modal-top-bar {\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  flex-direction: column;\n}\n\n.phone-modal-logo {\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  flex-direction: row;\n  width: 100%;\n  text-align: left;\n}\n\n\n.app-logo {\n  width: 60rpx;\n  height: 60rpx;\n  margin-right: 20rpx;\n}\n\n.app-name {\n  font-size: 36rpx;\n  font-weight: 600;\n  color: #333;\n}\n\n.phone-modal-subtitle {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: #333;\n  margin-top: 20rpx;\n  text-align: left;\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  flex-direction: row;\n  width: 100%;\n}\n\n.phone-modal-description {\n  font-size: 28rpx;\n  color: #666;\n  line-height: 1.5;\n  text-align: left;\n}\n\n.phone-number-display {\n  background-color: #f8f9fa;\n  border-radius: 20rpx;\n  padding: 40rpx;\n  margin-bottom: 40rpx;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  position: relative;\n}\n\n.phone-number-display:active {\n  background-color: #e8f4fd;\n  border-color: #1989fa;\n  transform: scale(0.98);\n}\n\n.phone-number-text {\n  font-size: 36rpx;\n  font-weight: 500;\n  color: #333;\n  margin-bottom: 10rpx;\n}\n\n.phone-provider {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.phone-modal-actions {\n  background-color: #f8f9fa;\n  border-radius: 20rpx;\n  padding: 40rpx;\n  margin-bottom: 40rpx;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  border: 2rpx solid transparent;\n  position: relative;\n}\n\n.phone-deny-btn {\n  font-size: 36rpx;\n  font-weight: 500;\n  color: #333;\n}\n\n.phone-alternative {\n  margin-bottom: 40rpx;\n  padding: 20rpx;\n  text-align: center;\n}\n\n.alternative-text {\n  font-size: 28rpx;\n  color: #1989fa;\n}\n\n/* 头像选择弹窗样式 */\n.avatar-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 999;\n}\n\n.avatar-modal-content {\n  width: 80%;\n  background-color: #fff;\n  border-radius: 20rpx;\n  padding: 40rpx;\n}\n\n.avatar-modal-title {\n  text-align: center;\n  font-size: 36rpx;\n  font-weight: bold;\n  margin-bottom: 40rpx;\n  color: #333;\n}\n\n.avatar-grid {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 30rpx;\n  margin-bottom: 40rpx;\n}\n\n.avatar-item {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 20rpx;\n  overflow: hidden;\n  background-color: #f5f5f5;\n  cursor: pointer;\n  aspect-ratio: 1;\n}\n\n.avatar-option {\n  width: 120rpx;\n  height: 120rpx;\n  border-radius: 20rpx;\n}\n\n/* 自定义头像选项样式 */\n.custom-avatar-item {\n  background-color: #fafafa;\n  border: 2rpx dashed #ccc;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n\n.custom-avatar-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n}\n\n.custom-avatar-icon {\n  margin-bottom: 10rpx;\n}\n\n.custom-avatar-text {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.avatar-close-btn {\n  width: 100%;\n  height: 80rpx;\n  line-height: 80rpx;\n  text-align: center;\n  background-color: #f0f0f0;\n  color: #666;\n  font-size: 30rpx;\n  border-radius: 40rpx;\n  border: none;\n}\n\n/* 昵称编辑弹窗样式 */\n.nickname-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 999;\n}\n\n.nickname-modal-content {\n  width: 80%;\n  background-color: #fff;\n  border-radius: 20rpx;\n  padding: 40rpx;\n}\n\n.nickname-modal-title {\n  text-align: center;\n  font-size: 36rpx;\n  font-weight: bold;\n  margin-bottom: 40rpx;\n  color: #333;\n}\n\n.nickname-input-container {\n  margin-bottom: 40rpx;\n}\n\n.nickname-input {\n  width: 100%;\n  height: 80rpx;\n  border: 2rpx solid #e5e5e5;\n  border-radius: 10rpx;\n  padding: 0 20rpx;\n  font-size: 32rpx;\n  color: #333;\n  text-align: center;\n}\n\n.nickname-modal-actions {\n  display: flex;\n  flex-direction: row;\n  gap: 20rpx;\n}\n\n.nickname-cancel-btn {\n  flex: 1;\n  height: 80rpx;\n  line-height: 80rpx;\n  text-align: center;\n  background-color: #f0f0f0;\n  color: #666;\n  font-size: 30rpx;\n  border-radius: 40rpx;\n  border: none;\n}\n\n.nickname-confirm-btn {\n  flex: 1;\n  height: 80rpx;\n  line-height: 80rpx;\n  text-align: center;\n  background: linear-gradient(to right, #1989fa, #3194fa);\n  color: #fff;\n  font-size: 30rpx;\n  border-radius: 40rpx;\n  border: none;\n}\n</style> ","import MiniProgramPage from 'E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/pages_AI_Login_Match/login/wechat_login.vue'\nwx.createPage(MiniProgramPage)"],"names":["getApiPrefix","useGlobalStore","_sfc_main","defineComponent","uni","res","generateRandomNickName","response","apiRequest","error","_a","data","e","errMsg","title","content","phoneCode","wechatCode","loginData","errorMsg","resolve","reject","err","avatar","Navigator","type","filePath","__awaiter","tempFilePath","uploadResult","MiniProgramPage"],"mappings":"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"}