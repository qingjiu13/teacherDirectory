{"version":3,"file":"login_detail.js","sources":["pages_AI_Login_Match/login/login_detail.js","pages_AI_Login_Match/login/login_detail.vue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNfQUlfTG9naW5fTWF0Y2hcbG9naW5cbG9naW5fZGV0YWlsLnZ1ZQ"],"sourcesContent":["import { useGlobalStore } from '@/store/global.js';\r\nimport { apiRequest } from '@/store/user/JWT';\r\n\r\n/**\r\n * @description 获取API前缀\r\n * @returns {string} API基础URL\r\n */\r\nconst getApiPrefix = () => {\r\n    const globalStore = useGlobalStore()\r\n    return globalStore.apiBaseUrl\r\n}\r\n\r\n/**\r\n * @description 提交用户信息数据\r\n * @param {Object} params - 提交参数\r\n * @param {string} params.userRole - 用户角色（'老师' 或 '学生'）\r\n * @param {Object} params.userInfo - 用户信息对象\r\n * @param {boolean} params.isSkip - 是否跳过（默认false）\r\n * @returns {Promise} API请求Promise\r\n */\r\nexport const submitUserInfo = async ({ userRole, userInfo, isSkip = false }) => {\r\n  try {\r\n    const apiPrefix = getApiPrefix();\r\n    \r\n    // 根据用户角色确定接口路径和数据格式\r\n    let apiPath = '';\r\n    let submitData = {};\r\n    \r\n    if (userRole === '老师') {\r\n      apiPath = '/yanshilu/teacher/save';\r\n      \r\n      if (isSkip) {\r\n        // 跳过时所有字段传null\r\n        submitData = {\r\n          schoolId: null,\r\n          professionalId: null,\r\n          gradeType: null\r\n        };\r\n      } else {\r\n        // 提交时按表单数据传输\r\n        submitData = {\r\n          schoolId: userInfo.targetSchoolId || null,\r\n          professionalId: userInfo.targetMajorId || null,\r\n          gradeType: userInfo.gradeType || null\r\n        };\r\n      }\r\n    } else if (userRole === '学生') {\r\n      apiPath = '/yanshilu/student/save';\r\n      \r\n      if (isSkip) {\r\n        // 跳过时所有字段传null\r\n        submitData = {\r\n          targetSchoolId: null,\r\n          targetProfessionalId: null,\r\n          currentSchoolId: null,\r\n          currentProfessionalId: null,\r\n          gradeType: null\r\n        };\r\n      } else {\r\n        // 提交时按表单数据传输\r\n        submitData = {\r\n          targetSchoolId: userInfo.targetSchoolId || null,\r\n          targetProfessionalId: userInfo.targetMajorId || null,\r\n          currentSchoolId: userInfo.schoolId || null,\r\n          currentProfessionalId: userInfo.majorId || null,\r\n          gradeType: userInfo.gradeType || null\r\n        };\r\n      }\r\n    } else {\r\n      throw new Error('无效的用户角色');\r\n    }\r\n    \r\n    // 发起API请求\r\n    const response = await apiRequest(`${apiPrefix}${apiPath}`,'POST',submitData);\r\n    \r\n    // 检查响应状态\r\n    if (response.data.code === 200) {\r\n      return {\r\n        success: true,\r\n        message: response.data.msg,\r\n        data: response.data\r\n      };\r\n    } else {\r\n      return {\r\n        success: false,\r\n        message: response.data.msg || '提交失败',\r\n        data: response.data\r\n      };\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('提交用户信息失败:', error);\r\n    return {\r\n      success: false,\r\n      message: error.message || '网络请求失败',\r\n      error: error\r\n    };\r\n  }\r\n};\r\n\r\n","<template>\r\n  <Header :title=\"'登录详情'\" @back=\"handleBack\" class=\"header-container\"/>\r\n\t<view class=\"background-image\">\r\n    <image\r\n        src=\"/static/image/bgPicture/background1.png\"\r\n        mode=\"aspectFill\" alt=\"背景图\"\r\n      />\r\n    </view>\r\n    <view class=\"background-image\">\r\n      <image\r\n        src=\"/static/image/bgPicture/background.png\"\r\n        mode=\"aspectFill\" alt=\"背景图\"\r\n      />\r\n  </view>\r\n  <view class=\"form-container\">\r\n          <!-- 表单内容 -->\r\n    <view class=\"form-card\">\r\n      <view class=\"reminder-outer\">\r\n        <view class=\"reminder-inner\">\r\n          <text class=\"reminder-text\">以下信息为选填项，您可以选择填写您想提供的信息</text>\r\n        </view>\r\n      </view>\r\n      <!-- 普通学校和专业筛选框 - 仅学生显示 -->\r\n      <template v-if=\"userRole === '学生'\">\r\n        <!-- School - 使用单输入筛选框 -->\r\n        <view class=\"form-row\">\r\n          <view class=\"label-container\">\r\n            <text class=\"form-label\">就读学校</text>\r\n            <text class=\"optional-tag\">(选填)</text>\r\n          </view>\r\n          <ChoiceSelected\r\n            class=\"form-select\"\r\n            componentType=\"undergraduate\"\r\n            :choiceIndex=\"formData.schoolIndex\"\r\n            :choiceList=\"schoolOptions\"\r\n            defaultText=\"请选择学校\"\r\n            mode=\"search\"\r\n            searchPlaceholder=\"输入学校名称\"\r\n            @onChoiceClick=\"handleSchoolSelect\"\r\n            @search-input=\"handleSchoolSearch\"\r\n            :enablePagination=\"true\"\r\n            :pageSize=\"10\"\r\n            :loading=\"undergraduateSchoolSearchData.isLoading\"\r\n            ref=\"schoolDropdown\"\r\n          />\r\n        </view>\r\n        \r\n        <!-- Major - 使用单输入筛选框 -->\r\n        <view class=\"form-row\">\r\n          <view class=\"label-container\">\r\n            <text class=\"form-label\">就读专业</text>\r\n            <text class=\"optional-tag\">(选填)</text>\r\n          </view>\r\n          <ChoiceSelected\r\n            class=\"form-select\"\r\n            componentType=\"undergraduate\"\r\n            :choiceIndex=\"formData.majorIndex\"\r\n            :choiceList=\"majorOptions\"\r\n            defaultText=\"请选择专业\"\r\n            mode=\"search\"\r\n            searchPlaceholder=\"输入专业名称\"\r\n            @onChoiceClick=\"handleMajorSelect\"\r\n            @search-input=\"handleMajorSearch\"\r\n            :enablePagination=\"true\"\r\n            :pageSize=\"10\"\r\n            :loading=\"undergraduateMajorSearchData.isLoading\"\r\n            ref=\"majorDropdown\"\r\n          />\r\n        </view>\r\n      </template>\r\n\r\n      <!-- Grade -->\r\n      <view class=\"form-row\">\r\n        <view class=\"label-container\">\r\n          <text class=\"form-label\">年级</text>\r\n          <text class=\"optional-tag\">(选填)</text>\r\n        </view>\r\n        <ChoiceSelected\r\n          class=\"form-select\"\r\n          :choiceIndex=\"formData.gradeIndex\"\r\n          :choiceList=\"gradeList\"\r\n          defaultText=\"请选择年级\"\r\n          mode=\"select\"\r\n          @onChoiceClick=\"handleGradeSelect\"\r\n        />\r\n      </view>\r\n      \r\n      <!-- 目标学校和目标专业筛选框 - 学生和老师都显示，但标签有区别 -->\r\n      <template>\r\n          <!-- Target School -->\r\n          <view class=\"form-row\">\r\n            <view class=\"label-container\">\r\n              <text class=\"form-label\">{{ userRole === '学生' ? '目标学校' : '就读学校' }}</text>\r\n              <text class=\"optional-tag\">(选填)</text>\r\n            </view>\r\n            <ChoiceSelected\r\n              class=\"form-select\"\r\n              componentType=\"graduateSchool\"\r\n              :choiceIndex=\"formData.targetSchoolIndex\"\r\n              :choiceList=\"targetSchoolOptions\"\r\n              :defaultText=\"userRole === '学生' ? '请选择目标学校' : '请选择学校'\"\r\n              mode=\"search\"\r\n              :searchPlaceholder=\"userRole === '学生' ? '输入目标学校名称' : '输入学校名称'\"\r\n              @onChoiceClick=\"handleTargetSchoolSelect\"\r\n              @search-input=\"handleTargetSchoolSearch\"\r\n              @linkage-change=\"handleSchoolChange\"\r\n              :enablePagination=\"true\"\r\n              :pageSize=\"10\"\r\n              :loading=\"graduateSchoolSearchData.isLoading\"\r\n              ref=\"targetSchoolDropdown\"\r\n            />\r\n          </view>\r\n          \r\n          <!-- Target Major -->\r\n          <view class=\"form-row\">\r\n            <view class=\"label-container\">\r\n              <text class=\"form-label\">{{ userRole === '学生' ? '目标专业' : '就读专业' }}</text>\r\n              <text class=\"optional-tag\">(选填)</text>\r\n            </view>\r\n            <ChoiceSelected\r\n              class=\"form-select\"\r\n              componentType=\"graduateMajor\"\r\n              :choiceIndex=\"formData.targetMajorIndex\"\r\n              :choiceList=\"targetMajorOptions\"\r\n              :parentValue=\"formData.targetSchool\"\r\n              :isLinkage=\"true\"\r\n              :defaultText=\"formData.targetSchool ? '请选择专业' : '请先选择学校'\"\r\n              mode=\"search\"\r\n              :searchPlaceholder=\"!formData.targetSchool ? '请先选择学校' : (userRole === '学生' ? '请选择目标专业' : '请选择专业')\"\r\n              @onChoiceClick=\"handleTargetMajorSelect\"\r\n              @search-input=\"handleTargetMajorSearch\"\r\n              @reset-selection=\"resetMajorSelection\"\r\n              :enablePagination=\"true\"\r\n              :pageSize=\"10\"\r\n              ref=\"targetMajorDropdown\"\r\n            />\r\n          </view>\r\n      </template>\r\n      <!-- 按钮区域 -->\r\n      <view class=\"button-container\">\r\n        <button class=\"skip-btn\" @click=\"skipForm\">\r\n          <image src=\"../static/login/skip.png\" class=\"skip-btn-icon\"/>\r\n          <text class=\"btn-text\">跳过</text>\r\n        </button>\r\n        <button class=\"submit-btn\" @click=\"submitForm\">\r\n          <image src=\"../static/login/submit.png\" class=\"submit-btn-icon\"/>\r\n          <text class=\"btn-text\">提交</text>\r\n        </button>\r\n      </view>\r\n    </view>\r\n\r\n    \r\n    <!-- 老师角色协议确认浮窗 -->\r\n    <view class=\"modal-overlay\" v-if=\"showAgreementModal\" @click.stop=\"closeModal\">\r\n      <view class=\"modal-content\" @click.stop>\r\n        <view class=\"modal-title\">入驻协议</view>\r\n        <view class=\"modal-body\">\r\n          <view class=\"agreement-text\">\r\n            <view class=\"agreement-item\">就平台入驻涉及的权利和义务与您做出如下约定：</view>\r\n            <view class=\"agreement-item\">1、您知晓并同意，登署本协议即代表您依照本协议公布的规则履行义务并享有权利。</view>\r\n            <view class=\"agreement-item\">2、您同意，申请入驻平台认证老师后按照平台要求提供服务，包括并不限于向平台用户提供线上线下考研咨询及资料服务。</view>\r\n            <view class=\"agreement-item\">3、您同意，入驻平台认证学长通过后，进行线上服务时就服务标准内容进行回复，不得向用户索要用户私人联系方式包括(微信、手机号等)，平台会对站内聊天内容进行监控，若发现违规内容，平台有权进行处理，处理方式包括并不限于限制消息发送、删除消息等，若违规行为次数超过2次，平台有权对您的认证状态进行撤销。</view>\r\n          </view>\r\n        </view>\r\n        <view class=\"modal-footer\">\r\n          <button class=\"agree-btn\" @click=\"confirmAgreement\">我已悉知并同意</button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script lang=\"uts\">\r\nimport ChoiceSelected from '/pages_AI_Login_Match/components/combobox/combobox'\r\nimport { mapState, mapActions, mapGetters, mapMutations } from 'vuex'\r\nimport { Navigator } from '@/router/Router';\r\nimport Header from '@/components/navigationTitleBar/header';\r\nimport { submitUserInfo } from './login_detail.js';\r\n\r\nexport default {\r\n  onPageScroll() {\r\n    // 通知所有组件页面已滚动\r\n    uni.$emit('page-scroll');\r\n  },\r\n  components: {\r\n    ChoiceSelected,\r\n    Header\r\n  },\r\n  onLoad() {\r\n    // 加载用户信息\r\n    this.initUserInfo();\r\n  },\r\n  onUnload() {\r\n    // 页面卸载时清理防抖定时器\r\n    Object.values(this.searchTimers).forEach(timer => {\r\n      if (timer) clearTimeout(timer);\r\n    });\r\n  },\r\n  data() {\r\n    return {\r\n      formData: {\r\n        nickname: '', // 用户昵称\r\n        avatar: '/static/image/defaultAvatar/teacher-man.png', // 默认头像\r\n        schoolIndex: -1,\r\n        majorIndex: -1,\r\n        targetSchoolIndex: -1,  // 目标学校索引\r\n        targetMajorIndex: -1,   // 目标专业索引\r\n        gradeIndex: -1,\r\n        targetSchool: '',\r\n        targetMajor: '', // 目标专业值\r\n      },\r\n      \r\n      allGradeList: ['大一', '大二', '大三', '大四', '研一', '研二', '研三'],\r\n      showAgreementModal: false, // 控制协议浮窗显示\r\n      pendingUserInfo: null, // 暂存待提交的用户信息\r\n      \r\n      // 搜索防抖定时器\r\n      searchTimers: {\r\n        school: null,\r\n        major: null,\r\n        targetSchool: null,\r\n        targetMajor: null\r\n      },\r\n      \r\n      token: '', // 用户token\r\n      userId: '', // 用户ID\r\n    };\r\n  },\r\n  computed: {\r\n    // 使用mapState映射userInfo相关状态\r\n    ...mapState('user/baseInfo', {\r\n      userRole: state => state.userInfo.role,\r\n      userSchoolId: state => state.userInfo.schoolId,\r\n      userMajorId: state => state.userInfo.majorId,\r\n      userTargetSchoolId: state => state.userInfo.targetSchoolId,\r\n      userTargetMajorId: state => state.userInfo.targetMajorId,\r\n      userStudentGrade: state => state.userInfo.studentGrade,\r\n      userTeacherGrade: state => state.userInfo.teacherGrade\r\n    }),\r\n    \r\n    /**\r\n     * 根据用户角色筛选年级列表\r\n     * @returns {Array} 筛选后的年级列表\r\n     */\r\n    gradeList() {\r\n      if (this.userRole === '老师') {\r\n        return this.allGradeList.filter(grade => grade.includes('研'));\r\n      } else {\r\n        return this.allGradeList.filter(grade => grade.includes('大'));\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * 本科学校选项列表 - 使用 schoolMajorRequest 模块\r\n     * @returns {Array} 学校名称列表\r\n     */\r\n    schoolOptions() {\r\n      return this.$store.getters['user/schoolMajorRequest/undergraduateSchoolOptions'].map(item => item.name);\r\n    },\r\n    \r\n    /**\r\n     * 本科专业选项列表 - 使用 schoolMajorRequest 模块\r\n     * @returns {Array} 专业名称列表\r\n     */\r\n    majorOptions() {\r\n      return this.$store.getters['user/schoolMajorRequest/undergraduateMajorOptions'].map(item => item.name);\r\n    },\r\n    \r\n    /**\r\n     * 研究生学校选项列表 - 使用 schoolMajorRequest 模块\r\n     * @returns {Array} 学校名称列表\r\n     */\r\n    targetSchoolOptions() {\r\n      return this.$store.getters['user/schoolMajorRequest/graduateSchoolOptions'].map(item => item.name);\r\n    },\r\n    \r\n    /**\r\n     * 研究生专业选项列表 - 使用 schoolMajorRequest 模块\r\n     * @returns {Array} 专业名称列表\r\n     */\r\n    targetMajorOptions() {\r\n      return this.$store.getters['user/schoolMajorRequest/graduateMajorOptions'].map(item => item.name);\r\n    },\r\n    \r\n    /**\r\n     * 本科学校搜索状态 - 使用 schoolMajorRequest 模块\r\n     * @returns {Object} 搜索状态信息\r\n     */\r\n    undergraduateSchoolSearchData() {\r\n      return this.$store.getters['user/schoolMajorRequest/undergraduateSchoolSearchStatus'];\r\n    },\r\n    \r\n    /**\r\n     * 本科专业搜索状态 - 使用 schoolMajorRequest 模块\r\n     * @returns {Object} 搜索状态信息\r\n     */\r\n    undergraduateMajorSearchData() {\r\n      return this.$store.getters['user/schoolMajorRequest/undergraduateMajorSearchStatus'];\r\n    },\r\n    \r\n    /**\r\n     * 研究生学校搜索状态 - 使用 schoolMajorRequest 模块\r\n     * @returns {Object} 搜索状态信息\r\n     */\r\n    graduateSchoolSearchData() {\r\n      return this.$store.getters['user/schoolMajorRequest/graduateSchoolSearchStatus'];\r\n    },\r\n    \r\n    /**\r\n     * 研究生专业搜索状态 - 使用 schoolMajorRequest 模块\r\n     * @returns {Object} 搜索状态信息\r\n     */\r\n    graduateMajorSearchData() {\r\n      return this.$store.getters['user/schoolMajorRequest/graduateMajorSearchStatus'];\r\n    }\r\n  },\r\n  watch: {\r\n    // 监听学校选项变化，更新索引\r\n    schoolOptions: {\r\n      handler(newOptions) {\r\n        this.updateSchoolIndex(newOptions);\r\n      },\r\n      immediate: true\r\n    },\r\n    \r\n    // 监听专业选项变化，更新索引\r\n    majorOptions: {\r\n      handler(newOptions) {\r\n        this.updateMajorIndex(newOptions);\r\n      },\r\n      immediate: true\r\n    },\r\n    \r\n    // 监听目标学校选项变化，更新索引\r\n    targetSchoolOptions: {\r\n      handler(newOptions) {\r\n        this.updateTargetSchoolIndex(newOptions);\r\n      },\r\n      immediate: true\r\n    },\r\n    \r\n    // 监听目标专业选项变化，更新索引\r\n    targetMajorOptions: {\r\n      handler(newOptions) {\r\n        this.updateTargetMajorIndex(newOptions);\r\n      },\r\n      immediate: true\r\n    }\r\n  },\r\n  methods: {\r\n    // 使用mapMutations映射UPDATE_USER_INFO方法\r\n    ...mapMutations('user/baseInfo', ['UPDATE_USER_INFO', 'SET_USER_INFO']),\r\n    \r\n    handleBack() {\r\n      Navigator.toLogin();\r\n    },\r\n    \r\n    /**\r\n     * @description 初始化用户信息\r\n     */\r\n    initUserInfo() {\r\n      // 获取token和userId\r\n      this.token = uni.getStorageSync('token') || '';\r\n      this.userId = uni.getStorageSync('userId') || '';\r\n      \r\n      if (!this.token) {\r\n        // 如果没有token，可能需要重新登录\r\n        uni.showToast({\r\n          title: '请先登录',\r\n          icon: 'none'\r\n        });\r\n        return;\r\n      }\r\n      \r\n      // 如果有已存储的用户信息，显示它们\r\n      const storedNickname = uni.getStorageSync('nickname') || '';\r\n      const storedAvatar = uni.getStorageSync('avatar') || '';\r\n      \r\n      if (storedNickname) {\r\n        this.formData.nickname = storedNickname;\r\n      }\r\n      \r\n      if (storedAvatar) {\r\n        this.formData.avatar = storedAvatar;\r\n      }\r\n      \r\n      // // 如果需要，可以尝试从后端获取最新的用户信息\r\n      // this.fetchUserProfile();\r\n    },\r\n    \r\n    // /**\r\n    //  * @description 从后端获取用户信息\r\n    //  */\r\n    // fetchUserProfile() {\r\n    //   if (!this.token || !this.userId) return;\r\n      \r\n    //   uni.request({\r\n    //     url: `http://localhost:8080/users/profile/${this.userId}`,\r\n    //     method: 'GET',\r\n    //     header: {\r\n    //       'Authorization': `Bearer ${this.token}`\r\n    //     },\r\n    //     success: (res) => {\r\n    //       if (res.statusCode === 200 && res.data) {\r\n    //         const userData = res.data;\r\n            \r\n    //         // 更新表单数据\r\n    //         if (userData.nickname) {\r\n    //           this.formData.nickname = userData.nickname;\r\n    //           uni.setStorageSync('nickname', userData.nickname);\r\n    //         }\r\n            \r\n    //         if (userData.avatar) {\r\n    //           this.formData.avatar = userData.avatar;\r\n    //           uni.setStorageSync('avatar', userData.avatar);\r\n    //         }\r\n            \r\n    //         // 更新Vuex状态\r\n    //         this.SET_USER_INFO({\r\n    //           id: userData.id || this.userId,\r\n    //           name: userData.nickname || this.formData.nickname,\r\n    //           avatar: userData.avatar || this.formData.avatar,\r\n    //           isRegistered: 1\r\n    //         });\r\n            \r\n    //         uni.__f__('log','at pages_AI_Login_Match/login/login_detail.vue:426','用户信息已更新');\r\n    //       }\r\n    //     },\r\n    //     fail: (err) => {\r\n    //       uni.__f__('error','at pages_AI_Login_Match/login/login_detail.vue:430','获取用户信息失败', err);\r\n    //     }\r\n    //   });\r\n    // },\r\n    \r\n    /**\r\n     * @description 更新本科学校索引\r\n     * @param {Array} schoolOptions - 学校选项列表\r\n     */\r\n    updateSchoolIndex(schoolOptions) {\r\n      const selectedSchool = this.$store.getters['user/schoolMajorRequest/selectedUndergraduateSchool'];\r\n      if (selectedSchool.name && schoolOptions.length > 0) {\r\n        const schoolIndex = schoolOptions.indexOf(selectedSchool.name);\r\n        this.formData.schoolIndex = schoolIndex !== -1 ? schoolIndex : -1;\r\n      } else {\r\n        this.formData.schoolIndex = -1;\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 更新本科专业索引\r\n     * @param {Array} majorOptions - 专业选项列表\r\n     */\r\n    updateMajorIndex(majorOptions) {\r\n      const selectedMajor = this.$store.getters['user/schoolMajorRequest/selectedUndergraduateMajor'];\r\n      if (selectedMajor.name && majorOptions.length > 0) {\r\n        const majorIndex = majorOptions.indexOf(selectedMajor.name);\r\n        this.formData.majorIndex = majorIndex !== -1 ? majorIndex : -1;\r\n      } else {\r\n        this.formData.majorIndex = -1;\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 更新目标学校索引\r\n     * @param {Array} targetSchoolOptions - 目标学校选项列表\r\n     */\r\n    updateTargetSchoolIndex(targetSchoolOptions) {\r\n      const selectedSchool = this.$store.getters['user/schoolMajorRequest/selectedGraduateSchool'];\r\n      if (selectedSchool.name && targetSchoolOptions.length > 0) {\r\n        const schoolIndex = targetSchoolOptions.indexOf(selectedSchool.name);\r\n        this.formData.targetSchoolIndex = schoolIndex !== -1 ? schoolIndex : -1;\r\n        this.formData.targetSchool = selectedSchool.name;\r\n      } else {\r\n        this.formData.targetSchoolIndex = -1;\r\n        this.formData.targetSchool = '';\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 更新目标专业索引\r\n     * @param {Array} targetMajorOptions - 目标专业选项列表\r\n     */\r\n    updateTargetMajorIndex(targetMajorOptions) {\r\n      const selectedMajor = this.$store.getters['user/schoolMajorRequest/selectedGraduateMajor'];\r\n      if (selectedMajor.name && targetMajorOptions.length > 0) {\r\n        const majorIndex = targetMajorOptions.indexOf(selectedMajor.name);\r\n        this.formData.targetMajorIndex = majorIndex !== -1 ? majorIndex : -1;\r\n        this.formData.targetMajor = selectedMajor.name;\r\n      } else {\r\n        this.formData.targetMajorIndex = -1;\r\n        this.formData.targetMajor = '';\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 处理本科学校选择\r\n     * @param {Number} index - 选择的索引\r\n     * @param {String} school - 选择的学校名称\r\n     */\r\n    handleSchoolSelect(index, school) {\r\n      this.formData.schoolIndex = index;\r\n      \r\n      // 通过新的 schoolMajorRequest 模块更新选择\r\n      const schoolOptions = this.$store.getters['user/schoolMajorRequest/undergraduateSchoolOptions'];\r\n      const schoolOption = schoolOptions.find(item => item.name === school);\r\n      if (schoolOption) {\r\n        this.$store.dispatch('user/schoolMajorRequest/selectUndergraduateSchool', {\r\n          id: schoolOption.id,\r\n          name: schoolOption.name\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 处理本科专业选择\r\n     * @param {Number} index - 选择的索引\r\n     * @param {String} major - 选择的专业名称\r\n     */\r\n    handleMajorSelect(index, major) {\r\n      this.formData.majorIndex = index;\r\n      \r\n      // 通过新的 schoolMajorRequest 模块更新选择\r\n      const majorOptions = this.$store.getters['user/schoolMajorRequest/undergraduateMajorOptions'];\r\n      const majorOption = majorOptions.find(item => item.name === major);\r\n      if (majorOption) {\r\n        this.$store.dispatch('user/schoolMajorRequest/selectUndergraduateMajor', {\r\n          id: majorOption.id,\r\n          name: majorOption.name\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 处理目标学校选择\r\n     * @param {Number} index - 选择的索引\r\n     * @param {String} school - 选择的学校名称\r\n     */\r\n    handleTargetSchoolSelect(index, school) {\r\n      this.formData.targetSchoolIndex = index;\r\n      this.formData.targetSchool = school;\r\n      \r\n      // 通过新的 schoolMajorRequest 模块更新选择\r\n      const schoolOptions = this.$store.getters['user/schoolMajorRequest/graduateSchoolOptions'];\r\n      const schoolOption = schoolOptions.find(item => item.name === school);\r\n      if (schoolOption) {\r\n        this.$store.dispatch('user/schoolMajorRequest/selectGraduateSchool', {\r\n          id: schoolOption.id,\r\n          name: schoolOption.name\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 处理目标专业选择\r\n     * @param {Number} index - 选择的索引\r\n     * @param {String} major - 选择的专业名称\r\n     */\r\n    handleTargetMajorSelect(index, major) {\r\n      this.formData.targetMajorIndex = index;\r\n      this.formData.targetMajor = major;\r\n      \r\n      // 通过新的 schoolMajorRequest 模块更新选择\r\n      const majorOptions = this.$store.getters['user/schoolMajorRequest/graduateMajorOptions'];\r\n      const majorOption = majorOptions.find(item => item.name === major);\r\n      if (majorOption) {\r\n        this.$store.dispatch('user/schoolMajorRequest/selectGraduateMajor', {\r\n          id: majorOption.id,\r\n          name: majorOption.name\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 处理年级选择\r\n     * @param {Number} index - 选择的索引\r\n     * @param {String} grade - 选择的年级\r\n     */\r\n    handleGradeSelect(index, grade) {\r\n      this.formData.gradeIndex = index;\r\n    },\r\n    \r\n    /**\r\n     * @description 处理本科学校搜索输入（带防抖）\r\n     * @param {String} keyword - 搜索关键词\r\n     */\r\n    handleSchoolSearch(keyword) {\r\n      // 清除之前的定时器\r\n      if (this.searchTimers.school) {\r\n        clearTimeout(this.searchTimers.school);\r\n      }\r\n      \r\n      // 设置防抖延迟500ms\r\n      this.searchTimers.school = setTimeout(() => {\r\n        this.performSchoolSearch(keyword);\r\n      }, 500);\r\n    },\r\n    \r\n    /**\r\n     * @description 执行本科学校搜索\r\n     * @param {String} keyword - 搜索关键词\r\n     */\r\n    async performSchoolSearch(keyword) {\r\n      try {\r\n        await this.$store.dispatch('user/schoolMajorRequest/searchUndergraduateSchools', {\r\n          keyword: keyword\r\n        });\r\n      } catch (error) {\r\n        uni.__f__('error','at pages_AI_Login_Match/login/login_detail.vue:608','学校搜索失败:', error);\r\n        uni.showToast({\r\n          title: '学校搜索失败',\r\n          icon: 'none'\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 处理本科专业搜索输入（带防抖）\r\n     * @param {String} keyword - 搜索关键词\r\n     */\r\n    handleMajorSearch(keyword) {\r\n      // 清除之前的定时器\r\n      if (this.searchTimers.major) {\r\n        clearTimeout(this.searchTimers.major);\r\n      }\r\n      \r\n      // 设置防抖延迟500ms\r\n      this.searchTimers.major = setTimeout(() => {\r\n        this.performMajorSearch(keyword);\r\n      }, 500);\r\n    },\r\n    \r\n    /**\r\n     * @description 执行本科专业搜索\r\n     * @param {String} keyword - 搜索关键词\r\n     */\r\n    async performMajorSearch(keyword) {\r\n      try {\r\n        await this.$store.dispatch('user/schoolMajorRequest/searchUndergraduateMajors', {\r\n          keyword: keyword\r\n        });\r\n      } catch (error) {\r\n        uni.__f__('error','at pages_AI_Login_Match/login/login_detail.vue:642','专业搜索失败:', error);\r\n        uni.showToast({\r\n          title: '专业搜索失败',\r\n          icon: 'none'\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 处理目标学校搜索输入（带防抖）\r\n     * @param {String} keyword - 搜索关键词\r\n     */\r\n    handleTargetSchoolSearch(keyword) {\r\n      // 清除之前的定时器\r\n      if (this.searchTimers.targetSchool) {\r\n        clearTimeout(this.searchTimers.targetSchool);\r\n      }\r\n      \r\n      // 设置防抖延迟500ms\r\n      this.searchTimers.targetSchool = setTimeout(() => {\r\n        this.performTargetSchoolSearch(keyword);\r\n      }, 500);\r\n    },\r\n    \r\n    /**\r\n     * @description 执行目标学校搜索\r\n     * @param {String} keyword - 搜索关键词\r\n     */\r\n    async performTargetSchoolSearch(keyword) {\r\n      try {\r\n        await this.$store.dispatch('user/schoolMajorRequest/searchGraduateSchools', {\r\n          keyword: keyword\r\n        });\r\n      } catch (error) {\r\n        uni.__f__('error','at pages_AI_Login_Match/login/login_detail.vue:676','目标学校搜索失败:', error);\r\n        uni.showToast({\r\n          title: '目标学校搜索失败',\r\n          icon: 'none'\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 处理目标专业搜索输入（带防抖）\r\n     * @param {String} keyword - 搜索关键词\r\n     */\r\n    handleTargetMajorSearch(keyword) {\r\n      // 清除之前的定时器\r\n      if (this.searchTimers.targetMajor) {\r\n        clearTimeout(this.searchTimers.targetMajor);\r\n      }\r\n      \r\n      // 设置防抖延迟500ms\r\n      this.searchTimers.targetMajor = setTimeout(() => {\r\n        this.performTargetMajorSearch(keyword);\r\n      }, 500);\r\n    },\r\n    \r\n    /**\r\n     * @description 执行目标专业搜索\r\n     * @param {String} keyword - 搜索关键词\r\n     */\r\n    async performTargetMajorSearch(keyword) {\r\n      try {\r\n        await this.$store.dispatch('user/schoolMajorRequest/searchGraduateMajors', {\r\n          keyword: keyword\r\n        });\r\n      } catch (error) {\r\n        uni.__f__('error','at pages_AI_Login_Match/login/login_detail.vue:710','目标专业搜索失败:', error);\r\n        uni.showToast({\r\n          title: '目标专业搜索失败',\r\n          icon: 'none'\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 处理学校变化（联动效果）\r\n     * @param {String} school - 新选择的学校\r\n     */\r\n    handleSchoolChange(school) {\r\n      // 清空专业选择\r\n      this.formData.targetMajorIndex = -1;\r\n      this.formData.targetMajor = '';\r\n      \r\n      // 通过新的 schoolMajorRequest 模块清空专业列表\r\n      this.$store.commit('user/schoolMajorRequest/CLEAR_GRADUATE_MAJOR_SELECTION');\r\n    },\r\n    \r\n    /**\r\n     * @description 重置专业选择\r\n     */\r\n    resetMajorSelection() {\r\n      this.formData.targetMajorIndex = -1;\r\n      this.formData.targetMajor = '';\r\n    },\r\n    \r\n    /**\r\n     * @description 跳过表单填写\r\n     */\r\n    async skipForm() {\r\n      try {\r\n        uni.showLoading({\r\n          title: '跳过中...'\r\n        });\r\n        \r\n        // 调用API，传入跳过标识\r\n        const result = await submitUserInfo({\r\n          userRole: this.userRole,\r\n          userInfo: {},\r\n          isSkip: true\r\n        });\r\n        \r\n        uni.hideLoading();\r\n        \r\n        if (result.success) {\r\n          uni.showToast({\r\n            title: '跳过成功',\r\n            icon: 'success'\r\n          });\r\n          \r\n          // 延迟跳转到首页\r\n          setTimeout(() => {\r\n            Navigator.toIndex();\r\n          }, 1500);\r\n        } else {\r\n          uni.showToast({\r\n            title: result.message || '跳过失败',\r\n            icon: 'none'\r\n          });\r\n        }\r\n      } catch (error) {\r\n        uni.hideLoading();\r\n        uni.__f__('error','at pages_AI_Login_Match/login/login_detail.vue:775','跳过失败:', error);\r\n        uni.showToast({\r\n          title: '跳过失败',\r\n          icon: 'none'\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 提交表单\r\n     */\r\n    submitForm() {\r\n      // 从新的 schoolMajorRequest 模块获取选项数据\r\n      const undergraduateSchoolOptions = this.$store.getters['user/schoolMajorRequest/undergraduateSchoolOptions'];\r\n      const undergraduateMajorOptions = this.$store.getters['user/schoolMajorRequest/undergraduateMajorOptions'];\r\n      const graduateSchoolOptions = this.$store.getters['user/schoolMajorRequest/graduateSchoolOptions'];\r\n      const graduateMajorOptions = this.$store.getters['user/schoolMajorRequest/graduateMajorOptions'];\r\n      \r\n      // 检查必填字段（虽然是可选填写，但老师角色需要确认协议）\r\n      const selectedSchoolOption = undergraduateSchoolOptions[this.formData.schoolIndex];\r\n      const selectedMajorOption = undergraduateMajorOptions[this.formData.majorIndex];\r\n      const selectedTargetSchoolOption = graduateSchoolOptions[this.formData.targetSchoolIndex];\r\n      const selectedTargetMajorOption = graduateMajorOptions[this.formData.targetMajorIndex];\r\n      const selectedGrade = this.gradeList[this.formData.gradeIndex];\r\n      \r\n      // 构造用户信息\r\n      const userInfo = {\r\n        nickname: this.formData.nickname || '',\r\n        avatar: this.formData.avatar || '',\r\n        schoolId: selectedSchoolOption ? selectedSchoolOption.id : null,\r\n        majorId: selectedMajorOption ? selectedMajorOption.id : null,\r\n        targetSchoolId: selectedTargetSchoolOption ? selectedTargetSchoolOption.id : null,\r\n        targetMajorId: selectedTargetMajorOption ? selectedTargetMajorOption.id : null,\r\n        grade: selectedGrade || ''\r\n      };\r\n      \r\n      // 如果是老师角色，需要确认协议\r\n      if (this.userRole === '老师') {\r\n        this.pendingUserInfo = userInfo;\r\n        this.showAgreementModal = true;\r\n      } else {\r\n        // 学生角色直接提交\r\n        this.doSubmit(userInfo);\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 执行提交操作\r\n     * @param {Object} userInfo - 用户信息\r\n     */\r\n    async doSubmit(userInfo) {\r\n      try {\r\n        uni.showLoading({\r\n          title: '提交中...'\r\n        });\r\n        \r\n        // 构造年级类型映射\r\n        const gradeTypeMap = {\r\n          '大一': 1,\r\n          '大二': 2,\r\n          '大三': 3,\r\n          '大四': 4,\r\n          '研一': 5,\r\n          '研二': 6,\r\n          '研三': 7\r\n        };\r\n        \r\n        // 添加年级类型到用户信息\r\n        const processedUserInfo = {\r\n          ...userInfo,\r\n          gradeType: userInfo.grade ? gradeTypeMap[userInfo.grade] : null\r\n        };\r\n        \r\n        // 调用API提交数据\r\n        const result = await submitUserInfo({\r\n          userRole: this.userRole,\r\n          userInfo: processedUserInfo,\r\n          isSkip: false\r\n        });\r\n        \r\n        uni.hideLoading();\r\n        \r\n        if (result.success) {\r\n          // 更新Vuex状态\r\n          this.UPDATE_USER_INFO(userInfo);\r\n          \r\n          uni.showToast({\r\n            title: result.message || '提交成功',\r\n            icon: 'success'\r\n          });\r\n          \r\n          // 延迟跳转到首页\r\n          setTimeout(() => {\r\n            Navigator.toIndex();\r\n          }, 1500);\r\n        } else {\r\n          uni.showToast({\r\n            title: result.message || '提交失败',\r\n            icon: 'none'\r\n          });\r\n        }\r\n      } catch (error) {\r\n        uni.hideLoading();\r\n        uni.__f__('error','at pages_AI_Login_Match/login/login_detail.vue:878','提交失败:', error);\r\n        uni.showToast({\r\n          title: '提交失败',\r\n          icon: 'none'\r\n        });\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 确认协议\r\n     */\r\n    confirmAgreement() {\r\n      this.showAgreementModal = false;\r\n      \r\n      if (this.pendingUserInfo) {\r\n        this.doSubmit(this.pendingUserInfo);\r\n        this.pendingUserInfo = null;\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * @description 关闭协议弹窗\r\n     */\r\n    closeModal() {\r\n      this.showAgreementModal = false;\r\n      this.pendingUserInfo = null;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.header-container {\r\n\t/**\r\n\t * @description 固定顶部导航栏，背景不透明，确保在最上层\r\n\t */\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\tbackground-color: #fff;\r\n\tz-index: 100;\r\n}\r\n.background-image {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100vh;\r\n  z-index: 0;\r\n  pointer-events: none;\r\n}\r\n.background-image image {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n.reminder-outer {\r\n  width: 100%;\r\n  border-radius: 10rpx;\r\n  padding: 2rpx 2rpx;\r\n  box-sizing: border-box;\r\n  background: linear-gradient(180deg, rgba(228, 241, 255, 1) 0%, rgba(34, 136, 249, 1) 100%);\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.reminder-inner {\r\n  width: 100%;\r\n  border-radius: 10rpx;\r\n  background: #fff;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: row;\r\n  position: relative;\r\n  padding: 20rpx 30rpx;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.reminder-inner::after {\r\n  content: '';\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: linear-gradient(180deg, rgba(194, 221, 250, 0.1) 11.54%, rgba(34, 136, 249, 0.1) 111.54%);\r\n}\r\n\r\n.reminder-text {\r\n  color: rgba(0, 0, 0, 0.5);\r\n  z-index: 1;\r\n  position: relative;\r\n  font-family: PingFang SC;\r\n  font-weight: 400;\r\n  font-size: 24rpx;\r\n  line-height: 100%;\r\n  letter-spacing: -1.1rpx;\r\n}\r\n\r\n.form-card {\r\n  background-color: transparent;\r\n  border-radius: 20rpx;\r\n  padding: 30rpx;\r\n}\r\n\r\n.label-container {\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  margin-bottom: 15rpx;\r\n}\r\n\r\n.form-row {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.form-label {\r\n  display: block;\r\n  font-size: 30rpx;\r\n  font-weight: bold;\r\n  color: rgba(0, 0, 0, 1);\r\n  font-family: PingFang SC;\r\n  font-weight: 400;\r\n  line-height: 100%;\r\n  letter-spacing: -1.1rpx;\r\n\r\n}\r\n\r\n.optional-tag {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n  margin-left: 10rpx;\r\n}\r\n\r\n.required-tag {\r\n  font-size: 24rpx;\r\n  color: #ff4d4f;\r\n  margin-left: 10rpx;\r\n}\r\n\r\n.form-input {\r\n  width: 100%;\r\n  height: 80rpx;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 8rpx;\r\n  padding: 0 20rpx;\r\n  font-size: 28rpx;\r\n  box-sizing: border-box;\r\n}\r\n\r\n\r\n\r\n.radio-item-row {\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n}\r\n\r\n.radio-option {\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  margin-right: 30px;\r\n  margin-left: 30px;\r\n}\r\n\r\n.option-text {\r\n  margin-left: 8px;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n}\r\n\r\n.form-select {\r\n  width: 100%;\r\n  border: 2rpx solid rgba(151, 151, 151, 1);\r\n  border-radius: 8rpx;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.button-container {\r\n  margin-top: 50rpx;\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.skip-btn{\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 200rpx;\r\n  height: 76rpx;\r\n  border-radius: 10px;\r\n  background: linear-gradient(180deg, #B2D7FF 0%, #2288F9 100%);\r\n}\r\n.skip-btn-icon{\r\n  width: 36rpx;\r\n  height: 36rpx;\r\n}\r\n\r\n.submit-btn-icon{\r\n  width: 36rpx;\r\n  height: 36rpx;\r\n}\r\n.submit-btn {\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 200rpx;\r\n  height: 76rpx;\r\n  border-radius: 10px;\r\n  background: linear-gradient(180deg, #A5A9F7 0%, rgba(70, 78, 248, 0.9) 100%);\r\n  margin-left: 80rpx;\r\n}\r\n.btn-text{\r\n  font-family: PingFang SC;\r\n  font-weight: 400;\r\n  font-size: 28rpx;\r\n  line-height: 100%;\r\n  letter-spacing: -1.1rpx;\r\n  text-align: center;\r\n  color:rgba(255, 255, 255, 1);\r\n  margin-left: 20rpx;\r\n}\r\n/* 头像上传相关样式 */\r\n.avatar-upload-container {\r\n  position: relative;\r\n  width: 140rpx;\r\n  height: 140rpx;\r\n  border-radius: 50%;\r\n  overflow: hidden;\r\n  margin: 10rpx 0;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.form-avatar {\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 50%;\r\n}\r\n\r\n.avatar-upload-mask {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 50rpx;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.upload-text {\r\n  color: #fff;\r\n  font-size: 22rpx;\r\n}\r\n\r\n/* 协议浮窗样式 */\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 999;\r\n}\r\n\r\n.modal-content {\r\n  width: 80%;\r\n  max-height: 70vh;\r\n  background-color: #fff;\r\n  border-radius: 20rpx;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.modal-title {\r\n  text-align: center;\r\n  font-size: 36rpx;\r\n  font-weight: bold;\r\n  padding: 30rpx 0;\r\n  color: #333;\r\n  border-bottom: 1px solid #f0f0f0;\r\n}\r\n\r\n.modal-body {\r\n  padding: 30rpx;\r\n  flex: 1;\r\n  overflow-y: auto;\r\n}\r\n\r\n.agreement-text {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  line-height: 1.6;\r\n}\r\n\r\n.agreement-item {\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.modal-footer {\r\n  padding: 20rpx 30rpx 40rpx;\r\n  border-top: 1px solid #f0f0f0;\r\n}\r\n\r\n.agree-btn {\r\n  width: 100%;\r\n  height: 80rpx;\r\n  line-height: 80rpx;\r\n  text-align: center;\r\n  background-color: #007AFF;\r\n  color: #fff;\r\n  font-size: 30rpx;\r\n  border-radius: 40rpx;\r\n  border: none;\r\n}\r\n</style>","import MiniProgramPage from 'E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/pages_AI_Login_Match/login/login_detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["getApiPrefix","useGlobalStore","submitUserInfo","userRole","userInfo","isSkip","apiPrefix","apiPath","submitData","response","apiRequest","error","uni","ChoiceSelected","Header","_sfc_main","defineComponent","timer","mapState","state","grade","item","newOptions","mapMutations","Navigator","storedNickname","storedAvatar","schoolOptions","selectedSchool","schoolIndex","majorOptions","selectedMajor","majorIndex","targetSchoolOptions","targetMajorOptions","index","school","schoolOption","major","majorOption","keyword","result","undergraduateSchoolOptions","undergraduateMajorOptions","graduateSchoolOptions","graduateMajorOptions","selectedSchoolOption","selectedMajorOption","selectedTargetSchoolOption","selectedTargetMajorOption","selectedGrade","gradeTypeMap","processedUserInfo","MiniProgramPage"],"mappings":"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"}