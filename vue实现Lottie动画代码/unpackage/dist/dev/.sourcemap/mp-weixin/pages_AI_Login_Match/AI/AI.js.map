{"version":3,"file":"AI.js","sources":["pages_AI_Login_Match/AI/AI.vue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNfQUlfTG9naW5fTWF0Y2hcQUlcQUkudnVl"],"sourcesContent":["<template>\n    <!-- 加载状态指示器 -->\n\t<view class=\"loading-container\" v-if=\"isLoading\">\n        <loading-animation\n          src=\"https://lottie.host/1f64310d-d1a9-44c9-ac77-3c29ae849559/c3yfKGAzCm.json\"\n          width=\"150rpx\" \n          height=\"150rpx\"\n          :showText=\"true\"\n          text=\"加载中...\"\n        ></loading-animation>\n      </view>\n\t<view class=\"page-container\" @click=\"onPageClick\">\n\t\t<!-- 导航栏和侧边栏 -->\n\t\t<view class=\"nav-sidebar-container\">\n\t\t\t<!-- 侧边栏遮罩层 -->\n\t\t\t<view class=\"sidebar-mask\" v-if=\"sidebarVisible\" @click.stop=\"closeSidebar\" :style=\"{opacity: sidebarVisible ? 0.5 : 0}\"></view>\n\t\t\t<Header :title=\"'AI助手'\" @back=\"handleBack\" />\n\t\t\t<!-- 历史记录侧边栏 -->\n\t\t\t\t<history-sidebar\n\t\t\t\t\t:visible=\"sidebarVisible\"\n\t\t\t\t\t:grouped-history=\"groupedHistorySummaries\"\n\t\t\t\t\t:current-chat-id=\"currentChatId\"\n\t\t\t\t\t@load-chat=\"loadChatHistory\"\n\t\t\t\t\t@delete-chat=\"deleteChatHistory\">\n\t\t\t\t</history-sidebar>\n\t\t\t<!-- 主内容区域 -->\n\t\t\t<view class=\"main-wrapper\">\n\t\t\t\t<!-- 顶部导航栏 -->\n\t\t\t\t<view class=\"nav-bar\">\n\t\t\t\t\t<view class=\"nav-left\">\n\t\t\t\t\t\t<view class=\"history-btn\" @click.stop=\"toggleSidebar\">\n\t\t\t\t\t\t\t<image src=\"../static/AIchat/chatHistory.png\" class=\"history-icon\" />\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"nav-title\">\n\t\t\t\t\t\t<mode-selector\n\t\t\t\t\t\t\t:current-mode=\"currentMode\"\n\t\t\t\t\t\t\t:inNav=\"true\"\n\t\t\t\t\t\t\t@mode-change=\"switchMode\">\n\t\t\t\t\t\t</mode-selector>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"nav-right\">\n\t\t\t\t\t\t<view class=\"new-chat-btn\" @click.stop=\"startNewChat\">\n\t\t\t\t\t\t\t<image src=\"../static/AIchat/newChat.png\" class=\"new-chat-icon\" />\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 主内容区域 -->\n\t\t\t\t<scroll-view scroll-y=\"true\" class=\"main-content\" @scroll=\"onScroll\">\n\t\t\t\t\t<!-- 筛选区域 -->\n\t\t\t\t\t<view class=\"filter-section\">\n\t\t\t\t\t\t<view class=\"filter-content\">\n\t\t\t\t\t\t\t<!-- 学校筛选 -->\n\t\t\t\t\t\t\t<view class=\"filter-item\">\n\t\t\t\t\t\t\t\t<view class=\"filter-item full-width\">\n\t\t\t\t\t\t\t\t<text class=\"filter-label\">所在学校：</text>\n\t\t\t\t\t\t\t\t\t<view class=\"choice-wrapper\">\n\t\t\t\t\t\t\t\t\t\t<ChoiceSelected\n\t\t\t\t\t\t\t\t\t\tclass=\"filter-select\"\n\t\t\t\t\t\t\t\t\t\tcomponentType=\"undergraduate\"\n\t\t\t\t\t\t\t\t\t\t:choiceIndex=\"schoolIndex\"\n\t\t\t\t\t\t\t\t\t\t:choiceList=\"schoolOptions\"\n\t\t\t\t\t\t\t\t\t\tdefaultText=\"请选择学校\"\n\t\t\t\t\t\t\t\t\t\tmode=\"search\"\n\t\t\t\t\t\t\t\t\t\tsearchPlaceholder=\"输入学校名称\"\n\t\t\t\t\t\t\t\t\t\t@onChoiceClick=\"handleSchoolSelect\"\n\t\t\t\t\t\t\t\t\t\t@search-input=\"handleSchoolSearch\"\n\t\t\t\t\t\t\t\t\t\tref=\"schoolDropdown\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<!-- 专业筛选 -->\n\t\t\t\t\t\t\t<view class=\"filter-item\">\n\t\t\t\t\t\t\t\t<view class=\"filter-item full-width\">\n\t\t\t\t\t\t\t\t<text class=\"filter-label\">专业：</text>\n\t\t\t\t\t\t\t\t\t<view class=\"choice-wrapper\">\n\t\t\t\t\t\t\t\t\t\t<ChoiceSelected\n\t\t\t\t\t\t\t\t\t\tclass=\"filter-select\"\n\t\t\t\t\t\t\t\t\t\tcomponentType=\"undergraduate\"\n\t\t\t\t\t\t\t\t\t\t:choiceIndex=\"majorIndex\"\n\t\t\t\t\t\t\t\t\t\t:choiceList=\"majorOptions\"\n\t\t\t\t\t\t\t\t\t\tdefaultText=\"请选择专业\"\n\t\t\t\t\t\t\t\t\t\tmode=\"search\"\n\t\t\t\t\t\t\t\t\t\tsearchPlaceholder=\"输入专业名称\"\n\t\t\t\t\t\t\t\t\t\t@onChoiceClick=\"handleMajorSelect\"\n\t\t\t\t\t\t\t\t\t\t@search-input=\"handleMajorSearch\"\n\t\t\t\t\t\t\t\t\t\tref=\"majorDropdown\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<!-- 消息区域 -->\n\t\t\t\t\t<message-list\n\t\t\t\t\t\t:messages=\"messages\"\n\t\t\t\t\t\t:auto-scroll-id=\"autoScrollId\"\n\t\t\t\t\t\t@retry-message=\"retryMessage\"\n\t\t\t\t\t\t@update-auto-scroll-id=\"autoScrollId = $event\"\n\t\t\t\t\t\tref=\"messageList\">\n\t\t\t\t\t</message-list>\n\t\t\t\t\t\n\t\t\t\t\t<!-- 输入区域 -->\n\t\t\t\t\t<input-section\n\t\t\t\t\t\t:is-processing=\"isProcessing\"\n\t\t\t\t\t\t@send=\"sendMessage\">\n\t\t\t\t\t</input-section>\n\t\t\t\t</scroll-view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\n\t</view>\n</template>\n\n<script lang=\"uts\">\n\timport HistorySidebar from './ai-chat/HistorySidebar'\n\timport MessageList from './ai-chat/MessageList'\n\timport ModeSelector from './ai-chat/ModeSelector'\n\timport InputSection from './ai-chat/InputSection'\n\timport ChoiceSelected from '/pages_AI_Login_Match/components/combobox/combobox'\n\timport store from '@/store'\n\timport { mapState } from 'vuex';\n\timport Header from '@/components/navigationTitleBar/header.vue';\n\timport { Navigator } from '@/router/Router.js'\n\timport LoadingAnimation from '@/components/loading/LoadingAnimation.vue';\n\n\t\n\t\n\t// 消息类型常量\n\tconst MESSAGE_TYPE = {\n\t\tUSER: 'user',\n\t\tAI: 'AI',\n\t\tSYSTEM: 'system'\n\t}\n\t\n\t// 消息状态常量\n\tconst MESSAGE_STATUS = {\n\t\tSENDING: 'sending',\n\t\tSENT: 'sent',\n\t\tERROR: 'error'\n\t}\n\t\n\t// 对话模式常量\n\tconst CHAT_MODE = {\n\t\tGENERAL: 'general',\n\t\tSCHOOL: 'school',\n\t\tCAREER: 'career'\n\t}\n\t\n\texport default {\n\t\tonPageScroll() {\n\t\t\t// 通知所有组件页面已滚动\n\t\t\tuni.$emit('page-scroll');\n  \t\t},\n\t\tcomponents: {\n\t\t\tHistorySidebar,\n\t\t\tMessageList,\n\t\t\tModeSelector,\n\t\t\tInputSection,\n\t\t\tChoiceSelected,\n\t\t\tHeader,\n\t\t\tLoadingAnimation\n\t\t},\n\t\tcomputed: {\n\t\t\t// 从Vuex获取状态\n\t\t\t...mapState('user/aiChat', {\n\t\t\t\tstoreHistorySummaries: state => state.aiChat.historySummaries,\n\t\t\t\tstoreHistoryChats: state => state.aiChat.conversations,\n\t\t\t\tstoreActiveConversation: state => state.aiChat.activeConversation,\n\t\t\t\tstoreChatMode: state => state.aiChat.chatMode,\n\t\t\t\tstoreUserInfo: state => state.aiChat.userInfo,\n\t\t\t\tschoolSearchData: state => state.aiChat.schoolSearch,\n\t\t\t\tmajorSearchData: state => state.aiChat.majorSearch\n\t\t\t}),\n\t\t\t\n\t\t\t// 当前选择的学校和专业\n\t\t\tcurrentSchool() {\n\t\t\t\treturn this.schoolSearchData.selectedSchool || '';\n\t\t\t},\n\t\t\tcurrentMajor() {\n\t\t\t\treturn this.majorSearchData.selectedMajor || '';\n\t\t\t},\n\t\t\tcurrentSchoolId() {\n\t\t\t\treturn this.schoolSearchData.selectedSchoolId || null;\n\t\t\t},\n\t\t\tcurrentMajorId() {\n\t\t\t\treturn this.majorSearchData.selectedMajorId || null;\n\t\t\t},\n\t\t\t\n\t\t\t// 学校和专业选项列表\n\t\t\tschoolOptions() {\n\t\t\t\treturn this.schoolSearchData.options.map(item => item.name);\n\t\t\t},\n\t\t\tmajorOptions() {\n\t\t\t\treturn this.majorSearchData.options.map(item => item.name);\n\t\t\t},\n\t\t\t\n\t\t\t// 当前模式名称\n\t\t\tcurrentModeName() {\n\t\t\t\tconst modeNames = {\n\t\t\t\t\t[CHAT_MODE.GENERAL]: '通用',\n\t\t\t\t\t[CHAT_MODE.SCHOOL]: '择校',\n\t\t\t\t\t[CHAT_MODE.CAREER]: '职业规划'\n\t\t\t\t};\n\t\t\t\treturn modeNames[this.currentMode] || '通用';\n\t\t\t},\n\t\t\t\n\t\t\t// 兼容计算属性\n\t\t\thistorySummaries() {\n\t\t\t\treturn this.storeHistorySummaries;\n\t\t\t},\n\t\t\thistoryChats() {\n\t\t\t\treturn this.storeHistoryChats || [];\n\t\t\t},\n\t\t\tactiveConversation() {\n\t\t\t\treturn this.storeActiveConversation;\n\t\t\t},\n\t\t\tchatMode() {\n\t\t\t\treturn this.storeChatMode;\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 按时间分组历史记录\n\t\t\t * @returns {Object} { today: [], week: [], month: [] }\n\t\t\t */\n\t\t\tgroupedHistorySummaries() {\n\t\t\t\tconst now = new Date();\n\t\t\t\tconst today = [];\n\t\t\t\tconst week = [];\n\t\t\t\tconst month = [];\n\t\t\t\t\n\t\t\t\t(this.historySummaries || []).forEach(item => {\n\t\t\t\t\tconst timeStr = item.updatedAt || item.createdAt;\n\t\t\t\t\tif (!timeStr) return;\n\t\t\t\t\tconst time = new Date(timeStr);\n\n\t\t\t\t\t// 计算天数差\n\t\t\t\t\tconst diffTime = now.getTime() - time.getTime();\n\t\t\t\t\tconst diffDays = Math.floor(diffTime / (24 * 60 * 60 * 1000));\n\n\t\t\t\t\t// 判断分组\n\t\t\t\t\tif (\n\t\t\t\t\t\ttime.getFullYear() === now.getFullYear() &&\n\t\t\t\t\t\ttime.getMonth() === now.getMonth() &&\n\t\t\t\t\t\ttime.getDate() === now.getDate()\n\t\t\t\t\t) {\n\t\t\t\t\t\ttoday.push(item);\n\t\t\t\t\t} else if (diffDays < 7) {\n\t\t\t\t\t\tweek.push(item);\n\t\t\t\t\t} else if (diffDays < 30) {\n\t\t\t\t\t\tmonth.push(item);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn { today, week, month };\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\t// 消息相关\n\t\t\t\tmessages: [],\n\t\t\t\tisProcessing: false,\n\t\t\t\tisLoading: false,\n\t\t\t\tautoScrollId: '',\n\t\t\t\t\n\t\t\t\t// 对话模式\n\t\t\t\tcurrentMode: CHAT_MODE.GENERAL,\n\t\t\t\t\n\t\t\t\t// 学校和专业选择索引\n\t\t\t\tschoolIndex: -1,\n\t\t\t\tmajorIndex: -1,\n\t\t\t\t\n\t\t\t\t// 搜索防抖定时器\n\t\t\t\tsearchTimers: {\n\t\t\t\t\tschool: null,\n\t\t\t\t\tmajor: null\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\t// 滚动相关\n\t\t\t\tisAutoScrollEnabled: true,\n\t\t\t\t\n\t\t\t\t// 当前会话控制器\n\t\t\t\tcurrentController: null,\n\t\t\t\t\n\t\t\t\t// 上下文信息\n\t\t\t\tcontextInfo: {},\n\t\t\t\t\n\t\t\t\t// 导航栏和侧边栏\n\t\t\t\tsidebarVisible: false,\n\t\t\t\tcurrentChatId: null\n\t\t\t}\n\t\t},\n\t\twatch: {\n\t\t\t// 监听activeConversation的变化\n\t\t\tstoreActiveConversation: {\n\t\t\t\thandler(newVal) {\n\t\t\t\t\tif (newVal && typeof newVal === 'object' && newVal.chatId) {\n\t\t\t\t\t\tthis.currentChatId = newVal.chatId;\n\t\t\t\t\t\tif (newVal.chatMode) {\n\t\t\t\t\t\t\tthis.currentMode = newVal.chatMode;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (newVal) {\n\t\t\t\t\t\tthis.currentChatId = newVal;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\timmediate: true\n\t\t\t},\n\t\t\t\n\t\t\t// 监听用户信息变化\n\t\t\tstoreUserInfo: {\n\t\t\t\thandler(newVal) {\n\t\t\t\t\tif (newVal) {\n\t\t\t\t\t\tthis.setUserSelectionIndexes();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdeep: true,\n\t\t\t\timmediate: true\n\t\t\t},\n\t\t\t\n\t\t\t// 监听学校选项变化，更新索引\n\t\t\tschoolOptions: {\n\t\t\t\thandler(newOptions) {\n\t\t\t\t\tthis.updateSchoolIndex(newOptions);\n\t\t\t\t},\n\t\t\t\timmediate: true\n\t\t\t},\n\t\t\t\n\t\t\t// 监听专业选项变化，更新索引\n\t\t\tmajorOptions: {\n\t\t\t\thandler(newOptions) {\n\t\t\t\t\tthis.updateMajorIndex(newOptions);\n\t\t\t\t},\n\t\t\t\timmediate: true\n\t\t\t}\n\t\t},\n\t\tonLoad() {\n\t\t\t/**\n\t\t\t * @description 页面加载时的处理逻辑\n\t\t\t */\n\t\t\t// 获取用户信息并初始化\n\t\t\tthis.syncUserInfoFromVuex();\n\t\t\t\n\t\t\t// 加载历史会话\n\t\t\tthis.loadChatHistoryFromStorage();\n\t\t},\n\t\tonShow() {\n\t\t\t// 页面显示时刷新历史记录\n\t\t\tthis.loadChatHistoryFromStorage();\n\t\t\t\n\t\t\t// 刷新用户信息\n\t\t\tthis.syncUserInfoFromVuex();\n\t\t},\n\t\tonUnload() {\n\t\t\t// 页面卸载时中断请求\n\t\t\tthis.abortCurrentRequest();\n\t\t\t\n\t\t\t// 清理防抖定时器\n\t\t\tObject.values(this.searchTimers).forEach(timer => {\n\t\t\t\tif (timer) clearTimeout(timer);\n\t\t\t});\n\t\t},\n\t\tmethods: {\n\t\t\t/**\n\t\t\t * @description 处理页面点击事件，关闭下拉框\n\t\t\t */\n\t\t\tonPageClick() {\n\t\t\t\tthis.closeAllDropdowns();\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 关闭所有下拉框\n\t\t\t */\n\t\t\tcloseAllDropdowns() {\n\t\t\t\tconst dropdowns = ['schoolDropdown', 'majorDropdown'];\n\t\t\t\tdropdowns.forEach(dropdown => {\n\t\t\t\t\tif (this.$refs && this.$refs[dropdown]) {\n\t\t\t\t\t\tthis.$refs[dropdown].closeDropdown && this.$refs[dropdown].closeDropdown();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 从Vuex同步用户信息\n\t\t\t */\n\t\t\tsyncUserInfoFromVuex() {\n\t\t\t\t// 从Vuex获取用户信息\n\t\t\t\tif (this.storeUserInfo) {\n\t\t\t\t\t// 设置选中索引\n\t\t\t\t\tthis.setUserSelectionIndexes();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 根据用户信息设置学校和专业索引\n\t\t\t */\n\t\t\tsetUserSelectionIndexes() {\n\t\t\t\tif (!this.storeUserInfo) return;\n\t\t\t\t\n\t\t\t\t// 更新学校索引\n\t\t\t\tthis.updateSchoolIndex(this.schoolOptions);\n\t\t\t\t\n\t\t\t\t// 更新专业索引\n\t\t\t\tthis.updateMajorIndex(this.majorOptions);\n\t\t\t\t\n\t\t\t\tthis.updateContextInfo();\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 更新学校索引\n\t\t\t * @param {Array} schoolOptions - 学校选项列表\n\t\t\t */\n\t\t\tupdateSchoolIndex(schoolOptions) {\n\t\t\t\tif (this.currentSchool && schoolOptions.length > 0) {\n\t\t\t\t\tconst schoolIndex = schoolOptions.indexOf(this.currentSchool);\n\t\t\t\t\tthis.schoolIndex = schoolIndex !== -1 ? schoolIndex : -1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.schoolIndex = -1;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 更新专业索引\n\t\t\t * @param {Array} majorOptions - 专业选项列表\n\t\t\t */\n\t\t\tupdateMajorIndex(majorOptions) {\n\t\t\t\tif (this.currentMajor && majorOptions.length > 0) {\n\t\t\t\t\tconst majorIndex = majorOptions.indexOf(this.currentMajor);\n\t\t\t\t\tthis.majorIndex = majorIndex !== -1 ? majorIndex : -1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.majorIndex = -1;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 处理学校选择\n\t\t\t * @param {Number} index - 选择的索引\n\t\t\t * @param {String} school - 选择的学校名称\n\t\t\t */\n\t\t\thandleSchoolSelect(index, school) {\n\t\t\t\tthis.schoolIndex = index;\n\t\t\t\t\n\t\t\t\t// 通过Vuex更新选择\n\t\t\t\tconst schoolOption = this.schoolSearchData.options.find(item => item.name === school);\n\t\t\t\tif (schoolOption) {\n\t\t\t\t\tthis.$store.dispatch('user/aiChat/selectAISchool', {\n\t\t\t\t\t\tid: schoolOption.id,\n\t\t\t\t\t\tname: schoolOption.name\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 更新上下文信息\n\t\t\t\tthis.updateContextInfo();\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 处理专业选择\n\t\t\t * @param {Number} index - 选择的索引\n\t\t\t * @param {String} major - 选择的专业名称\n\t\t\t */\n\t\t\thandleMajorSelect(index, major) {\n\t\t\t\tthis.majorIndex = index;\n\t\t\t\t\n\t\t\t\t// 通过Vuex更新选择\n\t\t\t\tconst majorOption = this.majorSearchData.options.find(item => item.name === major);\n\t\t\t\tif (majorOption) {\n\t\t\t\t\tthis.$store.dispatch('user/aiChat/selectAIMajor', {\n\t\t\t\t\t\tid: majorOption.id,\n\t\t\t\t\t\tname: majorOption.name\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 更新上下文信息\n\t\t\t\tthis.updateContextInfo();\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 处理学校搜索输入（带防抖）\n\t\t\t * @param {String} keyword - 搜索关键词\n\t\t\t */\n\t\t\thandleSchoolSearch(keyword) {\n\t\t\t\t// 清除之前的定时器\n\t\t\t\tif (this.searchTimers.school) {\n\t\t\t\t\tclearTimeout(this.searchTimers.school);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 设置防抖延迟500ms\n\t\t\t\tthis.searchTimers.school = setTimeout(() => {\n\t\t\t\t\tthis.performSchoolSearch(keyword);\n\t\t\t\t}, 500);\n\t\t\t\t\n\t\t\t\tuni.__f__('log','at pages_AI_Login_Match/AI/AI.vue:495',`学校搜索防抖设置: \"${keyword}\"`);\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 执行学校搜索\n\t\t\t * @param {String} keyword - 搜索关键词\n\t\t\t */\n\t\t\tasync performSchoolSearch(keyword) {\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await this.$store.dispatch('user/aiChat/searchAISchools', {\n\t\t\t\t\t\tkeyword: keyword\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tuni.__f__('log','at pages_AI_Login_Match/AI/AI.vue:508',`学校搜索完成: \"${keyword}\", 结果数: ${this.schoolOptions.length}`);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tuni.__f__('error','at pages_AI_Login_Match/AI/AI.vue:510','学校搜索失败:', error);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '学校搜索失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 处理专业搜索输入（带防抖）\n\t\t\t * @param {String} keyword - 搜索关键词\n\t\t\t */\n\t\t\thandleMajorSearch(keyword) {\n\t\t\t\t// 清除之前的定时器\n\t\t\t\tif (this.searchTimers.major) {\n\t\t\t\t\tclearTimeout(this.searchTimers.major);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 设置防抖延迟500ms\n\t\t\t\tthis.searchTimers.major = setTimeout(() => {\n\t\t\t\t\tthis.performMajorSearch(keyword);\n\t\t\t\t}, 500);\n\t\t\t\t\n\t\t\t\tuni.__f__('log','at pages_AI_Login_Match/AI/AI.vue:533',`专业搜索防抖设置: \"${keyword}\"`);\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 执行专业搜索\n\t\t\t * @param {String} keyword - 搜索关键词\n\t\t\t */\n\t\t\tasync performMajorSearch(keyword) {\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await this.$store.dispatch('user/aiChat/searchAIMajors', {\n\t\t\t\t\t\tkeyword: keyword\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tuni.__f__('log','at pages_AI_Login_Match/AI/AI.vue:546',`专业搜索完成: \"${keyword}\", 结果数: ${this.majorOptions.length}`);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tuni.__f__('error','at pages_AI_Login_Match/AI/AI.vue:548','专业搜索失败:', error);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '专业搜索失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 切换对话模式\n\t\t\t * @param {String} mode - 对话模式\n\t\t\t */\n\t\t\tswitchMode(mode) {\n\t\t\t\tif (this.currentMode === mode) return;\n\t\t\t\t\n\t\t\t\tthis.currentMode = mode;\n\t\t\t\tthis.messages = [];\n\t\t\t\tthis.currentChatId = 'chat_' + Date.now();\n\t\t\t\t\n\t\t\t\tthis.updateContextInfo();\n\t\t\t\t\n\t\t\t\tthis.$store.dispatch('user/aiChat/setCurrentChat', {\n\t\t\t\t\tchatId: this.currentChatId,\n\t\t\t\t\tchatMode: this.currentMode\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.closeSidebar();\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 更新对话上下文信息\n\t\t\t */\n\t\t\tupdateContextInfo() {\n\t\t\t\tthis.contextInfo = {\n\t\t\t\t\tmode: this.currentMode,\n\t\t\t\t\tuserSchoolId: this.currentSchoolId,\n\t\t\t\t\tuserMajorId: this.currentMajorId\n\t\t\t\t};\n\t\t\t},\n\t\t\t\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 开始新对话\n\t\t\t */\n\t\t\tstartNewChat() {\n\t\t\t\tthis.messages = [];\n\t\t\t\tthis.currentChatId = 'chat_' + Date.now();\n\t\t\t\t\n\t\t\t\tthis.updateContextInfo();\n\t\t\t\t\n\t\t\t\tthis.$store.dispatch('user/aiChat/setCurrentChat', {\n\t\t\t\t\tchatId: this.currentChatId,\n\t\t\t\t\tchatMode: this.currentMode\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.closeSidebar();\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 处理消息发送和重试\n\t\t\t * @param {String} messageContent - 消息内容\n\t\t\t * @param {Number} [retryIndex] - 重试消息的索引\n\t\t\t */\n\t\t\tasync handleMessage(messageContent, retryIndex = null) {\n\t\t\t\tif (!messageContent || this.isProcessing) return;\n\t\t\t\t\n\t\t\t\tlet userMessageIndex, aiMessageIndex;\n\t\t\t\t\n\t\t\t\tif (retryIndex === null) {\n\t\t\t\t\t// 新消息\n\t\t\t\t\tuserMessageIndex = this.messages.length;\n\t\t\t\t\tthis.messages.push({\n\t\t\t\t\t\trole: MESSAGE_TYPE.USER,\n\t\t\t\t\t\tcontent: messageContent,\n\t\t\t\t\t\tstatus: MESSAGE_STATUS.SENT\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\taiMessageIndex = this.messages.length;\n\t\t\t\t\tthis.messages.push({\n\t\t\t\t\t\trole: MESSAGE_TYPE.AI,\n\t\t\t\t\t\tcontent: '',\n\t\t\t\t\t\tstatus: MESSAGE_STATUS.SENDING,\n\t\t\t\t\t\tstreaming: false\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// 重试消息\n\t\t\t\t\tuserMessageIndex = retryIndex - 1;\n\t\t\t\t\taiMessageIndex = retryIndex;\n\t\t\t\t\tthis.messages[aiMessageIndex].content = '';\n\t\t\t\t\tthis.messages[aiMessageIndex].status = MESSAGE_STATUS.SENDING;\n\t\t\t\t\tthis.messages[aiMessageIndex].streaming = false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.scrollToBottom();\n\t\t\t\tthis.isProcessing = true;\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.updateContextInfo();\n\t\t\t\t\t\n\t\t\t\t\tif (!this.currentChatId) {\n\t\t\t\t\t\tthis.currentChatId = 'chat_' + Date.now();\n\t\t\t\t\t\tthis.$store.dispatch('user/aiChat/setCurrentChat', {\n\t\t\t\t\t\t\tchatId: this.currentChatId,\n\t\t\t\t\t\t\tchatMode: this.currentMode\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst response = await this.$store.dispatch('user/aiChat/testAIQA', {\n\t\t\t\t\t\tquestion: messageContent,\n\t\t\t\t\t\tcontextInfo: this.contextInfo,\n\t\t\t\t\t\tchatId: this.currentChatId,\n\t\t\t\t\t\tchatMode: this.currentMode\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\tthis.messages[aiMessageIndex].content = response.data;\n\t\t\t\t\t\tthis.messages[aiMessageIndex].status = MESSAGE_STATUS.SENT;\n\t\t\t\t\t\tthis.saveChatHistory();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst errorMessage = response.error?.message || response.message || '获取回复失败，请稍后重试';\n\t\t\t\t\t\tthis.messages[aiMessageIndex].content = `抱歉，无法获取回复：${errorMessage}`;\n\t\t\t\t\t\tthis.messages[aiMessageIndex].status = MESSAGE_STATUS.ERROR;\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.showToast(errorMessage, 'none', 3000);\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconst errorMsg = error.message || '系统异常，请稍后再试';\n\t\t\t\t\tthis.messages[aiMessageIndex].content = `抱歉，发生了错误：${errorMsg}`;\n\t\t\t\t\tthis.messages[aiMessageIndex].status = MESSAGE_STATUS.ERROR;\n\t\t\t\t\tthis.showToast(errorMsg, 'none', 3000);\n\t\t\t\t} finally {\n\t\t\t\t\tthis.isProcessing = false;\n\t\t\t\t\tthis.messages[aiMessageIndex].streaming = false;\n\t\t\t\t\tthis.scrollToBottom();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 发送消息\n\t\t\t * @param {String} messageContent - 消息内容\n\t\t\t */\n\t\t\tsendMessage(messageContent) {\n\t\t\t\tthis.handleMessage(messageContent);\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 重试发送失败的消息\n\t\t\t * @param {Number} index - 消息索引\n\t\t\t */\n\t\t\tretryMessage(index) {\n\t\t\t\tif (index < 1 || this.messages[index].role !== MESSAGE_TYPE.AI) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst userMessage = this.messages[index - 1];\n\t\t\t\tif (userMessage.role !== MESSAGE_TYPE.USER) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.handleMessage(userMessage.content, index);\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 中断当前请求\n\t\t\t */\n\t\t\tabortCurrentRequest() {\n\t\t\t\tif (this.currentController && this.currentController.abort) {\n\t\t\t\t\tthis.currentController.abort();\n\t\t\t\t\tthis.currentController = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 滚动到底部\n\t\t\t */\n\t\t\tscrollToBottom() {\n\t\t\t\tif (!this.isAutoScrollEnabled) return;\n\t\t\t\t\n\t\t\t\tif (this.messages.length > 0) {\n\t\t\t\t\tthis.autoScrollId = 'msg-' + (this.messages.length - 1);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 处理滚动事件\n\t\t\t */\n\t\t\tonScroll(e) {\n\t\t\t\t// 滚动事件处理\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 显示提示\n\t\t\t * @param {String} message - 提示信息\n\t\t\t * @param {String} [icon='none'] - 提示图标\n\t\t\t * @param {Number} [duration=2000] - 提示持续时间\n\t\t\t */\n\t\t\tshowToast(message, icon = 'none', duration = 2000) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: message,\n\t\t\t\t\ticon: icon,\n\t\t\t\t\tduration: duration\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 显示/隐藏加载状态\n\t\t\t * @param {Boolean} loading - 是否显示加载状态，true表示显示，false表示隐藏\n\t\t\t */\n\t\t\ttoggleLoading(loading = true) {\n\t\t\t\tthis.isLoading = loading;\n\t\t\t},\n\t\t\t\n\t\t\t// 侧边栏相关方法\n\t\t\ttoggleSidebar() {\n\t\t\t\tthis.sidebarVisible = !this.sidebarVisible;\n\t\t\t},\n\t\t\t\n\t\t\tcloseSidebar() {\n\t\t\t\tthis.sidebarVisible = false;\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 加载指定的聊天历史\n\t\t\t * @param {String} chatId - 聊天历史ID\n\t\t\t */\n\t\t\tloadChatHistory(chatId) {\n\t\t\t\tif (!chatId) return;\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.toggleLoading(true);\n\t\t\t\t\t\n\t\t\t\t\t// 从本地状态找对话\n\t\t\t\t\tconst conversations = this.historyChats || [];\n\t\t\t\t\tconst conversation = conversations.find(chat => chat.id === chatId);\n\t\t\t\t\t\n\t\t\t\t\tif (conversation) {\n\t\t\t\t\t\t// 设置当前会话ID\n\t\t\t\t\t\tthis.currentChatId = chatId;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 设置对话模式\n\t\t\t\t\t\tif (conversation.chatMode) {\n\t\t\t\t\t\t\tthis.currentMode = conversation.chatMode;\n\t\t\t\t\t\t\tthis.updateContextInfo();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 构建消息列表\n\t\t\t\t\t\tconst messages = conversation.messages ? conversation.messages.map(msg => {\n\t\t\t\t\t\t\tlet role = msg.role || MESSAGE_TYPE.AI;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (!msg.role && msg.id) {\n\t\t\t\t\t\t\t\tif (msg.id.includes('msg-user')) {\n\t\t\t\t\t\t\t\t\trole = MESSAGE_TYPE.USER;\n\t\t\t\t\t\t\t\t} else if (msg.id.includes('msg-system')) {\n\t\t\t\t\t\t\t\t\trole = MESSAGE_TYPE.SYSTEM;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\trole: role,\n\t\t\t\t\t\t\t\tcontent: msg.content,\n\t\t\t\t\t\t\t\tstatus: MESSAGE_STATUS.SENT,\n\t\t\t\t\t\t\t\tstreaming: false\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}) : [];\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.messages = messages;\n\t\t\t\t\t\tthis.closeSidebar();\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t\tthis.scrollToBottom();\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.toggleLoading(false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 从服务器加载\n\t\t\t\t\t\tthis.$store.dispatch('user/aiChat/loadChat', chatId).then(response => {\n\t\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\t\tthis.currentChatId = chatId;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (response.data.chatMode) {\n\t\t\t\t\t\t\t\t\tthis.currentMode = response.data.chatMode;\n\t\t\t\t\t\t\t\t\tthis.updateContextInfo();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tthis.messages = response.data.messages || [];\n\t\t\t\t\t\t\t\tthis.closeSidebar();\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t\t\t\tthis.scrollToBottom();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconst errorMsg = response.error?.message || response.message || '加载对话失败';\n\t\t\t\t\t\t\t\tthis.showToast(`加载失败: ${errorMsg}`, 'none', 3000);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (response.error?.statusCode >= 500) {\n\t\t\t\t\t\t\t\t\tthis.startNewChat();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).finally(() => {\n\t\t\t\t\t\t\tthis.toggleLoading(false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tuni.__f__('error','at pages_AI_Login_Match/AI/AI.vue:851','加载对话内容失败:', error);\n\t\t\t\t\tthis.toggleLoading(false);\n\t\t\t\t\tthis.startNewChat();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 从Vuex加载历史会话摘要\n\t\t\t */\n\t\t\tloadChatHistoryFromStorage() {\n\t\t\t\tconst conversations = this.historyChats;\n\t\t\t\t\n\t\t\t\tif (conversations && conversations.length > 0) {\n\t\t\t\t\tconst historySummaries = conversations.map(chat => ({\n\t\t\t\t\t\tid: chat.id,\n\t\t\t\t\t\ttitle: chat.abstract,\n\t\t\t\t\t\tabstract: chat.abstract,\n\t\t\t\t\t\tchatMode: chat.chatMode,\n\t\t\t\t\t\tcreatedAt: chat.createdAt,\n\t\t\t\t\t\tupdatedAt: chat.updatedAt\n\t\t\t\t\t}));\n\t\t\t\t\t\n\t\t\t\t\tthis.$store.commit('user/aiChat/SET_HISTORY_SUMMARIES', historySummaries);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 保存聊天历史摘要到Vuex\n\t\t\t */\n\t\t\tsaveChatHistory() {\n\t\t\t\tif (!this.currentChatId || this.messages.length === 0) return;\n\t\t\t\t\n\t\t\t\tconst firstUserMessage = this.messages.find(msg => msg.role === MESSAGE_TYPE.USER);\n\t\t\t\tconst title = firstUserMessage ? firstUserMessage.content.substring(0, 20) : '新对话';\n\t\t\t\t\n\t\t\t\tconst chatData = {\n\t\t\t\t\tid: this.currentChatId,\n\t\t\t\t\ttitle: title + (title.length >= 20 ? '...' : ''),\n\t\t\t\t\tabstract: title,\n\t\t\t\t\tchatMode: this.currentMode,\n\t\t\t\t\tcreatedAt: new Date().toISOString(),\n\t\t\t\t\tupdatedAt: new Date().toISOString(),\n\t\t\t\t\tmessages: this.messages.map((msg, index) => ({\n\t\t\t\t\t\tid: `msg-${msg.role === MESSAGE_TYPE.USER ? 'user' : 'ai'}-${this.currentChatId}-${index}`,\n\t\t\t\t\t\trole: msg.role,\n\t\t\t\t\t\tcontent: msg.content,\n\t\t\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t\t\t}))\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t// 更新到Vuex\n\t\t\t\tthis.$store.commit('user/aiChat/ADD_CONVERSATION', chatData);\n\t\t\t\t\n\t\t\t\t// 更新历史摘要\n\t\t\t\tconst summaryData = {\n\t\t\t\t\tid: chatData.id,\n\t\t\t\t\ttitle: chatData.title,\n\t\t\t\t\tabstract: chatData.abstract,\n\t\t\t\t\tchatMode: chatData.chatMode,\n\t\t\t\t\tcreatedAt: chatData.createdAt,\n\t\t\t\t\tupdatedAt: chatData.updatedAt\n\t\t\t\t};\n\t\t\t\tthis.$store.commit('user/aiChat/ADD_HISTORY_SUMMARY', summaryData);\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 删除历史记录\n\t\t\t * @param {String} chatId - 历史记录ID\n\t\t\t */\n\t\t\tdeleteChatHistory(chatId) {\n\t\t\t\tif (!chatId) return;\n\t\t\t\t\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: '确认删除',\n\t\t\t\t\tcontent: '确定要删除这条对话记录吗？',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\t\t\ttitle: '正在删除...',\n\t\t\t\t\t\t\t\tmask: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tthis.$store.commit('user/aiChat/REMOVE_CONVERSATION', chatId);\n\t\t\t\t\t\t\t\tthis.$store.commit('user/aiChat/REMOVE_HISTORY_SUMMARY', chatId);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (this.currentChatId === chatId) {\n\t\t\t\t\t\t\t\t\tthis.startNewChat();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tthis.showToast('删除成功');\n\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\t\tthis.showToast('删除失败: ' + (error.message || '系统错误'), 'none', 3000);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\thandleBack(){\n\t\t\t\tNavigator.toIndex()\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t.page-container {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t\theight: 100vh;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tpadding: 0; /* 移除页面容器的内边距 */\n\t\tbox-sizing: border-box;\n\t\tbackground-color: #f5f5f5;\n\t\toverflow: hidden; /* 防止内容溢出 */\n\t}\n\t\n\t/* 加载遮罩 */\n\t.loading-mask {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tz-index: 1500;\n\t}\n\t\n\t.loading-content {\n\t\tbackground-color: #ffffff;\n\t\tpadding: 30rpx 60rpx;\n\t\tborder-radius: 20rpx;\n\t\tbox-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.15);\n\t}\n\t\n\t.loading-content text {\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t}\n\t\n\t/* 侧边栏容器样式 */\n\t.nav-sidebar-container {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\toverflow: hidden;\n\t}\n\t\n\t.sidebar-mask {\n\t\tposition: fixed;\n\t\ttop: 206rpx; /* 修改这里，让遮罩层从header下面开始 */\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\n\t\tz-index: 1500;\n\t\ttransition: opacity 0.3s ease;\n\t}\n\n\t.main-wrapper {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\ttransition: transform 0.3s ease, opacity 0.3s ease;\n\t\tbackground-color: #f5f5f5;\n\t}\n\t\n\t.main-content {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tpadding: 0; /* 去除左右内边距 */\n\t\theight: 100%;\n\t\toverflow-y: auto; /* 允许内容垂直滚动 */\n\t}\n\t\n\t/* 筛选区域样式 */\n\t.filter-section {\n\t\tbackground-color: #fff;\n\t\tborder-radius: 15rpx;\n\t\tmargin: 20rpx 0; /* 只保留上下间距，左右为0 */\n\t\tpadding: 20rpx;\n\t\tbox-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\n\t}\n\t\n\t.choice-wrapper {\n\t\tflex: 1;\n\t\tbox-sizing: border-box;\n\t\twidth: calc(100% - 150rpx); /* 考虑标签宽度和间距 */\n\t\tpadding-right: 10rpx; /* 防止右侧超出边界 */\n\t}\n\t\n\t.filter-title text {\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tfont-weight: 500;\n\t}\n\t\n\t.filter-content {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 20rpx;\n\t}\n\t\n\t.filter-item {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tbox-sizing: border-box;\n\t\twidth: 100%;\n\t}\n\t\n\t.full-width {\n\t\twidth: 100%;\n\t}\n\t\n\t.filter-label {\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\twhite-space: nowrap;\n\t\tmargin-right: 10rpx;\n\t\twidth: 140rpx; /* 改为固定宽度，不用min-width */\n\t\tpadding-left: 10rpx;\n\t\ttext-align: left;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.filter-select {\n\t\twidth: 100%;\n\t\tborder: 1px solid #e0e0e0;\n\t\tborder-radius: 8rpx;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t/* 导航栏样式 */\n\t.nav-bar {\n\t\theight: 90rpx;\n\t\tbackground-color: #ffffff;\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tborder-bottom: none; /* 移除底部边框 */\n\t\tposition: relative;\n\t\tz-index: 11; /* 提高z-index，确保显示在筛选区域上方 */\n\t}\n\t\n\t.nav-left {\n\t\twidth: 20%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\t\n\t.history-btn {\n\t\twidth: 80rpx;\n\t\theight: 80rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t\n\t.history-btn .iconfont {\n\t\tfont-size: 48rpx;\n\t\tcolor: #333;\n\t}\n\t\n\t/* 新增图片图标样式 */\n\t.history-icon {\n\t\twidth: 22px;\n\t\theight: 15px;\n\t\tdisplay: block;\n\t\tmargin: 0 auto;\n\t}\n\t\n\t.nav-title {\n\t\twidth: 60%;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\toverflow: hidden;\n\t}\n\t\n\t.nav-title text {\n\t\tfont-size: 32rpx; /* 增大字体 */\n\t\tcolor: #333;\n\t\tfont-weight: 700; /* 加粗 */\n\t}\n\t\n\t.nav-right {\n\t\twidth: 20%;\n\t\tdisplay: flex;\n\t\tjustify-content: flex-end;\n\t\talign-items: center;\n\t}\n\t\n\t.new-chat-btn {\n\t\tpadding: 14rpx 28rpx;\n\n\n\n\t\ttransition: all 0.3s;\n\t}\n\t\n\n\t\n\t/* 新增新对话图片图标样式 */\n\t.new-chat-icon {\n\t\twidth: 15px;\n\t\theight: 15px;\n\t\tdisplay: block;\n\t\tmargin: 0 auto;\n\t}\n\t\n\n</style>\n","import MiniProgramPage from 'E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/pages_AI_Login_Match/AI/AI.vue'\nwx.createPage(MiniProgramPage)"],"names":["HistorySidebar","MessageList","ModeSelector","InputSection","ChoiceSelected","Header","LoadingAnimation","MESSAGE_TYPE","MESSAGE_STATUS","CHAT_MODE","_sfc_main","defineComponent","uni","mapState","state","item","now","today","week","month","timeStr","time","diffTime","diffDays","newVal","newOptions","timer","dropdown","schoolOptions","schoolIndex","majorOptions","majorIndex","index","school","schoolOption","major","majorOption","keyword","response","error","mode","messageContent","retryIndex","aiMessageIndex","errorMessage","_a","errorMsg","userMessage","message","icon","duration","loading","chatId","conversation","chat","messages","msg","role","_b","conversations","historySummaries","firstUserMessage","title","chatData","summaryData","res","Navigator","MiniProgramPage"],"mappings":"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"}