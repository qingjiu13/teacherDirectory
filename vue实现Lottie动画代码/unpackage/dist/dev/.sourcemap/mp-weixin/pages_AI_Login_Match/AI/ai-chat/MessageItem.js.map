{"version":3,"file":"MessageItem.js","sources":["pages_AI_Login_Match/AI/ai-chat/MessageItem.vue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTov56CU5biI5b2V5LiO5YW25LuW5Lq65YWx5Lqr5paH5Lu2L3RlYWNoZXJEaXJlY3RvcnkvdnVl5a6e546wTG90dGll5Yqo55S75Luj56CBL3BhZ2VzX0FJX0xvZ2luX01hdGNoL0FJL2FpLWNoYXQvTWVzc2FnZUl0ZW0udnVl"],"sourcesContent":["<template>\n\t<view class=\"message-item\" :class=\"[messageType, {'streaming': streaming}]\">\n\t\t<view class=\"message-container\">\n\t\t\t<!-- AI头像 -->\n\t\t\t<image v-if=\"messageType === 'ai'\" :src=\"aiAvatar\" class=\"avatar ai-avatar\" mode=\"aspectFill\" />\n\n\t\t\t<!-- 消息内容区 -->\n\t\t\t<view class=\"message-content-wrapper\" :class=\"messageType + '-wrapper'\">\n\t\t\t\t<view class=\"message-header\" v-if=\"messageType === 'ai'\">\n\t\t\t\t\t<text class=\"ai-title\">{{ aiTitle }}</text>\n\t\t\t\t</view>\n\n\t\t\t\t<!-- 消息卡片外层：渐变边框 -->\n\t\t\t\t<view class=\"card-outer\" :class=\"messageType + '-card-outer-gradient'\">\n\t\t\t\t\t<!-- 消息卡片内层：内容区 -->\n\t\t\t\t\t<view class=\"card-inner\" :class=\"messageType + '-card-inner'\">\n\t\t\t\t\t\t<view class=\"message-content\" :class=\"messageType + '-content'\">\n\t\t\t\t\t\t\t<!-- 这里改成使用 v-html 渲染 markdown -->\n\t\t\t\t\t\t\t<view v-html=\"renderedContent\"></view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"message-status\" v-if=\"status === 'sending'\">\n\t\t\t\t\t<text class=\"sending-dots\">...</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"message-status\" v-if=\"status === 'error'\">\n\t\t\t\t\t<text class=\"error-text\">发送失败</text>\n\t\t\t\t\t<view class=\"retry-btn\" @click=\"onRetry\">\n\t\t\t\t\t\t<text class=\"retry-btn-text\">重试</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<!-- 用户头像 -->\n\t\t\t<image v-if=\"messageType === 'user'\" :src=\"userAvatar\" class=\"avatar user-avatar\" mode=\"aspectFill\" />\n\t\t</view>\n\t</view>\n</template>\n\n<script lang=\"uts\">\nimport { marked } from 'marked'\n\nexport default {\n\tname: \"MessageItem\",\n\tprops: {\n\t\trole: {\n\t\t\ttype: String,\n\t\t\tdefault: 'user',\n\t\t\tvalidator: (value) => ['user', 'AI'].includes(value)\n\t\t},\n\t\tcontent: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t},\n\t\tstatus: {\n\t\t\ttype: String,\n\t\t\tdefault: 'sent',\n\t\t\tvalidator: (value) => ['sending', 'sent', 'error'].includes(value)\n\t\t},\n\t\tstreaming: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\taiTitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '研师录AI'\n\t\t},\n\t\tuserAvatar: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t},\n\t\taiAvatar: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t}\n\t},\n\tcomputed: {\n\t\tmessageType() {\n\t\t\treturn this.role === 'AI' ? 'ai' : this.role;\n\t\t},\n\t\t// 新增：Markdown 转 HTML\n\t\trenderedContent() {\n\t\t\ttry {\n\t\t\t\treturn marked.parse(this.content || '');\n\t\t\t} catch (e) {\n\t\t\t\treturn this.content;\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\tonRetry() {\n\t\t\tthis.$emit('retry');\n\t\t}\n\t}\n}\n</script>\n\n\n<style>\n.message-content h1,\n.message-content h2 {\n\tfont-weight: bold;\n\tmargin-bottom: 10rpx;\n}\n.message-content p {\n\tmargin-bottom: 10rpx;\n}\n.message-content ul {\n\tpadding-left: 40rpx;\n}\n.message-content li {\n\tmargin-bottom: 6rpx;\n}\n.message-content a {\n\tcolor: #1e90ff;\n\ttext-decoration: underline;\n}\n.message-content code {\n\tbackground-color: #f4f4f4;\n\tpadding: 4rpx 8rpx;\n\tborder-radius: 4rpx;\n\tfont-family: monospace;\n}\n\n\t.message-item {\n\t\twidth: 100%;\n\t\tmargin-bottom: 30rpx;\n\t\tposition: relative;\n\t\tanimation: fadeIn 0.3s ease-in-out;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t@keyframes fadeIn {\n\t\tfrom { opacity: 0; transform: translateY(10rpx); }\n\t\tto { opacity: 1; transform: translateY(0); }\n\t}\n\t\n\t/**\n\t * @description 消息容器样式调整：增高容器高度，内容靠底部，头像靠顶部\n\t */\n\t.message-container {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tposition: relative;\n\t\tmin-height: 180rpx; /* 增加最小高度，可根据实际需求调整 */\n\t\talign-items: flex-end; /* 让内容靠底部 */\n\t}\n\t\n\t/**\n\t * @description 消息内容包裹区样式调整，使内容靠底部\n\t */\n\t.message-content-wrapper {\n\t\twidth: 80%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: flex-end; /* 让内容靠底部 */\n\t}\n\t\n\t.ai-wrapper {\n\t\tmargin-right: auto; /* AI消息靠左 */\n\t\tpadding-left: calc(142rpx); /* 预留AI头像宽度+20rpx空间 */\n\t}\n\t\n\t.user-wrapper {\n\t\tmargin-left: auto; /* 用户消息靠右 */\n\t\tpadding-right: calc(142rpx); /* 预留用户头像宽度+20rpx空间 */\n\t}\n\t\n\t.avatar {\n\t\twidth: 142rpx;\n\t\theight: 110rpx;\n\t\tborder-radius: 16rpx;\n\t\tobject-fit: cover;\n\t\tposition: absolute;\n\t\ttop: 0;\n\t}\n\t\n\t.ai-avatar {\n\t\tleft: 0; /* AI头像在左侧 */\n\t}\n\t\n\t.user-avatar {\n\t\tright: 0; /* 用户头像在右侧 */\n\t}\n\t\n\t/**\n\t * @description 卡片外层：模拟渐变边框\n\t */\n\t.card-outer {\n\t\twidth: 100%;\n\n\t\tborder-radius: 40rpx;\n\t\tpadding: 2rpx; /* 边框宽度 */\n\t\tbox-sizing: border-box;\n\t\tdisplay: flex;\n\t\talign-items: stretch;\n\t\tjustify-content: stretch;\n\t\tbackground: transparent;\n\t}\n\t\n\t/**\n\t * @description 用户消息卡片外层渐变（蓝色系）\n\t */\n\t.user-card-outer-gradient {\n\t\tbackground: linear-gradient(180deg, rgba(228, 241, 255, 1) 0%, rgba(34, 136, 249, 1) 100%);\n\t}\n\t\n\t/**\n\t * @description AI消息卡片外层渐变（紫色系）\n\t */\n\t.ai-card-outer-gradient {\n\t\tbackground: linear-gradient(180deg, rgba(233, 234, 255, 1) 0%, rgba(95, 38, 247, 1) 100%);\n\t}\n\t\n\t/**\n\t * @description 卡片内层：内容区（高度自适应，内容靠底部）\n\t */\n\t.card-inner {\n\t\twidth: 100%;\n\t\tborder-radius: 40rpx;\n\t\tbackground: #fff;\n\t\toverflow: hidden;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: flex-end; /* 内容靠底部 */\n\t\tposition: relative;\n\t}\n\t\n\t/**\n\t * @description 用户消息卡片内层渐变遮罩\n\t */\n\t.user-card-inner::after {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tborder-radius: 39rpx;\n\t\tpointer-events: none;\n\t\tbackground: linear-gradient(180deg, rgba(194, 221, 250, 0.2) 11.54%, rgba(34, 136, 249, 0.2) 111.54%);\n\t\tz-index: 1;\n\t}\n\t\n\t/**\n\t * @description AI消息卡片内层渐变遮罩\n\t */\n\t.ai-card-inner::after {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tborder-radius: 39rpx;\n\t\tpointer-events: none;\n\t\tbackground: linear-gradient(180deg, rgba(224, 212, 255, 0.2) 11.54%, rgba(95, 38, 247, 0.2) 111.54%);\n\t\tz-index: 1;\n\t}\n\t\n\t.message-content {\n\t\tpadding: 20rpx 30rpx;\n\t\tfont-size: 28rpx;\n\t\tline-height: 1.5;\n\t\tword-break: break-word;\n\t\tposition: relative;\n\t\tz-index: 2;\n\t}\n\t\n\t.user-content {\n\t\tcolor: #2F2F2F;\n\t}\n\t\n\t.ai-content {\n\t\tcolor: #2F2F2F;\n\t}\n\t\n\t.message-header {\n\t\tmargin-bottom: 10rpx;\n\t}\n\t\n\t.ai-title {\n\t\tfont-size: 24rpx;\n\t\tcolor: #666;\n\t\tpadding-left: 10rpx;\n\t}\n\t\n\t.message-status {\n\t\tmargin-top: 10rpx;\n\t\tfont-size: 24rpx;\n\t\tcolor: #999;\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t}\n\t\n\t.sending-dots {\n\t\tanimation: dotsAnimation 1.5s infinite;\n\t}\n\t\n\t@keyframes dotsAnimation {\n\t\t0% { opacity: 0.3; }\n\t\t50% { opacity: 1; }\n\t\t100% { opacity: 0.3; }\n\t}\n\t\n\t.error-text {\n\t\tcolor: #ff4d4f;\n\t\tmargin-right: 10rpx;\n\t}\n\t\n\t.retry-btn {\n\t\tpadding: 5rpx 15rpx;\n\t\tbackground-color: #f0f0f0;\n\t\tborder-radius: 10rpx;\n\t}\n\t\n\t.retry-btn-text {\n\t\tcolor: #1E90FF;\n\t\tfont-size: 22rpx;\n\t}\n\t\n\t.message-item.streaming .message-content {\n\t\tposition: relative;\n\t}\n\t\n\t.message-item.streaming .message-content::after {\n\t\tcontent: \"|\";\n\t\tdisplay: inline-block;\n\t\tcolor: #1E90FF;\n\t\tanimation: blink 1s step-end infinite;\n\t\tmargin-left: 2rpx;\n\t\tfont-weight: bold;\n\t}\n\t\n\t@keyframes blink {\n\t\t0%, 100% { opacity: 1; }\n\t\t50% { opacity: 0; }\n\t}\n</style> ","import Component from 'E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/pages_AI_Login_Match/AI/ai-chat/MessageItem.vue'\nwx.createComponent(Component)"],"names":["_sfc_main","defineComponent","value","marked","Component"],"mappings":"0DA2CAA,EAAeC,kBAAA,CACd,KAAM,cACN,MAAO,CACN,KAAM,CACL,KAAM,OACN,QAAS,OACT,UAAW,CAACC,EAAK,OAAK,CAAC,OAAQ,IAAI,EAAE,SAASA,CAAK,CACnD,EACD,QAAS,CACR,KAAM,OACN,QAAS,EACT,EACD,OAAQ,CACP,KAAM,OACN,QAAS,OACT,UAAW,CAACA,SAAU,CAAC,UAAW,OAAQ,OAAO,EAAE,SAASA,CAAK,CACjE,EACD,UAAW,CACV,KAAM,QACN,QAAS,EACT,EACD,QAAS,CACR,KAAM,OACN,QAAS,OACT,EACD,WAAY,CACX,KAAM,OACN,QAAS,EACT,EACD,SAAU,CACT,KAAM,OACN,QAAS,EACV,CACA,EACD,SAAU,CACT,aAAW,CACV,OAAO,KAAK,OAAS,KAAO,KAAO,KAAK,IACxC,EAED,iBAAe,CACd,GAAI,CACH,OAAOC,EAAM,OAAC,MAAM,KAAK,SAAW,EAAE,CACvC,MAAY,CACX,OAAO,KAAK,OACb,CACD,CACA,EACD,QAAS,CACR,SAAO,CACN,KAAK,MAAM,OAAO,CACnB,CACD,EACD,0pBC9FA,GAAG,gBAAgBC,CAAS"}