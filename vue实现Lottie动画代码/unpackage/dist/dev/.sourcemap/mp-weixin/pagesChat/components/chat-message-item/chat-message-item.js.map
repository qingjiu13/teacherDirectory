{"version":3,"file":"chat-message-item.js","sources":["pagesChat/components/chat-message-item/chat-message-item.vue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTov56CU5biI5b2V5LiO5YW25LuW5Lq65YWx5Lqr5paH5Lu2L3RlYWNoZXJEaXJlY3RvcnkvdnVl5a6e546wTG90dGll5Yqo55S75Luj56CBL3BhZ2VzQ2hhdC9jb21wb25lbnRzL2NoYXQtbWVzc2FnZS1pdGVtL2NoYXQtbWVzc2FnZS1pdGVtLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"chat-msg-item\">\n\t\t<view class=\"chat-msg-tip\" v-if=\"msgInfo.type == $enums.MESSAGE_TYPE.TIP_TEXT\">\n\t\t\t{{ msgInfo.content }}\n\t\t</view>\n\t\t<view class=\"chat-msg-tip\" v-else-if=\"msgInfo.type == $enums.MESSAGE_TYPE.TIP_TIME\">\n\t\t\t{{ $date.toTimeText(msgInfo.sendTime) }}\n\t\t</view>\n\t\t<view class=\"chat-msg-normal\" v-else-if=\"isNormal\" :class=\"{ 'chat-msg-mine': msgInfo.selfSend }\">\n\t\t\t<head-image class=\"avatar\" @longpress.prevent=\"$emit('longPressHead')\" :id=\"msgInfo.sendId\" :url=\"headImage\"\n\t\t\t\t:name=\"showName\" size=\"small\"></head-image>\n\t\t\t<view class=\"chat-msg-content\">\n\t\t\t\t<view v-if=\"msgInfo.groupId && !msgInfo.selfSend\" class=\"chat-msg-top\">\n\t\t\t\t\t<text>{{ showName }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"chat-msg-bottom\">\n\t\t\t\t\t<view v-if=\"msgInfo.type == $enums.MESSAGE_TYPE.TEXT\">\n\t\t\t\t\t\t<long-press-menu :items=\"menuItems\" @select=\"onSelectMenu\">\n\t\t\t\t\t\t\t<!-- rich-text支持显示表情，但是不支持点击a标签 -->\n\t\t\t\t\t\t\t<rich-text v-if=\"$emo.containEmoji(msgInfo.content)\" class=\"chat-msg-text\"\n\t\t\t\t\t\t\t\t:nodes=\"nodesText\"></rich-text>\n\t\t\t\t\t\t\t<!-- up-parse支持点击a标签,但安卓打包后表情无法显示,原因未知 -->\n\t\t\t\t\t\t\t<up-parse v-else class=\"chat-msg-text\" :showImgMenu=\"false\" :content=\"nodesText\"></up-parse>\n\t\t\t\t\t\t</long-press-menu>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"chat-msg-image\" v-if=\"msgInfo.type == $enums.MESSAGE_TYPE.IMAGE\">\n\t\t\t\t\t\t<long-press-menu :items=\"menuItems\" @select=\"onSelectMenu\">\n\t\t\t\t\t\t\t<view class=\"img-load-box\">\n\t\t\t\t\t\t\t\t<image class=\"send-image\" mode=\"heightFix\" :src=\"getSafeImageUrl(msgInfo.content)\"\n\t\t\t\t\t\t\t\t\tlazy-load=\"true\" @click.stop=\"onShowFullImage()\">\n\t\t\t\t\t\t\t\t</image>\n\t\t\t\t\t\t\t\t<loading v-if=\"loading\"></loading>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</long-press-menu>\n\t\t\t\t\t\t<text title=\"发送失败\" v-if=\"loadFail\" @click=\"onSendFail\"\n\t\t\t\t\t\t\tclass=\"send-fail iconfont icon-warning-circle-fill\"></text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"chat-msg-file\" v-if=\"msgInfo.type == $enums.MESSAGE_TYPE.FILE\">\n\t\t\t\t\t\t<long-press-menu :items=\"menuItems\" @select=\"onSelectMenu\">\n\t\t\t\t\t\t\t<view class=\"chat-file-box\">\n\t\t\t\t\t\t\t\t<view class=\"chat-file-info\">\n\t\t\t\t\t\t\t\t\t<uni-link class=\"chat-file-name\" :text=\"data.name\" showUnderLine=\"true\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"#007BFF\" :href=\"data.url\"></uni-link>\n\t\t\t\t\t\t\t\t\t<view class=\"chat-file-size\">{{ fileSize }}</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<view class=\"chat-file-icon iconfont icon-file\"></view>\n\t\t\t\t\t\t\t\t<loading v-if=\"loading\"></loading>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</long-press-menu>\n\t\t\t\t\t\t<text title=\"发送失败\" v-if=\"loadFail\" @click=\"onSendFail\"\n\t\t\t\t\t\t\tclass=\"send-fail iconfont icon-warning-circle-fill\"></text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<long-press-menu v-if=\"msgInfo.type == $enums.MESSAGE_TYPE.AUDIO\" :items=\"menuItems\"\n\t\t\t\t\t\t@select=\"onSelectMenu\">\n\t\t\t\t\t\t<view class=\"chat-msg-audio chat-msg-text\" @click=\"onPlayAudio()\">\n\t\t\t\t\t\t\t<text class=\"iconfont icon-voice-play\"></text>\n\t\t\t\t\t\t\t<text class=\"chat-audio-text\">{{ getAudioDuration(msgInfo.content) }}</text>\n\t\t\t\t\t\t\t<text v-if=\"audioPlayState == 'PAUSE'\" class=\"iconfont icon-play\"></text>\n\t\t\t\t\t\t\t<text v-if=\"audioPlayState == 'PLAYING'\" class=\"iconfont icon-pause\"></text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</long-press-menu>\n\t\t\t\t\t<long-press-menu v-if=\"isAction\" :items=\"menuItems\" @select=\"onSelectMenu\">\n\t\t\t\t\t\t<view class=\"chat-realtime chat-msg-text\" @click=\"$emit('call')\">\n\t\t\t\t\t\t\t<text v-if=\"msgInfo.type == $enums.MESSAGE_TYPE.ACT_RT_VOICE\"\n\t\t\t\t\t\t\t\tclass=\"iconfont icon-chat-voice\"></text>\n\t\t\t\t\t\t\t<text v-if=\"msgInfo.type == $enums.MESSAGE_TYPE.ACT_RT_VIDEO\"\n\t\t\t\t\t\t\t\tclass=\"iconfont icon-chat-video\"></text>\n\t\t\t\t\t\t\t<text>{{ msgInfo.content }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</long-press-menu>\n\t\t\t\t\t<view class=\"chat-msg-status\" v-if=\"!isAction\">\n\t\t\t\t\t\t<text class=\"chat-readed\" v-if=\"msgInfo.selfSend && !msgInfo.groupId\n\t\t\t\t\t\t\t&& msgInfo.status == $enums.MESSAGE_STATUS.READED\">已读</text>\n\t\t\t\t\t\t<text class=\"chat-unread\" v-if=\"msgInfo.selfSend && !msgInfo.groupId\n\t\t\t\t\t\t\t&& msgInfo.status != $enums.MESSAGE_STATUS.READED\">未读</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"chat-receipt\" v-if=\"msgInfo.receipt\" @click=\"onShowReadedBox\">\n\t\t\t\t\t\t<text v-if=\"msgInfo.receiptOk\" class=\"tool-icon iconfont icon-ok\"></text>\n\t\t\t\t\t\t<text v-else>{{ msgInfo.readedCount }}人已读</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<chat-group-readed ref=\"chatGroupReaded\" :groupMembers=\"groupMembers\" :msgInfo=\"msgInfo\"></chat-group-readed>\n\n\t</view>\n</template>\n\n<script lang=\"uts\">\nimport { MESSAGE_TYPE, MESSAGE_STATUS } from '/pagesChat/common/enums.js';\nimport HeadImage from '/pagesChat/components/head-image/head-image';\nimport LongPressMenu from '/pagesChat/components/long-press-menu/long-press-menu';\nimport Loading from '/pagesChat/components/loading/loading';\nimport ChatGroupReaded from '/pagesChat/components/chat-group-readed/chat-group-readed';\nimport emoUtil from '/pagesChat/common/emotion.js';\nimport urlUtil from '/pagesChat/common/url.js';\nimport * as msgType from '/pagesChat/common/messageType.js';\nimport * as dateUtil from '/pagesChat/common/date.js';\n\nexport default {\n\tname: \"chat-message-item\",\n\tcomponents: {\n\t\tHeadImage,\n\t\tLongPressMenu,\n\t\tLoading,\n\t\tChatGroupReaded\n\t},\n\tprops: {\n\t\theadImage: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tshowName: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tmsgInfo: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\tgroupMembers: {\n\t\t\ttype: Array\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\taudioPlayState: 'STOP',\n\t\t\tinnerAudioContext: null,\n\t\t\tmenu: {\n\t\t\t\tshow: false,\n\t\t\t\tstyle: \"\"\n\t\t\t},\n\t\t\t// 导入的常量，确保即使全局属性不可用也能正常工作\n\t\t\tMESSAGE_TYPE,\n\t\t\tMESSAGE_STATUS\n\t\t}\n\t},\n\t// 确保在模板中可以使用$enums替代方案\n\tbeforeCreate() {\n\t\t// 先检查全局属性是否可用\n\t\tif (!this.$enums) {\n\t\t\t// 如果不可用，创建一个替代对象\n\t\t\tthis.$enums = {\n\t\t\t\tMESSAGE_TYPE,\n\t\t\t\tMESSAGE_STATUS\n\t\t\t};\n\t\t}\n\t\t\n\t\t// 确保$emo可用\n\t\tif (!this.$emo) {\n\t\t\tthis.$emo = emoUtil;\n\t\t}\n\t\t\n\t\t// 确保$date可用\n\t\tif (!this.$date) {\n\t\t\tthis.$date = dateUtil;\n\t\t}\n\t\t\n\t\t// 确保$url可用\n\t\tif (!this.$url) {\n\t\t\tthis.$url = urlUtil;\n\t\t}\n\t},\n\tmethods: {\n\t\tgetSafeImageUrl(content) {\n\t\t\ttry {\n\t\t\t\tif (!content) {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\t// 检查内容是否是JSON格式（以{开头）\n\t\t\t\tconst trimmed = typeof content === 'string' ? content.trim() : '';\n\t\t\t\tif (!trimmed.startsWith('{')) {\n\t\t\t\t\tuni.__f__('warn','at pagesChat/components/chat-message-item/chat-message-item.vue:173','内容不是JSON格式:', trimmed.substring(0, 10) + '...');\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst parsed = JSON.parse(content);\n\t\t\t\treturn (parsed && parsed.thumbUrl) ? parsed.thumbUrl : '';\n\t\t\t} catch (error) {\n\t\t\t\tuni.__f__('error','at pagesChat/components/chat-message-item/chat-message-item.vue:180','解析图片URL出错:', error);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\t\tgetAudioDuration(content) {\n\t\t\ttry {\n\t\t\t\tif (!content) {\n\t\t\t\t\treturn '0\"';\n\t\t\t\t}\n\t\t\t\t// 检查内容是否是JSON格式（以{开头）\n\t\t\t\tconst trimmed = content.trim();\n\t\t\t\tif (!trimmed.startsWith('{')) {\n\t\t\t\t\tuni.__f__('warn','at pagesChat/components/chat-message-item/chat-message-item.vue:192','音频内容不是JSON格式:', trimmed.substring(0, 10) + '...');\n\t\t\t\t\treturn '0\"';\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst parsed = JSON.parse(content);\n\t\t\t\treturn (parsed && parsed.duration) ? parsed.duration + '\"' : '0\"';\n\t\t\t} catch (error) {\n\t\t\t\tuni.__f__('error','at pagesChat/components/chat-message-item/chat-message-item.vue:199','解析音频时长出错:', error);\n\t\t\t\treturn '0\"';\n\t\t\t}\n\t\t},\n\t\tonSendFail() {\n\t\t\tuni.showToast({\n\t\t\t\ttitle: \"该文件已发送失败，目前不支持自动重新发送，建议手动重新发送\",\n\t\t\t\ticon: \"none\"\n\t\t\t})\n\t\t},\n\t\tonPlayAudio() {\n\t\t\tif (this.audioPlayState == 'PLAYING') {\n\t\t\t\tthis.stopPlayAudio();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (!this.msgInfo.content) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '音频格式错误',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlet data = JSON.parse(this.msgInfo.content);\n\t\t\t\tlet audioUrl = data && data.url ? data.url : null;\n\t\t\t\t\n\t\t\t\tif (!audioUrl) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '音频地址错误',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.innerAudioContext = uni.createInnerAudioContext();\n\t\t\t\tthis.innerAudioContext.src = audioUrl;\n\t\t\t\tthis.innerAudioContext.autoplay = true;\n\t\t\t\tthis.innerAudioContext.onPlay(() => {\n\t\t\t\t\tthis.audioPlayState = 'PLAYING';\n\t\t\t\t\tthis.$emit('audioStateChange', 'PLAYING', this.msgInfo);\n\t\t\t\t});\n\t\t\t\tthis.innerAudioContext.onEnded(() => {\n\t\t\t\t\tthis.audioPlayState = 'STOP';\n\t\t\t\t\tthis.$emit('audioStateChange', 'STOP', this.msgInfo);\n\t\t\t\t});\n\t\t\t\tthis.innerAudioContext.onError((res) => {\n\t\t\t\t\tthis.audioPlayState = 'STOP';\n\t\t\t\t\tuni.__f__('log','at pagesChat/components/chat-message-item/chat-message-item.vue:248',res.errMsg);\n\t\t\t\t\tuni.__f__('log','at pagesChat/components/chat-message-item/chat-message-item.vue:249',res.errCode);\n\t\t\t\t\tthis.$emit('audioStateChange', 'STOP', this.msgInfo);\n\t\t\t\t});\n\t\t\t\tthis.innerAudioContext.onStop(() => {\n\t\t\t\t\tthis.audioPlayState = 'STOP';\n\t\t\t\t\tthis.$emit('audioStateChange', 'STOP', this.msgInfo);\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tuni.__f__('error','at pagesChat/components/chat-message-item/chat-message-item.vue:257','播放音频出错:', error);\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '音频格式错误',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonSelectMenu(item) {\n\t\t\tswitch (item.key) {\n\t\t\t\tcase 'COPY':\n\t\t\t\t\tthis.$emit('copy', this.msgInfo);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'DELETE':\n\t\t\t\t\tthis.$emit('delete', this.msgInfo);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'RECALL':\n\t\t\t\t\tthis.$emit('recall', this.msgInfo);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'DOWNLOAD':\n\t\t\t\t\tthis.$emit('download', this.msgInfo);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tonShowFullImage() {\n\t\t\ttry {\n\t\t\t\tif (!this.msgInfo.content) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '图片格式错误',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlet data = JSON.parse(this.msgInfo.content);\n\t\t\t\tlet imageUrl = data && data.originUrl ? data.originUrl : null;\n\t\t\t\t\n\t\t\t\tif (!imageUrl) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '图片地址错误',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tuni.previewImage({\n\t\t\t\t\turls: [imageUrl],\n\t\t\t\t\tcurrent: imageUrl\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tuni.__f__('error','at pagesChat/components/chat-message-item/chat-message-item.vue:308','预览图片出错:', error);\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '图片格式错误',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonShowReadedBox() {\n\t\t\tif (this.msgInfo.groupId) {\n\t\t\t\tthis.$refs.chatGroupReaded.open();\n\t\t\t}\n\t\t},\n\t\tstopPlayAudio() {\n\t\t\tif (this.innerAudioContext) {\n\t\t\t\tthis.innerAudioContext.stop();\n\t\t\t}\n\t\t\tthis.audioPlayState = 'STOP';\n\t\t},\n\t\tnodesText() {\n\t\t\tlet color = this.msgInfo.selfSend ? 'white' : '';\n\t\t\ttry {\n\t\t\t\tif (!this.msgInfo || !this.msgInfo.content) {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\tlet text = this.$url ? this.$url.replaceURLWithHTMLLinks(this.msgInfo.content, color) : this.msgInfo.content;\n\t\t\t\treturn this.$emo ? this.$emo.transform(text, 'emoji-normal') : text;\n\t\t\t} catch (error) {\n\t\t\t\tuni.__f__('error','at pagesChat/components/chat-message-item/chat-message-item.vue:335','处理消息内容出错:', error);\n\t\t\t\treturn this.msgInfo && this.msgInfo.content ? this.msgInfo.content : '';\n\t\t\t}\n\t\t}\n\t},\n\tcomputed: {\n\t\tloading() {\n\t\t\treturn this.msgInfo.loadStatus && this.msgInfo.loadStatus === \"loading\";\n\t\t},\n\t\tloadFail() {\n\t\t\treturn this.msgInfo.loadStatus && this.msgInfo.loadStatus === \"fail\";\n\t\t},\n\t\tdata() {\n\t\t\ttry {\n\t\t\t\tif (!this.msgInfo || !this.msgInfo.content) {\n\t\t\t\t\treturn { name: '无效内容', size: 0 };\n\t\t\t\t}\n\t\t\t\tconst parsed = JSON.parse(this.msgInfo.content);\n\t\t\t\treturn parsed || { name: '无效内容', size: 0 };\n\t\t\t} catch (error) {\n\t\t\t\tuni.__f__('error','at pagesChat/components/chat-message-item/chat-message-item.vue:355','解析消息内容出错:', error);\n\t\t\t\treturn { name: '无效内容', size: 0 };\n\t\t\t}\n\t\t},\n\t\tfileSize() {\n\t\t\tif (!this.data || typeof this.data.size === 'undefined') {\n\t\t\t\treturn '0B';\n\t\t\t}\n\t\t\t\n\t\t\tlet size = this.data.size;\n\t\t\t\n\t\t\tif (size > 1024 * 1024) {\n\t\t\t\treturn Math.round(size / 1024 / 1024) + \"M\";\n\t\t\t}\n\t\t\tif (size > 1024) {\n\t\t\t\treturn Math.round(size / 1024) + \"KB\";\n\t\t\t}\n\t\t\treturn size + \"B\";\n\t\t},\n\t\tmenuItems() {\n\t\t\tlet items = [];\n\t\t\tif (this.msgInfo.type == this.MESSAGE_TYPE.TEXT) {\n\t\t\t\titems.push({\n\t\t\t\t\tkey: 'COPY',\n\t\t\t\t\tname: '复制',\n\t\t\t\t\ticon: 'bars'\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this.msgInfo.selfSend && this.msgInfo.id > 0) {\n\t\t\t\titems.push({\n\t\t\t\t\tkey: 'RECALL',\n\t\t\t\t\tname: '撤回',\n\t\t\t\t\ticon: 'refreshempty'\n\t\t\t\t});\n\t\t\t}\n\t\t\titems.push({\n\t\t\t\tkey: 'DELETE',\n\t\t\t\tname: '删除',\n\t\t\t\ticon: 'trash',\n\t\t\t\tcolor: '#e64e4e'\n\t\t\t});\n\t\t\tif (this.msgInfo.type == this.MESSAGE_TYPE.FILE) {\n\t\t\t\titems.push({\n\t\t\t\t\tkey: 'DOWNLOAD',\n\t\t\t\t\tname: '下载并打开',\n\t\t\t\t\ticon: 'download'\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn items;\n\t\t},\n\t\tisAction() {\n\t\t\ttry {\n\t\t\t\tif (!this.msgInfo || typeof this.msgInfo.type === 'undefined') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn msgType.isAction(this.msgInfo.type);\n\t\t\t} catch (error) {\n\t\t\t\tuni.__f__('error','at pagesChat/components/chat-message-item/chat-message-item.vue:412','判断消息类型出错:', error);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tisNormal() {\n\t\t\ttry {\n\t\t\t\tif (!this.msgInfo || typeof this.msgInfo.type === 'undefined') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst type = this.msgInfo.type;\n\t\t\t\treturn msgType.isNormal(type) || msgType.isAction(type);\n\t\t\t} catch (error) {\n\t\t\t\tuni.__f__('error','at pagesChat/components/chat-message-item/chat-message-item.vue:424','判断消息类型出错:', error);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n}\n</script>\n\n<style scoped lang=\"scss\">\n.chat-msg-item {\n\tpadding: 2rpx 20rpx;\n\n\t.chat-msg-tip {\n\t\tline-height: 60rpx;\n\t\ttext-align: center;\n\t\tcolor: $im-text-color-lighter;\n\t\tfont-size: $im-font-size-smaller-extra;\n\t\tpadding: 10rpx;\n\t}\n\n\t.chat-msg-normal {\n\t\tposition: relative;\n\t\tmargin-bottom: 22rpx;\n\t\tpadding-left: 20rpx;\n\t\tmin-height: 80rpx;\n\t\tflex-direction: row;\n\n\t\t.avatar {\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t}\n\n\t\t.chat-msg-content {\n\t\t\ttext-align: left;\n\n\t\t\t.chat-msg-top {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-wrap: nowrap;\n\t\t\t\tcolor: $im-text-color-lighter;\n\t\t\t\tfont-size: $im-font-size-smaller;\n\t\t\t\tline-height: $im-font-size-smaller;\n\t\t\t\theight: $im-font-size-smaller;\n\t\t\t}\n\n\t\t\t.chat-msg-bottom {\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tpadding-right: 80rpx;\n\t\t\t\tmargin-top: 5rpx;\n\n\t\t\t\t.chat-msg-text {\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tline-height: 1.6;\n\t\t\t\t\tmargin-top: 10rpx;\n\t\t\t\t\tpadding: 16rpx 24rpx;\n\t\t\t\t\tbackground-color: $im-bg;\n\t\t\t\t\tborder-radius: 20rpx;\n\t\t\t\t\tcolor: $im-text-color;\n\t\t\t\t\tfont-size: $im-font-size;\n\t\t\t\t\ttext-align: left;\n\t\t\t\t\tdisplay: block;\n\t\t\t\t\tword-break: break-all;\n\t\t\t\t\twhite-space: pre-line;\n\n\n\t\t\t\t\t&:after {\n\t\t\t\t\t\tcontent: \"\";\n\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\tleft: -20rpx;\n\t\t\t\t\t\ttop: 26rpx;\n\t\t\t\t\t\twidth: 6rpx;\n\t\t\t\t\t\theight: 6rpx;\n\t\t\t\t\t\tborder-style: solid dashed dashed;\n\t\t\t\t\t\tborder-color: $im-bg transparent transparent;\n\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t\tborder-width: 18rpx;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\t.chat-msg-image {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-wrap: nowrap;\n\t\t\t\t\tflex-direction: row;\n\t\t\t\t\talign-items: center;\n\n\t\t\t\t\t.img-load-box {\n\t\t\t\t\t\tposition: relative;\n\n\t\t\t\t\t\t.send-image {\n\t\t\t\t\t\t\tmin-width: 200rpx;\n\t\t\t\t\t\t\tmax-width: 420rpx;\n\t\t\t\t\t\t\theight: 350rpx;\n\t\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\t\t\t\t\t.send-fail {\n\t\t\t\t\t\tcolor: $im-color-danger;\n\t\t\t\t\t\tfont-size: $im-font-size;\n\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t\tmargin: 0 20px;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.chat-msg-file {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-wrap: nowrap;\n\t\t\t\t\tflex-direction: row;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tcursor: pointer;\n\n\t\t\t\t\t.chat-file-box {\n\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-wrap: nowrap;\n\t\t\t\t\t\talign-items: center;\n\t\t\t\t\t\tmin-height: 60px;\n\t\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\t\tpadding: 10px 15px;\n\t\t\t\t\t\tbox-shadow: $im-box-shadow-dark;\n\n\t\t\t\t\t\t.chat-file-info {\n\t\t\t\t\t\t\tflex: 1;\n\t\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t\t\ttext-align: left;\n\t\t\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\t\t\twidth: 300rpx;\n\n\t\t\t\t\t\t\t.chat-file-name {\n\t\t\t\t\t\t\t\tfont-weight: 600;\n\t\t\t\t\t\t\t\tmargin-bottom: 15px;\n\t\t\t\t\t\t\t\tword-break: break-all;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t.chat-file-icon {\n\t\t\t\t\t\t\tfont-size: 80rpx;\n\t\t\t\t\t\t\tcolor: #d42e07;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t.send-fail {\n\t\t\t\t\t\tcolor: #e60c0c;\n\t\t\t\t\t\tfont-size: 50rpx;\n\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t\tmargin: 0 20rpx;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t.chat-msg-audio {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\n\t\t\t\t\t.chat-audio-text {\n\t\t\t\t\t\tpadding-right: 8px;\n\t\t\t\t\t}\n\n\t\t\t\t\t.icon-voice-play {\n\t\t\t\t\t\tfont-size: 18px;\n\t\t\t\t\t\tpadding-right: 8px;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.chat-realtime {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\n\t\t\t\t\t.iconfont {\n\t\t\t\t\t\tfont-size: 20px;\n\t\t\t\t\t\tpadding-right: 8px;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.chat-msg-status {\n\t\t\t\t\tline-height: $im-font-size-smaller-extra;\n\t\t\t\t\tfont-size: $im-font-size-smaller-extra;\n\t\t\t\t\tpadding-top: 2rpx;\n\n\t\t\t\t\t.chat-readed {\n\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t\tpadding-top: 2rpx;\n\t\t\t\t\t\tcolor: $im-text-color-lighter;\n\t\t\t\t\t}\n\n\t\t\t\t\t.chat-unread {\n\t\t\t\t\t\tcolor: $im-color-danger;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.chat-receipt {\n\t\t\t\t\tfont-size: $im-font-size-smaller;\n\t\t\t\t\tcolor: $im-text-color-lighter;\n\t\t\t\t\tfont-weight: 600;\n\n\t\t\t\t\t.icon-ok {\n\t\t\t\t\t\tfont-size: 20px;\n\t\t\t\t\t\tcolor: $im-color-success;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\t&.chat-msg-mine {\n\t\t\ttext-align: right;\n\t\t\tpadding-left: 0;\n\t\t\tpadding-right: 110rpx;\n\n\t\t\t.avatar {\n\t\t\t\tleft: auto;\n\t\t\t\tright: 0;\n\t\t\t}\n\n\t\t\t.chat-msg-content {\n\t\t\t\ttext-align: right;\n\n\t\t\t\t.chat-msg-bottom {\n\t\t\t\t\tpadding-left: 80rpx;\n\t\t\t\t\tpadding-right: 0;\n\n\t\t\t\t\t.chat-msg-text {\n\t\t\t\t\t\tmargin-left: 10px;\n\t\t\t\t\t\tbackground-color: $im-color-primary-light-2;\n\t\t\t\t\t\tcolor: #fff;\n\n\t\t\t\t\t\t&:after {\n\t\t\t\t\t\t\tleft: auto;\n\t\t\t\t\t\t\tright: -9px;\n\t\t\t\t\t\t\tborder-top-color: $im-color-primary-light-2;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t.chat-msg-image {\n\t\t\t\t\t\tflex-direction: row-reverse;\n\t\t\t\t\t}\n\n\t\t\t\t\t.chat-msg-file {\n\t\t\t\t\t\tflex-direction: row-reverse;\n\t\t\t\t\t}\n\n\t\t\t\t\t.chat-msg-audio {\n\t\t\t\t\t\tflex-direction: row-reverse;\n\n\t\t\t\t\t\t.chat-audio-text {\n\t\t\t\t\t\t\tpadding-right: 0;\n\t\t\t\t\t\t\tpadding-left: 8px;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t.icon-voice-play {\n\t\t\t\t\t\t\ttransform: rotateY(180deg);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t.chat-realtime {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: row-reverse;\n\n\t\t\t\t\t\t.iconfont {\n\t\t\t\t\t\t\ttransform: rotateY(180deg);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n}\n</style>","import Component from 'E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/pagesChat/components/chat-message-item/chat-message-item.vue'\nwx.createComponent(Component)"],"names":["HeadImage","LongPressMenu","Loading","ChatGroupReaded","_sfc_main","defineComponent","MESSAGE_TYPE","MESSAGE_STATUS","emoUtil","dateUtil","urlUtil","content","trimmed","uni","parsed","error","data","audioUrl","res","item","imageUrl","color","text","size","items","msgType.isAction","type","msgType.isNormal","Component"],"mappings":"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"}