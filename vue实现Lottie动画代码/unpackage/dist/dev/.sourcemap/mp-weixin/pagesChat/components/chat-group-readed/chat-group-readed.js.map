{"version":3,"file":"chat-group-readed.js","sources":["pagesChat/components/chat-group-readed/chat-group-readed.vue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTov56CU5biI5b2V5LiO5YW25LuW5Lq65YWx5Lqr5paH5Lu2L3RlYWNoZXJEaXJlY3RvcnkvdnVl5a6e546wTG90dGll5Yqo55S75Luj56CBL3BhZ2VzQ2hhdC9jb21wb25lbnRzL2NoYXQtZ3JvdXAtcmVhZGVkL2NoYXQtZ3JvdXAtcmVhZGVkLnZ1ZQ"],"sourcesContent":["<template>\n\t<uni-popup ref=\"popup\" type=\"bottom\">\n\t\t<view class=\"chat-group-readed\">\n\t\t\t<view class=\"uni-padding-wrap uni-common-mt\">\n\t\t\t\t<uni-segmented-control :current=\"current\" :values=\"items\" style-type=\"button\"\n\t\t\t\t\t@clickItem=\"onClickItem\" />\n\t\t\t</view>\n\t\t\t<view class=\"content\">\n\t\t\t\t<view v-if=\"current === 0\">\n\t\t\t\t\t<virtual-scroller :items=\"readedMembers\">\n\t\t\t\t\t\t<template v-slot=\"{ item }\">\n\t\t\t\t\t\t\t<view class=\"member-item\">\n\t\t\t\t\t\t\t\t<head-image :name=\"item.showNickName\" :online=\"item.online\" :url=\"item.headImage\"\n\t\t\t\t\t\t\t\t\t:size=\"90\"></head-image>\n\t\t\t\t\t\t\t\t<view class=\"member-name\">{{ item.showNickName }}</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</virtual-scroller>\n\t\t\t\t</view>\n\t\t\t\t<view v-if=\"current === 1\">\n\t\t\t\t\t<virtual-scroller :items=\"unreadMembers\">\n\t\t\t\t\t\t<template v-slot=\"{ item }\">\n\t\t\t\t\t\t\t<view class=\"member-item\">\n\t\t\t\t\t\t\t\t<head-image :name=\"item.showNickName\" :online=\"item.online\" :url=\"item.headImage\"\n\t\t\t\t\t\t\t\t\t:size=\"90\"></head-image>\n\t\t\t\t\t\t\t\t<view class=\"member-name\">{{ item.showNickName }}</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</virtual-scroller>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</uni-popup>\n</template>\n\n<script lang=\"uts\">\n// 直接引入store获取函数\nimport { getChatStore } from '/pagesChat/main.js';\nimport HeadImage from '/pagesChat/components/head-image/head-image';\nimport VirtualScroller from '/pagesChat/components/virtual-scroller/virtual-scroller';\n\nexport default {\n\tname: \"chat-group-readed\",\n\tcomponents: {\n\t\tHeadImage,\n\t\tVirtualScroller\n\t},\n\tdata() {\n\t\treturn {\n\t\t\titems: ['已读', '未读'],\n\t\t\tcurrent: 0,\n\t\t\treadedMembers: [],\n\t\t\tunreadMembers: [],\n\t\t\tchatStore: null\n\t\t};\n\t},\n\tprops: {\n\t\tmsgInfo: {\n\t\t\ttype: Object,\n\t\t\trequired: true\n\t\t},\n\t\tgroupMembers: {\n\t\t\ttype: Array\n\t\t}\n\t},\n\tcreated() {\n\t\t// 获取chatStore\n\t\ttry {\n\t\t\tthis.chatStore = getChatStore();\n\t\t\t\n\t\t\t// 如果仍然无法获取，则尝试从globalProperties中获取\n\t\t\tif (!this.chatStore && this.$) {\n\t\t\t\tthis.chatStore = this.$chatStore;\n\t\t\t}\n\t\t\t\n\t\t\t// 如果仍然无法获取，创建一个模拟对象\n\t\t\tif (!this.chatStore) {\n\t\t\t\tthis.chatStore = {\n\t\t\t\t\tupdateMessage: (msgInfo, chatInfo) => {\n\t\t\t\t\t\tuni.__f__('log','at pagesChat/components/chat-group-readed/chat-group-readed.vue:80','使用模拟updateMessage:', msgInfo, chatInfo);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tuni.__f__('error','at pagesChat/components/chat-group-readed/chat-group-readed.vue:85','获取chatStore失败:', error);\n\t\t\t// 创建一个模拟对象\n\t\t\tthis.chatStore = {\n\t\t\t\tupdateMessage: (msgInfo, chatInfo) => {\n\t\t\t\t\tuni.__f__('log','at pagesChat/components/chat-group-readed/chat-group-readed.vue:89','使用模拟updateMessage:', msgInfo, chatInfo);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\topen() {\n\t\t\tthis.$refs.popup.open();\n\t\t\tthis.loadReadedUser();\n\t\t},\n\t\tloadReadedUser() {\n\t\t\tthis.readedMembers = [];\n\t\t\tthis.unreadMembers = [];\n\t\t\tthis.$http({\n\t\t\t\turl: `/message/group/findReadedUsers?groupId=${this.msgInfo.groupId}&messageId=${this.msgInfo.id}`,\n\t\t\t\tmethod: 'Get'\n\t\t\t}).then(userIds => {\n\t\t\t\tthis.groupMembers.forEach(member => {\n\t\t\t\t\t// 发送者和已退群的不显示\n\t\t\t\t\tif (member.userId == this.msgInfo.sendId || member.quit) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// 区分已读还是未读\n\t\t\t\t\tif (userIds.find(userId => member.userId == userId)) {\n\t\t\t\t\t\tthis.readedMembers.push(member);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.unreadMembers.push(member);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tthis.items[0] = `已读(${this.readedMembers.length})`;\n\t\t\t\tthis.items[1] = `未读(${this.unreadMembers.length})`;\n\n\t\t\t\tlet chatInfo = {\n\t\t\t\t\ttype: 'GROUP',\n\t\t\t\t\ttargetId: this.msgInfo.groupId\n\t\t\t\t}\n\t\t\t\tlet msgInfo = {\n\t\t\t\t\tid: this.msgInfo.id,\n\t\t\t\t\tgroupId: this.msgInfo.groupId,\n\t\t\t\t\treadedCount: this.readedMembers.length\n\t\t\t\t}\n\t\t\t\t// 更新已读人数\n\t\t\t\tthis.chatStore.updateMessage(msgInfo, chatInfo)\n\t\t\t})\n\t\t},\n\t\tonClickItem(e) {\n\t\t\tthis.current = e.currentIndex;\n\t\t}\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.chat-group-readed {\n\tposition: relative;\n\tdisplay: flex;\n\tflex-direction: column;\n\tbackground-color: white;\n\tpadding: 10rpx;\n\n\t.member-item {\n\t\theight: 120rpx;\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\tpadding: 0 30rpx;\n\t\talign-items: center;\n\t\tbackground-color: white;\n\t\twhite-space: nowrap;\n\n\t\t.member-name {\n\t\t\tflex: 1;\n\t\t\tpadding-left: 20rpx;\n\t\t\tfont-size: 30rpx;\n\t\t\tfont-weight: 600;\n\t\t\tline-height: 60rpx;\n\t\t\twhite-space: nowrap;\n\t\t\toverflow: hidden;\n\t\t}\n\t}\n\n\n}\n</style>","import Component from 'E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/pagesChat/components/chat-group-readed/chat-group-readed.vue'\nwx.createComponent(Component)"],"names":["HeadImage","VirtualScroller","_sfc_main","defineComponent","getChatStore","msgInfo","chatInfo","uni","error","userIds","member","userId","e","Component"],"mappings":"qFAsCOA,EAAe,IAAA,8BACfC,EAAqB,IAAA,0CAE5BC,EAAeC,kBAAA,CACd,KAAM,oBACN,WAAY,CACX,UAAAH,EACA,gBAAAC,CACA,EACD,MAAI,CACH,MAAO,CACN,MAAO,CAAC,KAAM,IAAI,EAClB,QAAS,EACT,cAAe,CAAE,EACjB,cAAe,CAAE,EACjB,UAAW,KAEZ,EACD,MAAO,CACN,QAAS,CACR,KAAM,OACN,SAAU,EACV,EACD,aAAc,CACb,KAAM,KACP,CACA,EACD,SAAO,CAEN,GAAI,CACH,KAAK,UAAYG,EAAAA,eAGb,CAAC,KAAK,WAAa,KAAK,IAC3B,KAAK,UAAY,KAAK,YAIlB,KAAK,YACT,KAAK,UAAY,CAChB,cAAe,CAACC,EAAO,KAAEC,EAAQ,OAAA,CAChCC,EAAG,MAAC,MAAM,MAAM,qEAAqE,qBAAsBF,EAASC,CAAQ,CAC7H,GAGD,OAAOE,EAAO,CACfD,EAAG,MAAC,MAAM,QAAQ,qEAAqE,iBAAkBC,CAAK,EAE9G,KAAK,UAAY,CAChB,cAAe,CAACH,EAAO,KAAEC,EAAQ,OAAA,CAChCC,EAAG,MAAC,MAAM,MAAM,qEAAqE,qBAAsBF,EAASC,CAAQ,CAC7H,EAEF,CACA,EACD,QAAS,CACR,MAAI,CACH,KAAK,MAAM,MAAM,OACjB,KAAK,eAAc,CACnB,EACD,gBAAc,CACb,KAAK,cAAgB,GACrB,KAAK,cAAgB,GACrB,KAAK,MAAM,IAAA,cAAA,CACV,IAAK,0CAA0C,KAAK,QAAQ,OAAO,cAAc,KAAK,QAAQ,EAAE,GAChG,OAAQ,KACR,CAAA,CAAA,EAAE,KAAK,CAAAG,EAAM,OAAA,CACb,KAAK,aAAa,QAAQ,CAAAC,EAAK,OAAA,CAE9B,GAAIA,EAAO,QAAU,KAAK,QAAQ,QAAUA,EAAO,KAClD,OAAM,KAGHD,EAAQ,KAAK,CAAAE,EAAO,OAAGD,EAAO,QAAUC,CAAM,EACjD,KAAK,cAAc,KAAKD,CAAM,EAE9B,KAAK,cAAc,KAAKA,CAAM,CAEhC,CAAC,EACD,KAAK,MAAM,CAAC,EAAI,MAAM,KAAK,cAAc,MAAM,IAC/C,KAAK,MAAM,CAAC,EAAI,MAAM,KAAK,cAAc,MAAM,IAE/C,IAAIJ,EAAW,IAAA,cAAA,CACd,KAAM,QACN,SAAU,KAAK,QAAQ,OACxB,CAAA,EACID,EAAU,IAAA,cAAA,CACb,GAAI,KAAK,QAAQ,GACjB,QAAS,KAAK,QAAQ,QACtB,YAAa,KAAK,cAAc,MACjC,GAEA,KAAK,UAAU,cAAcA,EAASC,CAAQ,CAC/C,CAAC,CACD,EACD,YAAYM,EAAC,KAAA,CACZ,KAAK,QAAUA,EAAE,YAClB,CACD,EACD,6rCCxIA,GAAG,gBAAgBC,CAAS"}