{"version":3,"file":"actions.js","sources":["store/user/money/actions.js"],"sourcesContent":["/**\r\n * money模块的actions\r\n * @module store/user/money/actions\r\n */\r\n\r\nimport { getBalanceAPI, withdrawAPI } from '../APIroute/money_api';\r\n\r\nexport default {\r\n    /**\r\n     * 获取用户余额\r\n     * @param {Object} context - Vuex的上下文对象\r\n     * @param {Function} context.commit - commit函数\r\n     * @param {Object} context.rootState - 根state对象\r\n     */\r\n    async fetchBalance({ commit, rootState }) {\r\n        try {\r\n            const userId = rootState.user.baseInfo.id; // 从根state获取用户ID\r\n            const res = await getBalanceAPI(userId); // 传递用户ID\r\n            if (res.code === 200) {\r\n                commit('SET_BALANCE', res.data.balance);\r\n            } else {\r\n                throw new Error(res.message || '获取余额失败');\r\n            }\r\n        } catch (err) {\r\n            console.error('fetchBalance error:', err);\r\n            throw err;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 提交提现请求\r\n     * @param {Object} context - Vuex的上下文对象\r\n     * @param {Function} context.commit - commit函数\r\n     * @param {Object} context.state - 当前模块的state\r\n     * @param {Object} context.rootState - 根state对象\r\n     */\r\n    async submitWithdraw({ commit, state, rootState }) {\r\n        try {\r\n            const userId = rootState.user.baseInfo.id; // 从根state获取用户ID\r\n            const payload = {\r\n                userId, // 添加用户ID\r\n                amount: state.withdrawAmount,\r\n                method: state.withdrawMethod\r\n            };\r\n            const res = await withdrawAPI(payload);\r\n            if (res.code === 200) {\r\n                // 后端返回新的余额\r\n                commit('SET_BALANCE', res.data.newBalance);\r\n                return res;\r\n            } else {\r\n                throw new Error(res.message || '提现失败');\r\n            }\r\n        } catch (err) {\r\n            console.error('submitWithdraw error:', err);\r\n            throw err;\r\n        }\r\n    }\r\n}; "],"names":["actions","commit","rootState","userId","res","getBalanceAPI","err","uni","state","payload","withdrawAPI"],"mappings":"gGAOeA,EAAA,CAOX,MAAM,aAAa,CAAE,OAAAC,EAAQ,UAAAC,GAAa,CACtC,GAAI,CACA,MAAMC,EAASD,EAAU,KAAK,SAAS,GACjCE,EAAM,MAAMC,gBAAcF,CAAM,EACtC,GAAIC,EAAI,OAAS,IACbH,EAAO,cAAeG,EAAI,KAAK,OAAO,MAEtC,OAAM,IAAI,MAAMA,EAAI,SAAW,QAAQ,CAE9C,OAAQE,EAAK,CACVC,MAAAA,0DAAc,sBAAuBD,CAAG,EAClCA,CACT,CACJ,EASD,MAAM,eAAe,CAAE,OAAAL,EAAQ,MAAAO,EAAO,UAAAN,CAAS,EAAI,CAC/C,GAAI,CAEA,MAAMO,EAAU,CACZ,OAFWP,EAAU,KAAK,SAAS,GAGnC,OAAQM,EAAM,eACd,OAAQA,EAAM,cAC9B,EACkBJ,EAAM,MAAMM,cAAYD,CAAO,EACrC,GAAIL,EAAI,OAAS,IAEb,OAAAH,EAAO,cAAeG,EAAI,KAAK,UAAU,EAClCA,EAEP,MAAM,IAAI,MAAMA,EAAI,SAAW,MAAM,CAE5C,OAAQE,EAAK,CACVC,MAAAA,EAAA,MAAA,MAAA,QAAA,oCAAc,wBAAyBD,CAAG,EACpCA,CACT,CACJ,CACL"}