{"version":3,"file":"actions.js","sources":["store/user/money/actions.js"],"sourcesContent":["/**\r\n * money模块的actions\r\n * @module store/user/money/actions\r\n */\r\n\r\nimport { getBalanceAPI, withdrawAPI } from '../APIroute/money_api';\r\n\r\nexport default {\r\n    /**\r\n     * 获取用户余额\r\n     * @param {Object} context - Vuex的上下文对象\r\n     * @param {Function} context.commit - commit函数\r\n     * @param {Object} context.rootState - 根state对象\r\n     */\r\n    async fetchBalance({ commit, rootState }) {\r\n        try {\r\n            const userId = rootState.user.baseInfo.id; // 从根state获取用户ID\r\n            const res = await getBalanceAPI(userId); // 传递用户ID\r\n            if (res.code === 200) {\r\n                commit('SET_BALANCE', res.data.balance);\r\n            } else {\r\n                throw new Error(res.message || '获取余额失败');\r\n            }\r\n        } catch (err) {\r\n            console.error('fetchBalance error:', err);\r\n            throw err;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 提交提现请求\r\n     * @param {Object} context - Vuex的上下文对象\r\n     * @param {Function} context.commit - commit函数\r\n     * @param {Object} context.state - 当前模块的state\r\n     * @param {Object} context.rootState - 根state对象\r\n     */\r\n    async submitWithdraw({ commit, state, rootState }) {\r\n        try {\r\n            const userId = rootState.user.baseInfo.id; // 从根state获取用户ID\r\n            const payload = {\r\n                userId, // 添加用户ID\r\n                amount: state.withdrawAmount,\r\n                method: state.withdrawMethod\r\n            };\r\n            const res = await withdrawAPI(payload);\r\n            if (res.code === 200) {\r\n                // 后端返回新的余额\r\n                commit('SET_BALANCE', res.data.newBalance);\r\n                return res;\r\n            } else {\r\n                throw new Error(res.message || '提现失败');\r\n            }\r\n        } catch (err) {\r\n            console.error('submitWithdraw error:', err);\r\n            throw err;\r\n        }\r\n    }\r\n}; "],"names":["getBalanceAPI","uni","withdrawAPI"],"mappings":";;;AAOA,MAAe,UAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOX,MAAM,aAAa,EAAE,QAAQ,aAAa;AACtC,QAAI;AACA,YAAM,SAAS,UAAU,KAAK,SAAS;AACvC,YAAM,MAAM,MAAMA,4CAAc,MAAM;AACtC,UAAI,IAAI,SAAS,KAAK;AAClB,eAAO,eAAe,IAAI,KAAK,OAAO;AAAA,MACtD,OAAmB;AACH,cAAM,IAAI,MAAM,IAAI,WAAW,QAAQ;AAAA,MAC1C;AAAA,IACJ,SAAQ,KAAK;AACVC,8EAAc,uBAAuB,GAAG;AACxC,YAAM;AAAA,IACT;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASD,MAAM,eAAe,EAAE,QAAQ,OAAO,UAAS,GAAI;AAC/C,QAAI;AACA,YAAM,SAAS,UAAU,KAAK,SAAS;AACvC,YAAM,UAAU;AAAA,QACZ;AAAA;AAAA,QACA,QAAQ,MAAM;AAAA,QACd,QAAQ,MAAM;AAAA,MAC9B;AACY,YAAM,MAAM,MAAMC,0CAAY,OAAO;AACrC,UAAI,IAAI,SAAS,KAAK;AAElB,eAAO,eAAe,IAAI,KAAK,UAAU;AACzC,eAAO;AAAA,MACvB,OAAmB;AACH,cAAM,IAAI,MAAM,IAAI,WAAW,MAAM;AAAA,MACxC;AAAA,IACJ,SAAQ,KAAK;AACVD,oBAAA,MAAA,MAAA,SAAA,qCAAc,yBAAyB,GAAG;AAC1C,YAAM;AAAA,IACT;AAAA,EACJ;AACL;;"}