{"version":3,"file":"actions.js","sources":["store/user/match/actions.js"],"sourcesContent":["/**\r\n * match模块的actions\r\n * @module store/user/match/actions\r\n */\r\n\r\nimport { getMatchTeacherList, getTeacherDetail } from '../APIroute/match_api/match_api.js';\r\n\r\n/**\r\n * 获取匹配的老师列表\r\n * @param {Object} context - Vuex上下文对象\r\n * @param {Object} payload - 请求参数\r\n * @param {boolean} [payload.loadMore=false] - 是否加载更多数据\r\n * @returns {Promise} 返回匹配的老师列表结果\r\n */\r\nexport const fetchMatchTeacherList = ({ commit, rootState, state }, payload = {}) => {\r\n  // 从根state获取用户ID\r\n  const userId = rootState.user.baseInfo.id;\r\n  \r\n  // 判断是加载更多还是重新加载第一页\r\n  const isLoadMore = payload.loadMore === true;\r\n  \r\n  // 如果是加载更多，则页码加1，否则重置为第1页\r\n  const currentPage = isLoadMore ? state.currentPage + 1 : 1;\r\n  \r\n  // 构建请求参数\r\n  const params = {\r\n    userId: userId,\r\n    schoolList: payload.schoolList || state.schoolList,\r\n    professionalList: payload.professionalList || state.professionalList,\r\n    nonProfessionalList: payload.nonProfessionalList || state.nonProfessionalList,\r\n    sortMode: payload.sortMode || state.sortMode,\r\n    currentPage: currentPage,\r\n    pageSize: payload.pageSize || state.pageSize\r\n  };\r\n  \r\n  return new Promise((resolve, reject) => {\r\n    getMatchTeacherList(params)\r\n      .then(response => {\r\n        // 更新matchList\r\n        if (response && response.data) {\r\n          if (isLoadMore) {\r\n            // 加载更多时，追加到现有列表\r\n            commit('APPEND_MATCH_LIST', response.data);\r\n          } else {\r\n            // 重新加载时，替换列表\r\n            commit('SET_MATCH_LIST', response.data);\r\n          }\r\n          \r\n          // 更新分页信息\r\n          commit('SET_PAGINATION', {\r\n            currentPage: currentPage,\r\n            hasMore: response.hasMore || false\r\n          });\r\n        }\r\n        resolve(response);\r\n      })\r\n      .catch(error => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\n/**\r\n * 获取老师详细信息\r\n * @param {Object} context - Vuex上下文对象\r\n * @param {Object} payload - 请求参数\r\n * @param {string} payload.teacherId - 老师ID\r\n * @returns {Promise} 返回老师详细信息\r\n */\r\nexport const fetchTeacherDetail = ({ commit, rootState }, { teacherId }) => {\r\n  // 从根state获取用户ID\r\n  const userId = rootState.user.baseInfo.id;\r\n  \r\n  if (!teacherId) {\r\n    return Promise.reject(new Error('老师ID不能为空'));\r\n  }\r\n  \r\n  // 构建请求参数\r\n  const params = {\r\n    userId: userId,\r\n    teacherId: teacherId\r\n  };\r\n  \r\n  return new Promise((resolve, reject) => {\r\n    getTeacherDetail(params)\r\n      .then(response => {\r\n        // 更新老师详情\r\n        if (response && response.data) {\r\n          commit('SET_TEACHER_DETAIL', {\r\n            teacherId: teacherId,\r\n            detail: response.data\r\n          });\r\n        }\r\n        resolve(response);\r\n      })\r\n      .catch(error => {\r\n        reject(error);\r\n      });\r\n  });\r\n};\r\n\r\nexport default {\r\n  fetchMatchTeacherList,\r\n  fetchTeacherDetail\r\n};\r\n"],"names":["fetchMatchTeacherList","commit","rootState","state","payload","userId","isLoadMore","currentPage","params","resolve","reject","getMatchTeacherList","response","error","fetchTeacherDetail","teacherId","getTeacherDetail","actions"],"mappings":"mEAcaA,EAAwB,CAAC,CAAE,OAAAC,EAAQ,UAAAC,EAAW,MAAAC,CAAO,EAAEC,EAAU,KAAO,CAEnF,MAAMC,EAASH,EAAU,KAAK,SAAS,GAGjCI,EAAaF,EAAQ,WAAa,GAGlCG,EAAcD,EAAaH,EAAM,YAAc,EAAI,EAGnDK,EAAS,CACb,OAAQH,EACR,WAAYD,EAAQ,YAAcD,EAAM,WACxC,iBAAkBC,EAAQ,kBAAoBD,EAAM,iBACpD,oBAAqBC,EAAQ,qBAAuBD,EAAM,oBAC1D,SAAUC,EAAQ,UAAYD,EAAM,SACpC,YAAaI,EACb,SAAUH,EAAQ,UAAYD,EAAM,QACxC,EAEE,OAAO,IAAI,QAAQ,CAACM,EAASC,IAAW,CACtCC,EAAAA,oBAAoBH,CAAM,EACvB,KAAKI,GAAY,CAEZA,GAAYA,EAAS,OAGrBX,EAFEK,EAEK,oBAGA,iBAHqBM,EAAS,IAAI,EAO3CX,EAAO,iBAAkB,CACvB,YAAaM,EACb,QAASK,EAAS,SAAW,EACzC,CAAW,GAEHH,EAAQG,CAAQ,CACxB,CAAO,EACA,MAAMC,GAAS,CACdH,EAAOG,CAAK,CACpB,CAAO,CACP,CAAG,CACH,EASaC,EAAqB,CAAC,CAAE,OAAAb,EAAQ,UAAAC,CAAS,EAAI,CAAE,UAAAa,CAAS,IAAO,CAE1E,MAAMV,EAASH,EAAU,KAAK,SAAS,GAEvC,GAAI,CAACa,EACH,OAAO,QAAQ,OAAO,IAAI,MAAM,UAAU,CAAC,EAI7C,MAAMP,EAAS,CACb,OAAQH,EACR,UAAWU,CACf,EAEE,OAAO,IAAI,QAAQ,CAACN,EAASC,IAAW,CACtCM,EAAAA,iBAAiBR,CAAM,EACpB,KAAKI,GAAY,CAEZA,GAAYA,EAAS,MACvBX,EAAO,qBAAsB,CAC3B,UAAWc,EACX,OAAQH,EAAS,IAC7B,CAAW,EAEHH,EAAQG,CAAQ,CACxB,CAAO,EACA,MAAMC,GAAS,CACdH,EAAOG,CAAK,CACpB,CAAO,CACP,CAAG,CACH,EAEeI,EAAA,CACb,sBAAAjB,EACA,mBAAAc,CACF"}