{"version":3,"file":"index.js","sources":["store/user/ai-chat/index.js"],"sourcesContent":["/**\r\n * ai-chat模块的入口文件\r\n * @module store/user/ai-chat\r\n */\r\n\r\nimport state from './state';\r\nimport mutations from './mutations';\r\nimport actions from './actions';\r\nimport getters from './getters';\r\nimport * as constants from './constants';\r\nimport { mockApiResponse } from './mock-data';\r\n\r\nexport default {\r\n    namespaced: true,\r\n    state,\r\n    mutations,\r\n    actions,\r\n    getters\r\n};\r\n\r\nexport { constants };\r\n\r\n/**\r\n * 保存聊天会话摘要\r\n */\r\nactions.saveChat = ({ commit, state }, chatData) => {\r\n  return new Promise((resolve) => {\r\n    try {\r\n      // 创建/更新会话记录\r\n      let chats = [...state.historyChats];\r\n      const existingChatIndex = chats.findIndex(chat => chat.id === chatData.id);\r\n      \r\n      if (existingChatIndex >= 0) {\r\n        // 更新现有会话\r\n        chats[existingChatIndex] = {\r\n          ...chats[existingChatIndex],\r\n          title: chatData.title,\r\n          abstract: chatData.abstract || chatData.title, // 确保abstract字段存在\r\n          updatedAt: new Date()\r\n        };\r\n      } else {\r\n        // 添加新会话\r\n        chats.unshift({\r\n          id: chatData.id,\r\n          title: chatData.title,\r\n          abstract: chatData.abstract || chatData.title, // 确保abstract字段存在\r\n          createdAt: new Date(),\r\n          updatedAt: new Date()\r\n        });\r\n      }\r\n      \r\n      commit('setHistoryChats', chats);\r\n      \r\n      // 模拟API请求\r\n      setTimeout(() => {\r\n        resolve(mockApiResponse(true, { success: true }));\r\n      }, 100);\r\n    } catch (error) {\r\n      console.error('保存聊天摘要失败:', error);\r\n      resolve(mockApiResponse(false, null, { message: '保存聊天摘要失败' }));\r\n    }\r\n  });\r\n}; "],"names":["state","mutations","actions","getters","mockApiResponse","uni"],"mappings":";;;;;;;AAYA,MAAe,SAAA;AAAA,EACX,YAAY;AAAA,EAChB,OAAIA,wBAAK;AAAA,EACT,WAAIC,4BAAS;AAAA,EACb,SAAIC,0BAAO;AAAA,EACX,SAAIC,0BAAO;AACX;AAOAD,0BAAO,QAAC,WAAW,CAAC,EAAE,QAAQ,MAAK,GAAI,aAAa;AAClD,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,QAAI;AAEF,UAAI,QAAQ,CAAC,GAAG,MAAM,YAAY;AAClC,YAAM,oBAAoB,MAAM,UAAU,UAAQ,KAAK,OAAO,SAAS,EAAE;AAEzE,UAAI,qBAAqB,GAAG;AAE1B,cAAM,iBAAiB,IAAI;AAAA,UACzB,GAAG,MAAM,iBAAiB;AAAA,UAC1B,OAAO,SAAS;AAAA,UAChB,UAAU,SAAS,YAAY,SAAS;AAAA;AAAA,UACxC,WAAW,oBAAI,KAAM;AAAA,QAC/B;AAAA,MACA,OAAa;AAEL,cAAM,QAAQ;AAAA,UACZ,IAAI,SAAS;AAAA,UACb,OAAO,SAAS;AAAA,UAChB,UAAU,SAAS,YAAY,SAAS;AAAA;AAAA,UACxC,WAAW,oBAAI,KAAM;AAAA,UACrB,WAAW,oBAAI,KAAM;AAAA,QAC/B,CAAS;AAAA,MACF;AAED,aAAO,mBAAmB,KAAK;AAG/B,iBAAW,MAAM;AACf,gBAAQE,2BAAe,gBAAC,MAAM,EAAE,SAAS,KAAM,CAAA,CAAC;AAAA,MACjD,GAAE,GAAG;AAAA,IACP,SAAQ,OAAO;AACdC,oBAAc,MAAA,MAAA,SAAA,qCAAA,aAAa,KAAK;AAChC,cAAQD,2BAAe,gBAAC,OAAO,MAAM,EAAE,SAAS,WAAY,CAAA,CAAC;AAAA,IAC9D;AAAA,EACL,CAAG;AACH;;"}