{"version":3,"file":"actions.js","sources":["store/user/ai-chat/actions.js"],"sourcesContent":["/**\n * ai-chatæ¨¡å—çš„actions\n * @module store/user/ai-chat/actions\n */\n\n// å¯¼å…¥JWTå·¥å…·\nimport { apiRequest, getCurrentToken } from '../JWT.js';\nimport { useGlobalStore } from '../../global.js';\nconst getApiPrefix = () => {\n    const globalStore = useGlobalStore()\n    return globalStore.apiBaseUrl\n}\n\n// const API_BASE_URL = 'http://v8e5bd5f.natappfree.cc';\n// const API_BASE_URL = 'http://47.109.207.44:8088';\n\nexport default {\n    /**\n     * è®¾ç½®å½“å‰æ´»è·ƒçš„èŠå¤©ä¼šè¯\n     * @param {Object} context - Vuexä¸Šä¸‹æ–‡\n     * @param {string} chatId - èŠå¤©ä¼šè¯ID\n     */\n    setCurrentChat({ commit }, chatId) {\n        commit('UPDATE_CURRENT_CONVERSATION', chatId);\n    },\n    \n    /**\n     * å‘é€é—®é¢˜åˆ°AIå¹¶è·å–å›ç­”\n     * @param {Object} context - Vuexä¸Šä¸‹æ–‡\n     * @param {Object} payload - è¯·æ±‚æ•°æ®\n     * @param {string} payload.content - ç”¨æˆ·é—®é¢˜å†…å®¹\n     * @param {string} [payload.topic] - èŠå¤©ä¸»é¢˜ï¼Œå¯é€‰\n     * @param {boolean} [payload.skipUserMessage] - æ˜¯å¦è·³è¿‡æ·»åŠ ç”¨æˆ·æ¶ˆæ¯ï¼ˆç”¨äºé‡è¯•åœºæ™¯ï¼‰\n     * @param {Function} [payload.onMessage] - æ¥æ”¶æ¶ˆæ¯çš„å›è°ƒå‡½æ•°\n     * @param {Function} [payload.onComplete] - å®Œæˆçš„å›è°ƒå‡½æ•°\n     * @param {Function} [payload.onError] - é”™è¯¯å¤„ç†å›è°ƒå‡½æ•°\n     * @returns {Promise<Object>} è¿”å›è¯·æ±‚ç»“æœ\n     */\n    async sendQuestion({ commit, state, rootState }, payload) {\n        try {\n            let userMessage = null;\n            let aiMessageId = null;\n            let aiMessage = null;\n            let isNewConversation = !state.aiChat.activeConversation;\n            \n            // æ„å»ºè¯·æ±‚æ•°æ® - ç¡®ä¿conversationIdä¸ºæ•°å­—æˆ–null\n            let conversationIdToSend = null;\n            if (state.aiChat.activeConversation) {\n                // å¦‚æœconversationIdæ˜¯æ•°å­—å­—ç¬¦ä¸²ï¼Œè½¬æ¢ä¸ºæ•°å­—\n                const activeId = state.aiChat.activeConversation;\n                if (/^\\d+$/.test(activeId)) {\n                    conversationIdToSend = parseInt(activeId, 10);\n                } else if (typeof activeId === 'number') {\n                    conversationIdToSend = activeId;\n                }\n            }\n            \n            // å¦‚æœæ˜¯ç»§ç»­å¯¹è¯ï¼ˆæœ‰conversationIdï¼‰ä¸”ä¸è·³è¿‡ç”¨æˆ·æ¶ˆæ¯ï¼Œå…ˆæ·»åŠ ç”¨æˆ·æ¶ˆæ¯\n            if (!isNewConversation && !payload.skipUserMessage) {\n                userMessage = {\n                    id: `msg-user-${Date.now()}`,\n                    role: 'user',\n                    content: payload.content,\n                    timestamp: new Date().toISOString(),\n                    status: 'sent'\n                };\n                \n                // ç«‹å³æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°å½“å‰å¯¹è¯\n                commit('ADD_MESSAGE_TO_CURRENT_CONVERSATION', userMessage);\n                \n                console.log('âœ… å·²æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°å†å²å¯¹è¯:', userMessage.id);\n            }\n            \n            const requestData = {\n                category: 'DOU_BAO_CHAT',\n                timestamp: new Date().getTime(),\n                payload: {\n                    content: payload.content,\n                    topic: state.aiChat.chatMode,\n                    school: rootState.user.schoolMajorRequest.undergraduateSchoolSearch.selectedSchool,\n                    major: rootState.user.schoolMajorRequest.undergraduateMajorSearch.selectedMajor,\n                    conversationId: conversationIdToSend\n                }\n            };\n\n            console.log('=== AIèŠå¤©å‘é€æ•°æ® ===');\n            console.log('åŸå§‹activeConversation:', state.aiChat.activeConversation);\n            console.log('å¤„ç†åçš„conversationId:', conversationIdToSend);\n            console.log('æ˜¯å¦ä¸ºæ–°å¯¹è¯:', conversationIdToSend === null ? 'æ˜¯' : 'å¦');\n            console.log('æ˜¯å¦è·³è¿‡ç”¨æˆ·æ¶ˆæ¯:', payload.skipUserMessage);\n            console.log('å®Œæ•´è¯·æ±‚æ•°æ®:', JSON.stringify(requestData, null, 2));\n            console.log('==================');\n            \n            // ä½¿ç”¨WebSocketè¿æ¥å‘é€æ¶ˆæ¯\n            const token = getCurrentToken();\n            const wsUrl = `ws://v8e5bd5f.natappfree.cc/websocket/message?token=${token}`;\n            // const wsUrl = `ws://47.109.207.44:8088/websocket/message?token=${token}`;\n            \n            const response = await new Promise((resolve, reject) => {\n                // ä½¿ç”¨uni-appçš„WebSocket API\n                const socketTask = uni.connectSocket({\n                    url: wsUrl,\n                    success: () => {\n                        console.log('WebSocketè¿æ¥è¯·æ±‚å·²å‘é€');\n                    },\n                    fail: (error) => {\n                        console.error('WebSocketè¿æ¥å¤±è´¥:', error);\n                        reject(new Error('WebSocketè¿æ¥å¤±è´¥'));\n                    }\n                });\n                \n                // æµå¼ä¼ è¾“ç›¸å…³å˜é‡\n                let streamContent = '';\n                let conversationId = conversationIdToSend; // åˆå§‹åŒ–ä¸ºå½“å‰å¯¹è¯ID\n                let messageCount = 0;\n                let isStreamComplete = false;\n                let isConversationCreated = false; // æ ‡è®°å¯¹è¯æ˜¯å¦å·²åˆ›å»º\n                \n                // è¿æ¥æ‰“å¼€\n                socketTask.onOpen(() => {\n                    console.log('WebSocketè¿æ¥å·²å»ºç«‹');\n                    // å‘é€è¯·æ±‚æ•°æ®\n                    socketTask.send({\n                        data: JSON.stringify(requestData),\n                        success: () => {\n                            console.log('æ•°æ®å‘é€æˆåŠŸ');\n                        },\n                        fail: (error) => {\n                            console.error('æ•°æ®å‘é€å¤±è´¥:', error);\n                            reject(new Error('æ•°æ®å‘é€å¤±è´¥'));\n                        }\n                    });\n                });\n                \n                // æ¥æ”¶æ¶ˆæ¯ - æµå¼å¤„ç†\n                socketTask.onMessage((event) => {\n                    try {\n                        console.log('=== æµå¼æ¶ˆæ¯ ===');\n                        console.log('åŸå§‹æ•°æ®:', event.data);\n                        \n                        // æ£€æŸ¥æ¶ˆæ¯æ˜¯å¦ä¸ºç©ºæˆ–æ— æ•ˆ\n                        if (!event.data) {\n                            console.warn('æ”¶åˆ°ç©ºæ¶ˆæ¯');\n                            return;\n                        }\n                        \n                        let data;\n                        \n                        // å°è¯•è§£æJSONæ¶ˆæ¯\n                        if (typeof event.data === 'string') {\n                            try {\n                                data = JSON.parse(event.data);\n                            } catch (parseError) {\n                                console.warn('æ¶ˆæ¯ä¸æ˜¯æœ‰æ•ˆçš„JSONæ ¼å¼ï¼Œå°è¯•ç›´æ¥ä½¿ç”¨:', event.data);\n                                data = {\n                                    content: event.data,\n                                    message: event.data,\n                                    category: 'DOU_BAO_CHAT'\n                                };\n                            }\n                        } else {\n                            data = event.data;\n                        }\n                        \n                        console.log('è§£æåæ•°æ®:', JSON.stringify(data, null, 2));\n                        \n                        // æ£€æŸ¥æ˜¯å¦ä¸ºè¿æ¥ç¡®è®¤æ¶ˆæ¯\n                        const content = data.content || data.message || data.payload?.content || '';\n                        const isConnectionMessage = content === 'è¿æ¥æˆåŠŸ' || content === 'connected' || content === 'connection established';\n                        \n                        if (isConnectionMessage) {\n                            console.log('âœ… æ”¶åˆ°è¿æ¥ç¡®è®¤æ¶ˆæ¯ï¼Œå¼€å§‹æ¥æ”¶æµå¼æ•°æ®...');\n                            return;\n                        }\n                        \n                        // æ£€æŸ¥æ˜¯å¦ä¸ºDOU_BAO_CHATç±»å‹çš„æ¶ˆæ¯\n                        if (data.category === 'DOU_BAO_CHAT') {\n                            messageCount++;\n                            \n                            // æå–æ¶ˆæ¯å†…å®¹\n                            let messageContent = data.content || data.message || data.payload?.content || '';\n                            \n                            // æ›´æ–°ä¼šè¯IDï¼ˆå¦‚æœæ”¶åˆ°ï¼‰- ä¿®å¤ï¼šä»payloadä¸­è·å–conversationId\n                            const newConversationId = data.conversationId || data.payload?.conversationId;\n                            if (newConversationId && !conversationId) {\n                                console.log('ğŸ†” æ”¶åˆ°conversationId:', newConversationId, 'æ¥æº:', data.conversationId ? 'data.conversationId' : 'data.payload.conversationId');\n                                \n                                // å¦‚æœæ˜¯æ–°å¯¹è¯ä¸”æ”¶åˆ°äº†conversationIdï¼Œåˆ›å»ºå¯¹è¯å’Œæ¶ˆæ¯\n                                if (isNewConversation && newConversationId && !isConversationCreated) {\n                                    console.log('ğŸ†” æ”¶åˆ°æ–°å¯¹è¯çš„conversationIdï¼Œåˆ›å»ºå¯¹è¯:', newConversationId);\n                                    \n                                    // åˆ›å»ºå¯¹è¯\n                                    commit('CREATE_CONVERSATION_FROM_BACKEND', {\n                                        conversationId: newConversationId,\n                                        abstract: payload.content.substring(0, 30) + (payload.content.length > 30 ? '...' : ''),\n                                        messages: []\n                                    });\n                                    \n                                    // å¦‚æœä¸è·³è¿‡ç”¨æˆ·æ¶ˆæ¯ï¼Œåˆ™åˆ›å»ºç”¨æˆ·æ¶ˆæ¯è®°å½•\n                                    if (!payload.skipUserMessage) {\n                                        userMessage = {\n                                            id: `msg-user-${Date.now()}`,\n                                            role: 'user',\n                                            content: payload.content,\n                                            timestamp: new Date().toISOString(),\n                                            status: 'sent'\n                                        };\n                                        \n                                        // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯\n                                        commit('ADD_MESSAGE_TO_CURRENT_CONVERSATION', userMessage);\n                                    }\n                                    \n                                    isConversationCreated = true;\n                                }\n                                \n                                conversationId = newConversationId;\n                            }\n                            \n                            // å¦‚æœè¿˜æ²¡æœ‰AIæ¶ˆæ¯IDï¼Œåˆ›å»ºAIæ¶ˆæ¯\n                            if (!aiMessageId) {\n                                aiMessageId = payload.aiMessageId || `msg-ai-${Date.now()}`;\n                                aiMessage = {\n                                    id: aiMessageId,\n                                    role: 'AI',\n                                    content: '',\n                                    timestamp: new Date().toISOString(),\n                                    streaming: true,\n                                    status: 'sending'\n                                };\n                                \n                                // æ·»åŠ AIæ¶ˆæ¯\n                                commit('ADD_MESSAGE_TO_CURRENT_CONVERSATION', aiMessage);\n                                console.log('âœ… å·²åˆ›å»ºAIæ¶ˆæ¯:', aiMessageId);\n                            }\n                            \n                            // æ£€æŸ¥æ˜¯å¦ä¸ºç©ºå­—æ®µï¼ˆç»“æŸæ ‡è¯†ï¼‰\n                            if (messageContent === '' || messageContent === null || messageContent === undefined) {\n                                console.log('ğŸ æ”¶åˆ°ç©ºå­—æ®µï¼Œæµå¼ä¼ è¾“å®Œæˆ');\n                                \n                                // åœ¨ç»“æŸæ—¶å†æ¬¡æ£€æŸ¥å¹¶æ›´æ–°conversationId\n                                const finalConversationId = conversationId || data.conversationId || data.payload?.conversationId;\n                                if (finalConversationId && !conversationId) {\n                                    conversationId = finalConversationId;\n                                    console.log('ğŸ†” åœ¨ç»“æŸæ—¶æ›´æ–°conversationId:', conversationId);\n                                }\n                                \n                                isStreamComplete = true;\n                                \n                                // æ¸…ç†æœ€ç»ˆå†…å®¹ï¼Œå»é™¤å¤šä½™ç©ºè¡Œ\n                                const cleanedContent = streamContent.replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n').trim();\n                                \n                                // æ›´æ–°AIæ¶ˆæ¯ä¸ºå®ŒæˆçŠ¶æ€\n                                if (aiMessageId) {\n                                    commit('UPDATE_MESSAGE_CONTENT', {\n                                        messageId: aiMessageId,\n                                        content: cleanedContent,\n                                        streaming: false,\n                                        status: 'sent'\n                                    });\n                                }\n                                \n                                console.log('âœ… æµå¼ä¼ è¾“å®Œæˆ:', {\n                                    content: cleanedContent,\n                                    conversationId: conversationId,\n                                    messageCount: messageCount\n                                });\n                                console.log('   - æœ€ç»ˆå†…å®¹é•¿åº¦:', cleanedContent.length);\n                                console.log('   - æ€»æ¶ˆæ¯ç‰‡æ®µæ•°:', messageCount);\n                                console.log('   - ä¼šè¯ID:', conversationId);\n                                \n                                // è°ƒç”¨å®Œæˆå›è°ƒ\n                                if (payload.onComplete) {\n                                    payload.onComplete({\n                                        content: cleanedContent,\n                                        conversationId: conversationId,\n                                        messageCount: messageCount\n                                    });\n                                }\n                                \n                                // è§£æå¹¶è¿”å›æœ€ç»ˆç»“æœ\n                                resolve({\n                                    success: true,\n                                    data: {\n                                        content: cleanedContent,\n                                        message: cleanedContent,\n                                        conversationId: conversationId,\n                                        messageCount: messageCount,\n                                        isStreamComplete: true\n                                    }\n                                });\n                                \n                                // å…³é—­è¿æ¥\n                                socketTask.close();\n                                return;\n                            }\n                            \n                            \n                            // ç´¯ç§¯æµå¼å†…å®¹\n                            streamContent += messageContent;\n                            \n                            console.log(`ğŸ“ æµå¼ç‰‡æ®µ ${messageCount}:`, messageContent);\n                            console.log(`ğŸ“„ ç´¯ç§¯å†…å®¹é•¿åº¦: ${streamContent.length}`);\n                            console.log(`ğŸ†” ä¼šè¯ID: ${conversationId}`);\n                            \n                            // å®æ—¶æ›´æ–°AIæ¶ˆæ¯å†…å®¹\n                            if (aiMessageId) {\n                                commit('UPDATE_MESSAGE_CONTENT', {\n                                    messageId: aiMessageId,\n                                    content: streamContent,\n                                    streaming: true,\n                                    status: 'sending'\n                                });\n                            }\n                            \n                            // è°ƒç”¨æµå¼æ¶ˆæ¯å›è°ƒ\n                            if (payload.onMessage) {\n                                payload.onMessage({\n                                    content: messageContent,\n                                    fullContent: streamContent,\n                                    isComplete: false,\n                                    conversationId: conversationId,\n                                    messageCount: messageCount\n                                });\n                            }\n                            \n                            // æ£€æŸ¥æ˜¯å¦ä¸ºå…¶ä»–ç»“æŸæ ‡å¿—ï¼ˆä¿ç•™åŸæœ‰é€»è¾‘ä½œä¸ºå¤‡ç”¨ï¼‰\n                            const isEndMessage = data.isEnd || data.finished || data.complete || \n                                                messageContent.includes('[END]') || \n                                                messageContent.includes('[DONE]');\n                            \n                            if (isEndMessage) {\n                                console.log('ğŸ æµå¼ä¼ è¾“å®Œæˆï¼ˆå…¶ä»–ç»“æŸæ ‡å¿—ï¼‰');\n                                \n                                // åœ¨ç»“æŸæ—¶å†æ¬¡æ£€æŸ¥å¹¶æ›´æ–°conversationId\n                                const finalConversationId = conversationId || data.conversationId || data.payload?.conversationId;\n                                if (finalConversationId && !conversationId) {\n                                    conversationId = finalConversationId;\n                                    console.log('ğŸ†” åœ¨ç»“æŸæ—¶æ›´æ–°conversationIdï¼ˆå…¶ä»–ç»“æŸæ ‡å¿—ï¼‰:', conversationId);\n                                }\n                                \n                                isStreamComplete = true;\n                                \n                                // æ¸…ç†æœ€ç»ˆå†…å®¹ï¼Œå»é™¤å¤šä½™ç©ºè¡Œ\n                                const cleanedContent = streamContent.replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n').trim();\n                                \n                                // æ›´æ–°AIæ¶ˆæ¯ä¸ºå®ŒæˆçŠ¶æ€\n                                if (aiMessageId) {\n                                    commit('UPDATE_MESSAGE_CONTENT', {\n                                        messageId: aiMessageId,\n                                        content: cleanedContent,\n                                        streaming: false,\n                                        status: 'sent'\n                                    });\n                                }\n                                \n                                // è°ƒç”¨å®Œæˆå›è°ƒ\n                                if (payload.onComplete) {\n                                    payload.onComplete({\n                                        content: cleanedContent,\n                                        conversationId: conversationId,\n                                        messageCount: messageCount\n                                    });\n                                }\n                                \n                                // è§£æå¹¶è¿”å›æœ€ç»ˆç»“æœ\n                                resolve({\n                                    success: true,\n                                    data: {\n                                        content: cleanedContent,\n                                        message: cleanedContent,\n                                        conversationId: conversationId,\n                                        messageCount: messageCount,\n                                        isStreamComplete: true\n                                    }\n                                });\n                                \n                                // å…³é—­è¿æ¥\n                                socketTask.close();\n                            }\n                        } else {\n                            console.log('âš ï¸ æ”¶åˆ°éDOU_BAO_CHATç±»å‹æ¶ˆæ¯:', data);\n                        }\n                        \n                    } catch (error) {\n                        console.error('âŒ è§£æWebSocketæ¶ˆæ¯å¤±è´¥:', error);\n                        console.error('åŸå§‹æ¶ˆæ¯æ•°æ®:', event.data);\n                        \n                        if (payload.onError) {\n                            payload.onError(new Error(`æ¶ˆæ¯æ ¼å¼é”™è¯¯: ${error.message}`));\n                        }\n                        \n                        reject(new Error(`æ¶ˆæ¯æ ¼å¼é”™è¯¯: ${error.message}`));\n                    }\n                });\n                \n                // è¿æ¥é”™è¯¯\n                socketTask.onError((error) => {\n                    console.error('âŒ WebSocketè¿æ¥é”™è¯¯:', error);\n                    if (payload.onError) {\n                        payload.onError(new Error('WebSocketè¿æ¥å‡ºç°é”™è¯¯'));\n                    }\n                    reject(new Error('WebSocketè¿æ¥å‡ºç°é”™è¯¯'));\n                });\n                \n                // è¿æ¥å…³é—­\n                socketTask.onClose((event) => {\n                    console.log('ğŸ”Œ WebSocketè¿æ¥å·²å…³é—­:', event.code, event.reason);\n                    \n                    // å¦‚æœæµå¼ä¼ è¾“æœªå®Œæˆä½†è¿æ¥å…³é—­ï¼Œè®¤ä¸ºä¼ è¾“å®Œæˆ\n                    if (!isStreamComplete && streamContent.length > 0) {\n                        console.log('âš ï¸ è¿æ¥æå‰å…³é—­ï¼Œä½†å·²æ¥æ”¶åˆ°å†…å®¹ï¼Œè®¤ä¸ºä¼ è¾“å®Œæˆ');\n                        \n                        // æ¸…ç†æœ€ç»ˆå†…å®¹ï¼Œå»é™¤å¤šä½™ç©ºè¡Œ\n                        const cleanedContent = streamContent.replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n').trim();\n                        \n                        // æ›´æ–°AIæ¶ˆæ¯ä¸ºå®ŒæˆçŠ¶æ€\n                        if (aiMessageId) {\n                            commit('UPDATE_MESSAGE_CONTENT', {\n                                messageId: aiMessageId,\n                                content: cleanedContent,\n                                streaming: false,\n                                status: 'sent'\n                            });\n                        }\n                        \n                        if (payload.onComplete) {\n                            payload.onComplete({\n                                content: cleanedContent,\n                                conversationId: conversationId,\n                                messageCount: messageCount\n                            });\n                        }\n                        \n                        resolve({\n                            success: true,\n                            data: {\n                                content: cleanedContent,\n                                message: cleanedContent,\n                                conversationId: conversationId,\n                                messageCount: messageCount,\n                                isStreamComplete: true\n                            }\n                        });\n                    } else if (!isStreamComplete) {\n                        // å¦‚æœæ²¡æœ‰æ¥æ”¶åˆ°ä»»ä½•å†…å®¹ä¸”è¿æ¥å…³é—­ï¼Œè®¤ä¸ºæ˜¯é”™è¯¯\n                        const errorMessage = 'è¿æ¥æ„å¤–å…³é—­ï¼Œæœªæ¥æ”¶åˆ°å®Œæ•´å“åº”';\n                        if (payload.onError) {\n                            payload.onError(new Error(errorMessage));\n                        }\n                        reject(new Error(errorMessage));\n                    }\n                });\n            });\n\n            return response;\n            \n        } catch (error) {\n            console.error('âŒ sendQuestionæ‰§è¡Œå¤±è´¥:', error);\n            \n            // å¦‚æœæœ‰é”™è¯¯å›è°ƒï¼Œè°ƒç”¨å®ƒ\n            if (payload.onError) {\n                payload.onError(error);\n            }\n            \n            throw error;\n        }\n    },\n\n    /**\n     * åŠ è½½ç‰¹å®šå¯¹è¯çš„å®Œæ•´å†…å®¹\n     * @param {Object} context - Vuexä¸Šä¸‹æ–‡\n     * @param {string} conversationId - å¯¹è¯ID\n     * @returns {Promise<Object>} è¿”å›è¯·æ±‚ç»“æœ\n     */\n    async loadChat({ commit, state }, conversationId) {\n        try {\n            // ä»conversationsä¸­æ‰¾åˆ°å¯¹åº”çš„å¯¹è¯ä»¥è·å–topicä¿¡æ¯\n            const conversation = state.aiChat.conversations.find(conv => conv.id == conversationId);\n            const topic = conversation?.chatMode || 'general';\n            \n            console.log('=== å¼ºåˆ¶åŠ è½½å¯¹è¯è¯¦æƒ…ï¼ˆæ— ç¼“å­˜ï¼‰ ===');\n            console.log('å¯¹è¯ID:', conversationId);\n            console.log('å¯¹è¯æ¨¡å¼:', topic);\n            console.log('å¯¹è¯ä¿¡æ¯:', conversation);\n            console.log('===================================');\n            \n            // å¼ºåˆ¶ä»åç«¯é‡æ–°è·å–æ•°æ®ï¼Œæ·»åŠ æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜\n            const response = await apiRequest(`${getApiPrefix()}/yanshilu/aiChat/detail`, 'POST', { \n                id: parseInt(conversationId),\n                type: \"DOU_BAO_CHAT\",\n                topic: topic,\n                timestamp: Date.now() // æ·»åŠ æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜\n            });\n            \n            console.log('loadChat APIå“åº”:', response);\n            \n            if (response.success) {\n                // ä¿®å¤ï¼šæ­£ç¡®å¤„ç†æ•°æ®å±‚çº§ - response.dataæ˜¯æ•´ä¸ªåç«¯å“åº”ï¼Œéœ€è¦å–response.data.data\n                const backendResponse = response.data;\n                console.log('åç«¯å®Œæ•´å“åº”:', backendResponse);\n                \n                // æ£€æŸ¥åç«¯å“åº”æ ¼å¼\n                if (backendResponse.code !== 200) {\n                    throw new Error(backendResponse.msg || 'åç«¯è¿”å›é”™è¯¯');\n                }\n                \n                // æ›´æ–°èŠå¤©æ¨¡å¼\n                if (backendResponse.data && backendResponse.data.length > 0 && backendResponse.data[0].topic) {\n                    commit('UPDATE_CHAT_MODE', backendResponse.data[0].topic);\n                } else if (topic) {\n                    commit('UPDATE_CHAT_MODE', topic);\n                }\n                \n                // è·å–å®é™…çš„æ¶ˆæ¯æ•°æ®æ•°ç»„\n                const messageData = backendResponse.data || [];\n                console.log('æå–çš„æ¶ˆæ¯æ•°æ®:', messageData);\n                \n                // å°†questionå’Œanswerè½¬æ¢ä¸ºæ¶ˆæ¯æ ¼å¼\n                const messages = [];\n                \n                messageData.forEach((item, index) => {\n                    // æ·»åŠ ç”¨æˆ·é—®é¢˜æ¶ˆæ¯\n                    if (item.question) {\n                        messages.push({\n                            id: `msg-user-${item.id}-${index}`,\n                            role: 'user',\n                            content: item.question,\n                            timestamp: item.createTime || item.updateTime || new Date().toISOString(),\n                            status: 'sent'\n                        });\n                    }\n                    \n                    // æ·»åŠ AIå›ç­”æ¶ˆæ¯\n                    if (item.answer) {\n                        messages.push({\n                            id: `msg-ai-${item.id}-${index}`,\n                            role: 'AI',\n                            content: item.answer,\n                            timestamp: item.updateTime || item.createTime || new Date().toISOString(),\n                            status: 'sent',\n                            streaming: false\n                        });\n                    }\n                });\n                \n                // æŒ‰æ—¶é—´æˆ³æ’åºæ¶ˆæ¯\n                messages.sort((a, b) => {\n                    const timeA = new Date(a.timestamp).getTime();\n                    const timeB = new Date(b.timestamp).getTime();\n                    return timeA - timeB;\n                });\n                \n                // æ„å»ºå®Œæ•´çš„å¯¹è¯æ•°æ®\n                const conversationData = {\n                    id: conversationId,\n                    abstract: conversation?.abstract || 'æ— æ ‡é¢˜',\n                    chatMode: backendResponse.data && backendResponse.data.length > 0 && backendResponse.data[0].topic ? \n                              backendResponse.data[0].topic : topic,\n                    type: 'DOU_BAO_CHAT',\n                    messages: messages,\n                    createdAt: conversation?.createdAt || Date.now(),\n                    updatedAt: conversation?.updatedAt || Date.now(),\n                    // æ·»åŠ æ ‡è®°è¡¨ç¤ºè¿™æ˜¯æœ€æ–°ä»åç«¯è·å–çš„æ•°æ®\n                    lastFetchTime: Date.now()\n                };\n                \n                // å¼ºåˆ¶æ›´æ–°å¯¹è¯è¯¦æƒ…åˆ°stateï¼ˆè¦†ç›–ä»»ä½•ç°æœ‰ç¼“å­˜ï¼‰\n                commit('UPDATE_CONVERSATION_DETAIL', conversationData);\n                \n                console.log('=== å¯¹è¯è¯¦æƒ…å¼ºåˆ¶åŠ è½½æˆåŠŸ ===');\n                console.log('åŸå§‹æ•°æ®æ¡æ•°:', messageData.length);\n                console.log('è½¬æ¢åæ¶ˆæ¯æ•°:', messages.length);\n                console.log('æœ€æ–°è·å–æ—¶é—´:', new Date(conversationData.lastFetchTime).toLocaleString());\n                console.log('å¯¹è¯æ•°æ®:', conversationData);\n                console.log('===============================');\n                \n                return {\n                    success: true,\n                    data: conversationData,\n                    conversation: conversationData\n                };\n            } else {\n                throw new Error(response.message || 'åŠ è½½å¯¹è¯å¤±è´¥');\n            }\n        } catch (error) {\n            console.error('=== å¼ºåˆ¶åŠ è½½å¯¹è¯è¯¦æƒ…å¤±è´¥ ===');\n            console.error('å¯¹è¯ID:', conversationId);\n            console.error('é”™è¯¯ä¿¡æ¯:', error);\n            console.error('=============================');\n            \n            return {\n                success: false,\n                message: error.message || 'åŠ è½½å¯¹è¯è¯¦æƒ…å¤±è´¥'\n            };\n        }\n    },\n    \n    /**\n     * åˆ é™¤æŒ‡å®šçš„å¯¹è¯\n     * @param {Object} context - Vuexä¸Šä¸‹æ–‡\n     * @param {string} conversationId - å¯¹è¯ID\n     * @returns {Promise<Object>} è¿”å›æ“ä½œç»“æœ\n     */\n    async deleteChat({ commit, state }, conversationId) {\n        try {\n            const response = await apiRequest(`${getApiPrefix()}/yanshilu/aiChat/delete`, 'POST', {\n                id: conversationId\n            });\n            \n            if (response.success) {\n                commit('DELETE_CONVERSATION', conversationId);\n                \n                // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰æ´»è·ƒä¼šè¯ï¼Œåˆ™æ¸…ç©ºå½“å‰æ´»è·ƒä¼šè¯\n                if (state.aiChat.activeConversation === conversationId) {\n                    commit('UPDATE_CURRENT_CONVERSATION', null);\n                }\n                \n                return { \n                    success: true,\n                    message: 'åˆ é™¤æˆåŠŸ'\n                };\n            } else {\n                throw new Error(response.message || 'åˆ é™¤å¤±è´¥');\n            }\n        } catch (error) {\n            console.error('åˆ é™¤å¯¹è¯å¤±è´¥:', error);\n            return {\n                success: false,\n                message: error.message || 'åˆ é™¤å¯¹è¯å¤±è´¥'\n            };\n        }\n    },\n    \n    /**\n     * è·å–å¯¹è¯å†å²åˆ—è¡¨\n     * @param {Object} context - Vuexä¸Šä¸‹æ–‡\n     * @param {Object} params - åˆ†é¡µå‚æ•°\n     * @param {number} params.pageNum - é¡µç \n     * @param {number} params.pageSize - æ¯é¡µå¤§å°\n     * @description å­—æ®µæ˜ å°„å…³ç³»ï¼š\n     *   - åç«¯ title å­—æ®µ â†’ å‰ç«¯ abstract å­—æ®µï¼ˆå¯¹è¯æ‘˜è¦/æ ‡é¢˜ï¼‰\n     *   - åç«¯ topic å­—æ®µ â†’ å‰ç«¯ chatMode å­—æ®µï¼ˆå¯¹è¯æ¨¡å¼ï¼‰\n     * @returns {Promise<Object>} è¿”å›è¯·æ±‚ç»“æœ\n     */\n    async loadConversationHistory({ commit, state }, params = {}) {\n        try {\n            commit('SET_PAGINATION_LOADING', true);\n            \n            // ä½¿ç”¨ä¼ å…¥çš„å‚æ•°æˆ–é»˜è®¤å€¼\n            const pageNum = params.pageNum || state.aiChat.pagination.pageNum;\n            const pageSize = params.pageSize || state.aiChat.pagination.pageSize;\n            \n            // æ›´æ–°é¡µç å‚æ•°åˆ°stateï¼ˆå¦‚æœæœ‰ä¼ å…¥ï¼‰\n            if (params.pageNum) commit('SET_PAGE_NUM', params.pageNum);\n            if (params.pageSize) commit('SET_PAGE_SIZE', params.pageSize);\n            \n            // å‘é€APIè¯·æ±‚\n            const response = await apiRequest(`${getApiPrefix()}/yanshilu/aiChat/list`, 'POST', {\n                pageSize,\n                pageNum\n            });\n            console.log('response:', response);\n            \n            if (response.success && response.data?.code === 200) {\n                // å¤„ç†è¿”å›çš„æ•°æ®æ ¼å¼\n                const conversationsList = response.data.rows || [];\n                console.log('conversationsList:', conversationsList);\n                const total = response.data.total || 0;\n                \n                console.log('=== APIå“åº”æ•°æ®è§£æ ===');\n                console.log('response.success:', response.success);\n                console.log('response.data.code:', response.data?.code);\n                console.log('response.data.total:', response.data?.total);\n                console.log('response.data.rows.length:', response.data?.rows?.length);\n                console.log('========================');\n                \n                // è½¬æ¢æ•°æ®æ ¼å¼ä»¥é€‚é…ç°æœ‰çš„çŠ¶æ€ç»“æ„\n                const formattedConversations = conversationsList.map(item => ({\n                    id: item.id,\n                    // å¤„ç†abstractå­—æ®µï¼šå»é™¤æ¢è¡Œç¬¦å’Œå¤šä½™ç©ºæ ¼\n                    abstract: (item.title || '').replace(/[\\r\\n\\t]/g, ' ').replace(/\\s+/g, ' ').trim() || 'æ— æ ‡é¢˜',\n                    chatMode: item.topic || 'general', // ä½¿ç”¨topicä½œä¸ºchatModeï¼Œé»˜è®¤ä¸ºgeneral\n                    type: item.type,\n                    createdAt: item.createTime ? new Date(item.createTime).getTime() : Date.now(),\n                    updatedAt: item.updateTime ? new Date(item.updateTime).getTime() : Date.now(),\n                    createBy: item.createBy,\n                    updateBy: item.updateBy,\n                    remark: item.remark\n                }));\n                \n                // æ›´æ–°å¯¹è¯åˆ—è¡¨\n                commit('UPDATE_CONVERSATIONS_LIST', formattedConversations);\n                \n                // è®¡ç®—åˆ†é¡µä¿¡æ¯\n                const totalPages = Math.ceil(total / pageSize);\n                const hasNext = pageNum < totalPages;\n                const hasPrev = pageNum > 1;\n                \n                // æ›´æ–°åˆ†é¡µä¿¡æ¯\n                const paginationInfo = {\n                    pageNum,\n                    pageSize,\n                    total,\n                    totalPages,\n                    hasNext,\n                    hasPrev,\n                    loading: false\n                };\n                \n                commit('UPDATE_PAGINATION', paginationInfo);\n                \n                console.log('=== å¯¹è¯å†å²åŠ è½½æˆåŠŸ ===');\n                console.log('åŸå§‹æ•°æ®æ¡æ•°:', conversationsList.length);\n                console.log('æ ¼å¼åŒ–åæ•°æ®:', formattedConversations);\n                console.log('åˆ†é¡µä¿¡æ¯:', paginationInfo);\n                console.log('=======================');\n                \n                return {\n                    success: true,\n                    data: formattedConversations,\n                    pagination: paginationInfo,\n                    total: total\n                };\n            } else {\n                console.error('APIå“åº”å¤±è´¥:', response);\n                throw new Error(response.message || response.data?.msg || 'è·å–å¯¹è¯å†å²å¤±è´¥');\n            }\n        } catch (error) {\n            console.error('è·å–å¯¹è¯å†å²å¤±è´¥:', error);\n            console.error('é”™è¯¯è¯¦æƒ…:', error.message);\n            return {\n                success: false,\n                message: error.message || 'è·å–å¯¹è¯å†å²å¤±è´¥'\n            };\n        } finally {\n            commit('SET_PAGINATION_LOADING', false);\n        }\n    },\n\n    /**\n     * åˆ†é¡µç›¸å…³æ“ä½œ - åŠ è½½ä¸‹ä¸€é¡µ\n     * @description å­—æ®µæ˜ å°„å…³ç³»ï¼š\n     *   - åç«¯ title å­—æ®µ â†’ å‰ç«¯ abstract å­—æ®µï¼ˆå¯¹è¯æ‘˜è¦/æ ‡é¢˜ï¼‰\n     *   - åç«¯ topic å­—æ®µ â†’ å‰ç«¯ chatMode å­—æ®µï¼ˆå¯¹è¯æ¨¡å¼ï¼‰\n     */\n    async nextPage({ state, dispatch, commit }) {\n        if (state.aiChat.pagination.hasNext) {\n            try {\n                const nextPageNum = state.aiChat.pagination.pageNum + 1;\n                \n                console.log('=== åŠ è½½ä¸‹ä¸€é¡µ ===');\n                console.log('å½“å‰é¡µ:', state.aiChat.pagination.pageNum);\n                console.log('ä¸‹ä¸€é¡µ:', nextPageNum);\n                console.log('================');\n                \n                // è®¾ç½®åŠ è½½çŠ¶æ€\n                commit('SET_PAGINATION_LOADING', true);\n                \n                // å‘é€APIè¯·æ±‚\n                const response = await apiRequest(`${getApiPrefix()}/yanshilu/aiChat/list`, 'POST', {\n                    pageSize: state.aiChat.pagination.pageSize,\n                    pageNum: nextPageNum\n                });\n                \n                if (response.success && response.data?.code === 200) {\n                    // å¤„ç†è¿”å›çš„æ•°æ®æ ¼å¼\n                    const conversationsList = response.data.rows || [];\n                    const total = response.data.total || 0;\n                    \n                    // è½¬æ¢æ•°æ®æ ¼å¼\n                    const formattedConversations = conversationsList.map(item => ({\n                        id: item.id,\n                        // å¤„ç†abstractå­—æ®µï¼šå»é™¤æ¢è¡Œç¬¦å’Œå¤šä½™ç©ºæ ¼\n                        abstract: (item.title || '').replace(/[\\r\\n\\t]/g, ' ').replace(/\\s+/g, ' ').trim() || 'æ— æ ‡é¢˜',\n                        chatMode: item.topic || 'general',\n                        type: item.type,\n                        createdAt: item.createTime ? new Date(item.createTime).getTime() : Date.now(),\n                        updatedAt: item.updateTime ? new Date(item.updateTime).getTime() : Date.now(),\n                        createBy: item.createBy,\n                        updateBy: item.updateBy,\n                        remark: item.remark\n                    }));\n                    \n                    // æŒ‰æ›´æ–°æ—¶é—´å€’åºæ’åºï¼ˆæœ€æ–°çš„åœ¨å‰é¢ï¼‰\n                    formattedConversations.sort((a, b) => {\n                        const timeA = a.updatedAt || a.createdAt || 0;\n                        const timeB = b.updatedAt || b.createdAt || 0;\n                        return timeB - timeA;\n                    });\n                    \n                    // è¿½åŠ æ–°æ•°æ®åˆ°ç°æœ‰åˆ—è¡¨\n                    commit('APPEND_CONVERSATIONS_LIST', formattedConversations);\n                    \n                    // æ›´æ–°åˆ†é¡µä¿¡æ¯\n                    const totalPages = Math.ceil(total / state.aiChat.pagination.pageSize);\n                    const hasNext = nextPageNum < totalPages;\n                    const hasPrev = nextPageNum > 1;\n                    \n                    const paginationInfo = {\n                        pageNum: nextPageNum,\n                        pageSize: state.aiChat.pagination.pageSize,\n                        total,\n                        totalPages,\n                        hasNext,\n                        hasPrev,\n                        loading: false\n                    };\n                    \n                    commit('UPDATE_PAGINATION', paginationInfo);\n                    \n                    console.log('=== ä¸‹ä¸€é¡µåŠ è½½æˆåŠŸ ===');\n                    console.log('æ–°å¢æ•°æ®æ¡æ•°:', formattedConversations.length);\n                    console.log('æ€»æ•°æ®æ¡æ•°:', state.aiChat.conversations.length);\n                    console.log('åˆ†é¡µä¿¡æ¯:', paginationInfo);\n                    console.log('====================');\n                    \n                    return {\n                        success: true,\n                        data: formattedConversations,\n                        pagination: paginationInfo,\n                        total: total\n                    };\n                } else {\n                    throw new Error(response.message || 'åŠ è½½ä¸‹ä¸€é¡µå¤±è´¥');\n                }\n            } catch (error) {\n                console.error('åŠ è½½ä¸‹ä¸€é¡µå¤±è´¥:', error);\n                return {\n                    success: false,\n                    message: error.message || 'åŠ è½½ä¸‹ä¸€é¡µå¤±è´¥'\n                };\n            } finally {\n                commit('SET_PAGINATION_LOADING', false);\n            }\n        }\n        return { success: false, message: 'å·²ç»æ˜¯æœ€åä¸€é¡µ' };\n    },\n\n    async prevPage({ state, dispatch }) {\n        if (state.aiChat.pagination.hasPrev) {\n            return await dispatch('loadConversationHistory', {\n                pageNum: state.aiChat.pagination.pageNum - 1\n            });\n        }\n        return { success: false, message: 'å·²ç»æ˜¯ç¬¬ä¸€é¡µ' };\n    },\n\n    async goToPage({ state, dispatch }, pageNum) {\n        if (pageNum >= 1 && pageNum <= state.aiChat.pagination.totalPages) {\n            return await dispatch('loadConversationHistory', { pageNum });\n        }\n        return { success: false, message: 'é¡µç è¶…å‡ºèŒƒå›´' };\n    },\n\n    async changePageSize({ dispatch }, pageSize) {\n        return await dispatch('loadConversationHistory', {\n            pageNum: 1,\n            pageSize\n        });\n    },\n\n    async refreshPage({ state, dispatch }) {\n        return await dispatch('loadConversationHistory', {\n            pageNum: state.aiChat.pagination.pageNum,\n            pageSize: state.aiChat.pagination.pageSize\n        });\n    }\n};"],"names":["getApiPrefix","useGlobalStore","actions","commit","chatId","state","rootState","payload","userMessage","aiMessageId","aiMessage","isNewConversation","conversationIdToSend","activeId","uni","requestData","wsUrl","getCurrentToken","resolve","reject","socketTask","error","streamContent","conversationId","messageCount","isStreamComplete","isConversationCreated","event","data","content","_a","messageContent","_b","newConversationId","_c","finalConversationId","_d","cleanedContent","_e","errorMessage","conversation","conv","topic","response","apiRequest","backendResponse","messageData","messages","item","index","a","b","timeA","timeB","conversationData","params","pageNum","pageSize","conversationsList","total","formattedConversations","totalPages","hasNext","hasPrev","paginationInfo","_f","dispatch","nextPageNum"],"mappings":"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"}