{"version":3,"file":"index.js","sources":["pages/index/index.vue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <image class=\"background-image\" src=\"/static/image/index/image.png\" mode=\"aspectFill\" alt=\"背景图\" />\n    <!-- 主页面内容 -->\n    <view class=\"page-container\">\n      <view class=\"header\">\n        <view class=\"main-title\">一站式对接</view>\n        <view class=\"sub-title\">目标院校专业学长学姐</view>\n      </view>\n  \t\t<c-lottie class=\"match-animation\"\n  \t\t\tref=\"cLottieRef\"\n  \t\t\t:src=\"animationSrc\"\n  \t\t\twidth=\"600rpx\"\n        :autoPlay=\"false\"\n  \t\t\theight=\"600rpx\"\n  \t\t\t:loop=\"true\"\n        @dataReady=\"onDataReady\"\n  \t\t></c-lottie>\n      <view class=\"button-area\">\n        <button class=\"match-button\" @click.stop=\"matchAnimation\">\n          <view class=\"match-content\">\n            <image\n              class=\"match-icon\"\n              src=\"/static/image/index/matchsearch.png\"\n              mode=\"aspectFit\"\n              alt=\"匹配图标\"\n            />\n            <text class=\"match-text\">精准匹配</text>\n          </view>\n        </button>\n      </view>\n  \n      <!-- <AICartoon /> -->\n      <TabBar pageName=\"index\" />\n    </view>\n  </view>\n</template>\n\n<script setup lang=\"uts\">\n// import AICartoon from '@/components/AI-cartoon/AI-cartoon.vue'\nimport TabBar from '@/components/tab-bar/tab-bar.vue'\nimport { Navigator } from '@/router/Router.js'\nimport { ref, onMounted, onActivated, onBeforeUnmount } from \"vue\";\n\n// 创建一个缓存对象，用于存储动画数据\nconst animationCache = new Map();\n\nconst cLottieRef = ref()\nconst animationSrc = ref('')\nconst defaultSrc = 'https://lottie.host/aa045d36-86ee-46d3-9705-1eeb65b38465/V6aAFX4Fmk.json'\nconst animationLoaded = ref(false)\nconst loading = ref(false)\nconst pageReady = ref(false)\nlet loadTimeout = null\n\n/**\n * 组件属性\n * @type {Object}\n */\nconst props = defineProps({\n  src: {\n    type: String,\n    default: defaultSrc\n  }\n})\n\n/**\n * 从URL中提取唯一键\n * @param {String} url - 动画URL\n * @returns {String} 唯一键\n */\nconst getAnimationKey = (url) => {\n  return url.split('/').pop().split('.')[0]\n}\n\n/**\n * 检查动画是否已缓存\n * @param {String} url - 动画URL\n * @returns {Boolean} 是否已缓存\n */\nconst isAnimationCached = (url) => {\n  return animationCache.has(url)\n}\n\n/**\n * 从缓存中获取动画数据\n * @param {String} url - 动画URL\n * @returns {Object|null} 动画数据或null\n */\nconst getAnimationFromCache = (url) => {\n  return animationCache.get(url) || null\n}\n\n/**\n * 将动画数据存入缓存\n * @param {String} url - 动画URL\n * @param {Object} data - 动画数据\n */\nconst saveAnimationToCache = (url, data) => {\n  animationCache.set(url, data)\n  \n  // 同时保存到本地存储，以便下次应用启动时可以恢复\n  try {\n    const key = `lottie_${getAnimationKey(url)}`\n    uni.setStorageSync(key, data)\n    uni.__f__('log','at pages/index/index.vue:106','动画数据已保存到本地存储', key)\n  } catch (e) {\n    uni.__f__('error','at pages/index/index.vue:108','保存到本地存储失败', e)\n  }\n}\n\n/**\n * 恢复本地存储中的动画数据到缓存\n * @param {String} url - 动画URL\n * @returns {Boolean} 是否成功恢复\n */\nconst restoreAnimationFromStorage = (url) => {\n  const key = `lottie_${getAnimationKey(url)}`\n  try {\n    const data = uni.getStorageSync(key)\n    if (data) {\n      animationCache.set(url, data)\n      uni.__f__('log','at pages/index/index.vue:123','已从本地存储恢复动画数据到缓存', key)\n      return true\n    }\n  } catch (e) {\n    uni.__f__('error','at pages/index/index.vue:127','从本地存储恢复失败', e)\n  }\n  return false\n}\n\n/**\n * 加载动画数据\n * @param {String} url - 动画URL\n * @returns {Promise<Object>} 动画数据\n */\nconst loadAnimationData = async (url) => {\n  if (loading.value) {\n    uni.__f__('log','at pages/index/index.vue:139','已有加载任务正在进行')\n    return null\n  }\n  \n  loading.value = true\n  \n  // 首先检查内存缓存\n  if (isAnimationCached(url)) {\n    uni.__f__('log','at pages/index/index.vue:147','从内存缓存获取动画数据')\n    loading.value = false\n    return getAnimationFromCache(url)\n  }\n  \n  // 然后检查本地存储\n  if (restoreAnimationFromStorage(url)) {\n    uni.__f__('log','at pages/index/index.vue:154','从本地存储恢复动画数据')\n    loading.value = false\n    return getAnimationFromCache(url)\n  }\n  \n  // 最后从网络加载\n  uni.__f__('log','at pages/index/index.vue:160','从网络加载动画数据', url)\n  try {\n    const { data } = await uni.request({\n      url: url,\n      method: 'GET'\n    })\n    \n    // 保存到缓存\n    saveAnimationToCache(url, data)\n    \n    loading.value = false\n    return data\n  } catch (e) {\n    uni.__f__('error','at pages/index/index.vue:173','网络加载动画数据失败', e)\n    loading.value = false\n    return null\n  }\n}\n\n/**\n * 初始化动画\n */\nconst initAnimation = async () => {\n  // 清除可能存在的超时计时器\n  if (loadTimeout) {\n    clearTimeout(loadTimeout)\n  }\n  \n  // 重置页面准备状态\n  pageReady.value = false\n  \n  // 设置动画源\n  const targetSrc = props.src || defaultSrc\n  animationSrc.value = targetSrc\n  \n  // 预加载动画数据\n  loadAnimationData(targetSrc).then(data => {\n    if (data) {\n      uni.__f__('log','at pages/index/index.vue:198','动画数据加载成功')\n      animationLoaded.value = true\n    }\n  })\n  \n  // 设置超时处理，最长等待3秒\n  loadTimeout = setTimeout(() => {\n    uni.__f__('log','at pages/index/index.vue:205','动画加载超时，强制显示页面')\n    pageReady.value = true\n  }, 3000)\n  \n  // 如果已经缓存，可能不会触发dataReady事件，需要主动检查\n  if (isAnimationCached(targetSrc)) {\n    uni.__f__('log','at pages/index/index.vue:211','检测到缓存数据，预先设置动画加载状态')\n    animationLoaded.value = true\n    // 短暂延迟后显示页面\n    setTimeout(() => {\n      pageReady.value = true\n    }, 500)\n  }\n}\n\n/**\n * 数据准备完成回调\n */\nconst onDataReady = () => {\n  uni.__f__('log','at pages/index/index.vue:224','动画数据准备完成，触发dataReady事件')\n  animationLoaded.value = true\n  \n  // 清除加载超时计时器\n  if (loadTimeout) {\n    clearTimeout(loadTimeout)\n    loadTimeout = null\n  }\n  \n  // 动画准备好后，标记页面可以显示\n  setTimeout(() => {\n    uni.__f__('log','at pages/index/index.vue:235','设置页面为可显示状态')\n    pageReady.value = true\n  }, 100)\n}\n\n/**\n * 执行匹配动画\n */\nconst matchAnimation = () => {\n  if (!animationLoaded.value) {\n    uni.__f__('log','at pages/index/index.vue:245','动画尚未加载完成')\n    return\n  }\n  \n  cLottieRef.value.call('play')\n  setTimeout(() => {\n    cLottieRef.value.call('stop')\n    navigateToMatch()\n  }, 1000)\n}\n\n/**\n * 导航到匹配页面\n */\nconst navigateToMatch = () => {\n  Navigator.toMatch()\n}\n\n/**\n * 清理函数，在组件销毁前清除超时计时器\n */\nconst cleanup = () => {\n  if (loadTimeout) {\n    clearTimeout(loadTimeout)\n    loadTimeout = null\n  }\n}\n\n// 组件挂载时初始化\nonMounted(() => {\n  uni.__f__('log','at pages/index/index.vue:275','组件挂载，初始化动画')\n  initAnimation()\n})\n\n// 在页面被激活时确保动画已加载（如从其他页面返回时）\nonActivated(() => {\n  uni.__f__('log','at pages/index/index.vue:281','页面激活')\n  if (!animationSrc.value) {\n    initAnimation()\n  } else {\n    // 如果已有源但页面未准备好，强制准备\n    if (!pageReady.value) {\n      uni.__f__('log','at pages/index/index.vue:287','动画源已存在但页面未准备好，强制显示')\n      pageReady.value = true\n    }\n  }\n})\n\n// 在组件卸载前清理资源\nonBeforeUnmount(() => {\n  cleanup()\n})\n</script>\n\n<style >\n.container {\n  position: relative;\n  width: 100%;\n  min-height: 100vh;\n}\n\n.background-image {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 0;\n  pointer-events: none; /* 保证背景图不影响交互 */\n}\n\n.page-container {\n  position: relative;\n  width: 100%;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  box-sizing: border-box;\n  padding-bottom: 120rpx;\n  /* background-color: #f8f8f8; */\n  z-index: 1;\n}\n\n.header {\n  display: flex;\n  flex-direction: column;\n  margin-left: 100px;\n  margin-top: 110px;\n  width: 100%;\n}\n\n/**\n * main-title 主标题样式\n * @font-family PingFang SC\n * @font-weight 400\n * @font-size 24px (约48rpx)\n * @line-height 35px (约70rpx)\n * @letter-spacing -0.55px (约-1.1rpx)\n */\n .main-title {\n  font-family: 'PingFang SC', 'Microsoft YaHei', Arial, sans-serif;\n  font-weight: 550;\n  font-size: 48rpx;\n  line-height: 70rpx;\n  letter-spacing: -1.1rpx;\n  color: #333;\n}\n\n/**\n * sub-title 副标题样式\n * @font-family PingFang SC\n * @font-weight 400\n * @font-size 20px (约40rpx)\n * @line-height 35px (约70rpx)\n * @letter-spacing -0.55px (约-1.1rpx)\n */\n .sub-title {\n  font-family: 'PingFang SC', 'Microsoft YaHei', Arial, sans-serif;\n  font-weight: 400;\n  font-size: 40rpx;\n  line-height: 70rpx;\n  letter-spacing: -1.1rpx;\n  color: #666;\n  text-align: left;\n}\n\n.button-area {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: 60rpx;\n}\n\n/**\n * match-button 精准匹配按钮样式\n * @width 159px (约318rpx)\n * @height 53px (约106rpx)\n * @border-radius 10px (约20rpx)\n * @background 渐变色 linear-gradient(180deg, #A5A9F7 0%, rgba(70, 78, 248, 0.9) 100%)\n */\n .match-button {\n  width: 318rpx;\n  height: 106rpx;\n  border-radius: 20rpx;\n  background: linear-gradient(180deg, #A5A9F7 0%, rgba(70, 78, 248, 0.9) 100%);\n  color: #fff;\n  font-size: 32rpx;\n  font-weight: 500;\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  border: none;\n  box-shadow: none;\n  padding-left: 32rpx;\n  padding: 0;\n  gap: 16rpx;\n  /* 可选：去除原有边框和阴影 */\n}\n\n/**\n * match-content 按钮内容容器，横向排列图标和文字\n */\n.match-content {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-top: 33rpx;\n}\n\n/**\n * match-icon 按钮内左侧图标样式\n * @width 20.3px (约40rpx)\n * @height 20.3px (约40rpx)\n * @margin-right 16rpx（图标与文字间距）\n */\n.match-icon {\n  width: 40rpx;\n  height: 40rpx;\n  margin-right: 40rpx;\n}\n\n.match-animation {\n  position: relative;\n  margin-top: 50rpx;\n  top: 0;\n  left: 0;\n}\n\n/**\n * match-text 精准匹配文字样式\n * @font-family PingFang SC\n * @font-weight 400\n * @font-size 18px (约36rpx)\n * @line-height 100%\n * @letter-spacing -0.68px (约-1.36rpx)\n * @text-align center\n */\n.match-text {\n  font-family: 'PingFang SC', 'Microsoft YaHei', Arial, sans-serif;\n  font-weight: 400;\n  font-size: 18px;\n  line-height: 1;\n  letter-spacing: -1.36rpx;\n  text-align: center;\n  color: #fff;\n}\n\n</style>","import MiniProgramPage from 'E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","__awaiter","Navigator","onMounted","onActivated","onBeforeUnmount","MiniProgramPage"],"mappings":";;;;;;;;;;;;AAwCA,MAAO,SAAY,MAAA;AASnB,MAAM,aAAa;;;;;;;;;;AAJnB,UAAM,iBAAiB,oBAAI;AAE3B,UAAM,aAAaA,cAAAA;AACnB,UAAM,eAAeA,kBAAI,EAAE;AAE3B,UAAM,kBAAkBA,kBAAI,KAAK;AACjC,UAAM,UAAUA,kBAAI,KAAK;AACzB,UAAM,YAAYA,kBAAI,KAAK;AAC3B,QAAI,cAAc;AAMlB,UAAM,QAAQ;AAYd,UAAM,kBAAkB,CAAC,MAAG,SAAA;AAC1B,aAAO,IAAI,MAAM,GAAG,EAAE,IAAK,EAAC,MAAM,GAAG,EAAE,CAAC;AAAA,IAC1C;AAOA,UAAM,oBAAoB,CAAC,MAAG,SAAA;AAC5B,aAAO,eAAe,IAAI,GAAG;AAAA,IAC/B;AAOA,UAAM,wBAAwB,CAAC,MAAG,SAAA;AAChC,aAAO,WAAA,gBAAmB,GAAG,KAAK;AAAA,IACpC;AAOA,UAAM,uBAAuB,CAAC,MAAG,MAAE,OAAI,SAAA;AACrC,qBAAe,IAAI,KAAK,IAAI;AAG5B,UAAI;AACF,cAAM,MAAM,UAAU,gBAAgB,GAAG,CAAC;AAC1CC,sBAAAA,MAAI,eAAe,KAAK,IAAI;AAC5BA,sBAAG,MAAC,MAAM,OAAM,gCAA+B,gBAAgB,GAAG;AAAA,MACnE,SAAQ,GAAG;AACVA,sBAAG,MAAC,MAAM,SAAQ,gCAA+B,aAAa,CAAC;AAAA,MAChE;AAAA,IACH;AAOA,UAAM,8BAA8B,CAAC,MAAG,SAAA;AACtC,YAAM,MAAM,UAAU,gBAAgB,GAAG,CAAC;AAC1C,UAAI;AACF,cAAM,OAAOA,cAAAA,MAAI,eAAe,GAAG;AACnC,YAAI,MAAM;AACR,yBAAe,IAAI,KAAK,IAAI;AAC5BA,wBAAG,MAAC,MAAM,OAAM,gCAA+B,mBAAmB,GAAG;AACrE,iBAAO;AAAA,QACR;AAAA,MACF,SAAQ,GAAG;AACVA,sBAAG,MAAC,MAAM,SAAQ,gCAA+B,aAAa,CAAC;AAAA,MAChE;AACD,aAAO;AAAA,IACT;AAOA,UAAM,oBAAoB,CAAO,MAAG,SAAA;AAAA,aAAAC,wBAAA,MAAA,QAAA,QAAA,aAAA;AAClC,YAAI,QAAQ,OAAO;AACjBD,wBAAAA,MAAI,MAAM,OAAM,gCAA+B,YAAY;AAC3D,iBAAO;AAAA,QACR;AAED,gBAAQ,QAAQ;AAGhB,YAAI,kBAAkB,GAAG,GAAG;AAC1BA,wBAAAA,MAAI,MAAM,OAAM,gCAA+B,aAAa;AAC5D,kBAAQ,QAAQ;AAChB,iBAAO,sBAAsB,GAAG;AAAA,QACjC;AAGD,YAAI,4BAA4B,GAAG,GAAG;AACpCA,wBAAAA,MAAI,MAAM,OAAM,gCAA+B,aAAa;AAC5D,kBAAQ,QAAQ;AAChB,iBAAO,sBAAsB,GAAG;AAAA,QACjC;AAGDA,sBAAG,MAAC,MAAM,OAAM,gCAA+B,aAAa,GAAG;AAC/D,YAAI;AACM,gBAAA,QAAS,MAAMA,cAAG,MAAC,QAAQ;AAAA,YACjC;AAAA,YACA,QAAQ;AAAA,UACT,CAAA;AAGD,+BAAqB,KAAK,IAAI;AAE9B,kBAAQ,QAAQ;AAChB,iBAAO;AAAA,QACR,SAAQ,GAAG;AACVA,wBAAG,MAAC,MAAM,SAAQ,gCAA+B,cAAc,CAAC;AAChE,kBAAQ,QAAQ;AAChB,iBAAO;AAAA,QACR;AAAA,MACF,CAAA;AAAA;AAKD,UAAM,gBAAgB,MAAA;AAAA,aAAAC,cAAA,UAAA,MAAA,QAAA,QAAA,aAAA;AAEpB,YAAI,aAAa;AACf,uBAAa,WAAW;AAAA,QACzB;AAGD,kBAAU,QAAQ;AAGlB,cAAM,YAAY,MAAM,OAAO;AAC/B,qBAAa,QAAQ;AAGrB,0BAAkB,SAAS,EAAE,KAAK,CAAA,OAAI,SAAA;AACpC,cAAI,MAAM;AACRD,0BAAAA,MAAI,MAAM,OAAM,gCAA+B,UAAU;AACzD,4BAAgB,QAAQ;AAAA,UACzB;AAAA,QACH,CAAC;AAGD,sBAAc,WAAW,MAAA;AACvBA,wBAAAA,MAAI,MAAM,OAAM,gCAA+B,eAAe;AAC9D,oBAAU,QAAQ;AAAA,QACnB,GAAE,GAAI;AAGP,YAAI,kBAAkB,SAAS,GAAG;AAChCA,wBAAAA,MAAI,MAAM,OAAM,gCAA+B,oBAAoB;AACnE,0BAAgB,QAAQ;AAExB,qBAAW,MAAA;AACT,sBAAU,QAAQ;AAAA,UACnB,GAAE,GAAG;AAAA,QACP;AAAA,MACF,CAAA;AAAA;AAKD,UAAM,cAAc,MAAA;AAClBA,oBAAAA,MAAI,MAAM,OAAM,gCAA+B,wBAAwB;AACvE,sBAAgB,QAAQ;AAGxB,UAAI,aAAa;AACf,qBAAa,WAAW;AACxB,sBAAc;AAAA,MACf;AAGD,iBAAW,MAAA;AACTA,sBAAAA,MAAI,MAAM,OAAM,gCAA+B,YAAY;AAC3D,kBAAU,QAAQ;AAAA,MACnB,GAAE,GAAG;AAAA,IACR;AAKA,UAAM,iBAAiB,MAAA;AACrB,UAAI,CAAC,gBAAgB,OAAO;AAC1BA,sBAAAA,MAAI,MAAM,OAAM,gCAA+B,UAAU;AACzD,eAAM;AAAA,MACP;AAED,iBAAW,MAAM,KAAK,MAAM;AAC5B,iBAAW,MAAA;AACT,mBAAW,MAAM,KAAK,MAAM;AAC5B;MACD,GAAE,GAAI;AAAA,IACT;AAKA,UAAM,kBAAkB,MAAA;AACtBE,oBAAS,UAAC,QAAO;AAAA,IACnB;AAKA,UAAM,UAAU,MAAA;AACd,UAAI,aAAa;AACf,qBAAa,WAAW;AACxB,sBAAc;AAAA,MACf;AAAA,IACH;AAGAC,kBAAAA,UAAU,MAAA;AACRH,oBAAAA,MAAI,MAAM,OAAM,gCAA+B,YAAY;AAC3D;IACF,CAAC;AAGDI,kBAAAA,YAAY,MAAA;AACVJ,oBAAAA,MAAI,MAAM,OAAM,gCAA+B,MAAM;AACrD,UAAI,CAAC,aAAa,OAAO;AACvB;MACD,OAAM;AAEL,YAAI,CAAC,UAAU,OAAO;AACpBA,wBAAAA,MAAI,MAAM,OAAM,gCAA+B,oBAAoB;AACnE,oBAAU,QAAQ;AAAA,QACnB;AAAA,MACF;AAAA,IACH,CAAC;AAGDK,kBAAAA,gBAAgB,MAAA;AACd;IACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;ACtSD,GAAG,WAAWC,SAAe;"}