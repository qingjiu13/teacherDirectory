{"code":"import { defineComponent } from \"vue\";\nimport { mapState, mapActions } from 'vuex';\n/**\n * @description 历史记录侧边栏组件\n * @property {Boolean} visible - 侧边栏是否可见\n * @event {Function} loadChat - 加载聊天历史记录\n * @event {Function} deleteChat - 删除聊天历史记录\n */\nexport default defineComponent({\n    name: \"HistorySidebar\",\n    props: {\n        visible: {\n            type: Boolean,\n            default: false\n        }\n    },\n    computed: Object.assign(Object.assign({}, mapState(new UTSJSONObject({\n        conversations: (state = null) => {\n            try {\n                return state.user && state.user.aiChat && state.user.aiChat.aiChat\n                    ? (state.user.aiChat.aiChat.conversations || [])\n                    : [];\n            }\n            catch (e) {\n                uni.__f__('error', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:61', '获取 conversations 状态出错:', e);\n                return [];\n            }\n        },\n        activeConversation: (state = null) => {\n            try {\n                return state.user && state.user.aiChat && state.user.aiChat.aiChat\n                    ? state.user.aiChat.aiChat.activeConversation\n                    : null;\n            }\n            catch (e) {\n                uni.__f__('error', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:71', '获取 activeConversation 状态出错:', e);\n                return null;\n            }\n        }\n    }))), { \n        /**\n         * @description 历史聊天摘要数组（只包含ID、标题等基本信息）\n         * @returns {Array} 历史聊天摘要数组\n         */\n        historySummaries() {\n            // 添加防御性检查，确保 conversations 存在\n            if (!this.conversations) {\n                uni.__f__('warn', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:84', 'conversations 是 undefined');\n                return [];\n            }\n            try {\n                return this.conversations.map((conv = null) => { return (new UTSJSONObject({\n                    id: conv.id,\n                    abstract: conv.abstract,\n                    chatMode: conv.chatMode,\n                    createdAt: conv.createdAt,\n                    updatedAt: conv.updatedAt\n                })); });\n            }\n            catch (e) {\n                uni.__f__('error', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:97', '处理 historySummaries 出错:', e);\n                return [];\n            }\n        },\n        /**\n         * @description 当前选中的聊天ID\n         * @returns {String} 当前选中的聊天ID\n         */\n        currentChatId() {\n            return this.activeConversation;\n        } }),\n    created() {\n        // 添加调试信息\n        uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:112', '=================== 调试信息开始 ===================');\n        uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:113', '完整的 Vuex store:', this.$store);\n        uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:114', 'Vuex store状态:', this.$store.state);\n        if (this.$store.state.user) {\n            uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:117', 'user模块状态:', this.$store.state.user);\n            if (this.$store.state.user.aiChat) {\n                uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:120', 'aiChat模块状态:', this.$store.state.user.aiChat);\n                if (this.$store.state.user.aiChat.aiChat) {\n                    uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:123', '内层 aiChat:', this.$store.state.user.aiChat.aiChat);\n                    uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:124', '内层 aiChat conversations:', this.$store.state.user.aiChat.aiChat.conversations);\n                }\n                else {\n                    uni.__f__('error', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:126', '无法访问内层 aiChat!');\n                    uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:127', 'aiChat 模块完整内容:', UTS.JSON.stringify(this.$store.state.user.aiChat));\n                }\n            }\n            else {\n                uni.__f__('error', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:130', '无法访问 aiChat 模块!');\n            }\n        }\n        else {\n            uni.__f__('error', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:133', '无法访问 user 模块!');\n        }\n        uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:136', '组件计算的 conversations:', this.conversations);\n        uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:137', '组件计算的 historySummaries:', this.historySummaries);\n        uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:138', '组件计算的 currentChatId:', this.currentChatId);\n        uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:139', '=================== 调试信息结束 ===================');\n    },\n    methods: Object.assign(Object.assign({}, mapActions(new UTSJSONObject({\n        setActiveConversation: 'user/aiChat/setCurrentChat',\n        deleteConversation: 'user/aiChat/deleteChat'\n    }))), { \n        /**\n         * @description 获取对话模式的中文标签\n         * @param {String} mode - 对话模式\n         * @returns {String} 对话模式的中文标签\n         */\n        getModeLabel(mode = null) {\n            const modeLabels = new UTSJSONObject({\n                'general': '通用',\n                'school': '择校',\n                'career': '职业规划'\n            });\n            return modeLabels[mode] || '通用';\n        }, \n        /**\n         * @description 加载聊天历史\n         * @param {String} chatId - 聊天ID\n         */\n        loadChatHistory(chatId = null) {\n            // 通过 Vuex action 设置当前活跃的对话\n            this.setActiveConversation(chatId);\n            // 如果需要加载完整对话内容，还可以添加这个 action 调用\n            // this.$store.dispatch('user/aiChat/loadChat', chatId);\n            // 通知父组件\n            this.$emit('loadChat', chatId);\n        },\n        /**\n         * @description 删除历史记录\n         * @param {String} chatId - 聊天ID\n         * @param {Event} e - 事件对象，用于阻止冒泡\n         */\n        deleteChatHistory(chatId = null, e = null) {\n            // 确保阻止事件冒泡，避免触发点击加载历史记录\n            if (e) {\n                e.stopPropagation();\n                e.preventDefault();\n            }\n            uni.__f__('log', 'at pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue:188', '删除历史记录:', chatId);\n            // 通过 Vuex action 删除对话\n            this.deleteConversation(chatId);\n            // 通知父组件\n            this.$emit('deleteChat', chatId);\n        },\n        /**\n         * @description 格式化时间\n         * @param {Date|String} time - 时间对象或时间字符串\n         * @returns {String} 格式化后的时间字符串\n         */\n        formatTime(time = null) {\n            if (!time)\n                return '';\n            const date = new Date(time);\n            const year = date.getFullYear();\n            const month = String(date.getMonth() + 1).padStart(2, '0');\n            const day = String(date.getDate()).padStart(2, '0');\n            const hours = String(date.getHours()).padStart(2, '0');\n            const minutes = String(date.getMinutes()).padStart(2, '0');\n            return `${year}-${month}-${day} ${hours}:${minutes}`;\n        } })\n});\n//# sourceMappingURL=E:/%E7%A0%94%E5%B8%88%E5%BD%95%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/teacherDirectory/vue%E5%AE%9E%E7%8E%B0Lottie%E5%8A%A8%E7%94%BB%E4%BB%A3%E7%A0%81/pages_AI_Login_Match/AI/ai-chat/HistorySidebar.vue?vue&type=script&lang.uts.js.map","references":["E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/vuex/types/index.d.ts"],"uniExtApis":["uni.__f__"],"map":"{\"version\":3,\"file\":\"HistorySidebar.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"HistorySidebar.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
