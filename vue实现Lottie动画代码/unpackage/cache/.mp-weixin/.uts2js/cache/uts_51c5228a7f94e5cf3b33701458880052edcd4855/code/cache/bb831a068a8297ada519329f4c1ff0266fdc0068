{"code":"import { defineComponent } from \"vue\";\n// 导入date工具\nimport { toTimeText } from '../../common/date.js';\n// 导入emoji工具\nimport emoUtil from '../../common/emotion.js';\n// 导入头像组件\nimport HeadImage from '/pagesChat/components/head-image/head-image';\n// 导入消息类型工具\nimport * as msgType from '/pagesChat/common/messageType.js';\n// 导入消息类型常量\nimport { MESSAGE_TYPE } from '/pagesChat/common/enums.js';\nexport default defineComponent({\n    name: \"chatItem\",\n    components: {\n        HeadImage\n    },\n    data() {\n        return {\n            // 本地消息类型常量\n            MESSAGE_TYPE\n        };\n    },\n    props: {\n        chat: {\n            type: Object\n        },\n        index: {\n            type: Number\n        },\n        active: {\n            type: Boolean,\n            default: false\n        },\n        chatStore: {\n            type: Object,\n            default: null\n        }\n    },\n    // 确保能在模板中使用$msgType\n    beforeCreate() {\n        // 先检查全局属性是否可用\n        if (!this.$msgType) {\n            // 如果不可用，创建一个替代对象\n            this.$msgType = msgType;\n        }\n    },\n    methods: {\n        /**\n         * 格式化时间显示\n         * @param {number} timestamp - 时间戳\n         * @param {boolean} simple - 是否简化显示\n         * @returns {string} 格式化后的时间字符串\n         */\n        formatTime(timestamp = null, simple = null) {\n            return toTimeText(timestamp, simple);\n        },\n        /**\n         * 转换文本中的表情符号\n         * @param {string} content - 包含表情符号的文本\n         * @returns {string} 转换后的HTML字符串\n         */\n        transformEmoji(content = null) {\n            if (!content)\n                return '';\n            return emoUtil.transform(content, 'emoji-img');\n        },\n        showChatBox() {\n            // 初始化期间进入会话会导致消息不刷新\n            if (!getApp().$vm.isInit || (this.chatStore && this.chatStore.isLoading && this.chatStore.isLoading())) {\n                uni.showToast({\n                    title: \"正在初始化页面,请稍后...\",\n                    icon: 'none'\n                });\n                return null;\n            }\n            uni.navigateTo({\n                url: \"/pagesChat/chat-box?chatIdx=\" + this.index\n            });\n        }\n    },\n    computed: {\n        isShowSendName() {\n            if (!this.chat.sendNickName) {\n                return false;\n            }\n            let size = this.chat.messages ? this.chat.messages.length : 0;\n            if (size == 0) {\n                return false;\n            }\n            // 只有群聊的普通消息需要显示名称\n            let lastMsg = this.chat.messages[size - 1];\n            // 使用本地导入的msgType而不是依赖全局属性\n            return msgType.isNormal(lastMsg.type);\n        },\n        atText() {\n            if (this.chat.atMe) {\n                return \"[有人@我]\";\n            }\n            else if (this.chat.atAll) {\n                return \"[@全体成员]\";\n            }\n            return \"\";\n        }\n    }\n});\n//# sourceMappingURL=E:/%E7%A0%94%E5%B8%88%E5%BD%95%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/teacherDirectory/vue%E5%AE%9E%E7%8E%B0Lottie%E5%8A%A8%E7%94%BB%E4%BB%A3%E7%A0%81/pagesChat/components/chat-item/chat-item.vue?vue&type=script&lang.uts.js.map","references":["E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/pagesChat/common/date.js","E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/pagesChat/common/emotion.js"],"uniExtApis":["uni.showToast","uni.navigateTo"],"map":"{\"version\":3,\"file\":\"chat-item.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"chat-item.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\";AACA,WAAW;AACX,OAAO,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAC;AAClD,YAAY;AACZ,OAAO,OAAO,MAAM,yBAAyB,CAAC;AAC9C,SAAS;AACT,OAAO,SAAS,MAAM,6CAA6C,CAAC;AACpE,WAAW;AACX,OAAO,KAAK,OAAO,MAAM,kCAAkC,CAAC;AAC5D,WAAW;AACX,OAAO,EAAE,YAAY,EAAE,MAAM,4BAA4B,CAAC;AAE1D,+BAAe;IACd,IAAI,EAAE,UAAU;IAChB,UAAU,EAAE;QACX,SAAS;KACT;IACD,IAAI;QACH,OAAO;YACN,WAAW;YACX,YAAY;SACZ,CAAA;IACF,CAAC;IACD,KAAK,EAAE;QACN,IAAI,EAAE;YACL,IAAI,EAAE,MAAM;SACZ;QACD,KAAK,EAAE;YACN,IAAI,EAAE,MAAM;SACZ;QACD,MAAM,EAAE;YACP,IAAI,EAAE,OAAO;YACb,OAAO,EAAE,KAAK;SACd;QACD,SAAS,EAAE;YACV,IAAI,EAAE,MAAM;YACZ,OAAO,EAAE,IAAI;SACb;KACD;IACD,oBAAoB;IACpB,YAAY;QACX,cAAc;QACd,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YACnB,iBAAiB;YACjB,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;SACxB;IACF,CAAC;IACD,OAAO,EAAE;QACR;;;;;WAKG;QACH,UAAU,CAAC,SAAS,OAAA,EAAE,MAAM,OAAA;YAC3B,OAAO,UAAU,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;QACtC,CAAC;QAED;;;;WAIG;QACH,cAAc,CAAC,OAAO,OAAA;YACrB,IAAI,CAAC,OAAO;gBAAE,OAAO,EAAE,CAAC;YACxB,OAAO,OAAO,CAAC,SAAS,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC;QAChD,CAAC;QAED,WAAW;YACV,oBAAoB;YACpB,IAAG,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC,EAAC;gBACrG,GAAG,CAAC,SAAS,CAAC;oBACb,KAAK,EAAE,gBAAgB;oBACvB,IAAI,EAAE,MAAM;iBACZ,CAAC,CAAA;gBACF,YAAO;aACP;YACD,GAAG,CAAC,UAAU,CAAC;gBACd,GAAG,EAAE,8BAA8B,GAAG,IAAI,CAAC,KAAK;aAChD,CAAC,CAAA;QACH,CAAC;KACD;IACD,QAAQ,EAAE;QACT,cAAc;YACb,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBAC5B,OAAO,KAAK,CAAC;aACb;YACD,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;YAC9D,IAAI,IAAI,IAAI,CAAC,EAAE;gBACd,OAAO,KAAK,CAAC;aACb;YACD,kBAAkB;YAClB,IAAI,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC;YAC3C,0BAA0B;YAC1B,OAAO,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACvC,CAAC;QACD,MAAM;YACL,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;gBACnB,OAAO,QAAQ,CAAA;aACf;iBAAM,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBAC3B,OAAO,SAAS,CAAA;aAChB;YACD,OAAO,EAAE,CAAC;QACX,CAAC;KACD;CACD,EAAA\"}"}
