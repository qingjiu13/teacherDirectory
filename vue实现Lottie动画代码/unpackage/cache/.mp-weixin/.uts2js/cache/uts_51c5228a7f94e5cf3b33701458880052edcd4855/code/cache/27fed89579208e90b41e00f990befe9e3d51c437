{"code":"import { defineComponent } from \"vue\";\nimport UNI_APP from '/pagesChat/env.js';\nexport default defineComponent({\n    name: \"image-upload\",\n    data() {\n        return {\n            uploadHeaders: new UTSJSONObject({\n                \"accessToken\": uni.getStorageSync('loginInfo').accessToken\n            })\n        };\n    },\n    props: {\n        maxCount: {\n            type: Number,\n            default: 1\n        },\n        maxSize: {\n            type: Number,\n            default: 5 * 1024 * 1024\n        },\n        sourceType: {\n            type: String,\n            default: 'album'\n        },\n        isPermanent: {\n            type: Boolean,\n            default: false\n        },\n        onBefore: {\n            type: Function,\n            default: null\n        },\n        onSuccess: {\n            type: Function,\n            default: null\n        },\n        onError: {\n            type: Function,\n            default: null\n        }\n    },\n    methods: {\n        selectAndUpload() {\n            uni.chooseImage(new UTSJSONObject({\n                count: this.maxCount,\n                sourceType: [this.sourceType],\n                sizeType: ['original'],\n                success: (res) => {\n                    res.tempFiles.forEach((file) => {\n                        if (!this.onBefore || this.onBefore(file)) {\n                            // 调用上传图片的接口\n                            this.uploadImage(file);\n                        }\n                    });\n                }\n            }));\n        },\n        uploadImage(file = null) {\n            uni.uploadFile({\n                url: UNI_APP.BASE_URL + '/image/upload?isPermanent=' + this.isPermanent,\n                header: new UTSJSONObject({\n                    accessToken: uni.getStorageSync(\"loginInfo\").accessToken\n                }),\n                filePath: file.path,\n                name: 'file',\n                success: (res) => {\n                    let data = UTS.JSON.parse(res.data);\n                    if (data.code != 200) {\n                        uni.showToast({\n                            icon: \"none\",\n                            title: data.message,\n                        });\n                        this.onError && this.onError(file, data);\n                    }\n                    else {\n                        this.onSuccess && this.onSuccess(file, data);\n                    }\n                },\n                fail: (err) => {\n                    uni.__f__('log', 'at pagesChat/components/image-upload/image-upload.vue:87', err);\n                    this.onError && this.onError(file, err);\n                }\n            });\n        }\n    }\n});\n//# sourceMappingURL=E:/%E7%A0%94%E5%B8%88%E5%BD%95%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/teacherDirectory/vue%E5%AE%9E%E7%8E%B0Lottie%E5%8A%A8%E7%94%BB%E4%BB%A3%E7%A0%81/pagesChat/components/image-upload/image-upload.vue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.getStorageSync","uni.chooseImage","uni.uploadFile","uni.showToast","uni.__f__"],"map":"{\"version\":3,\"file\":\"image-upload.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"image-upload.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\";AACA,OAAO,OAAO,MAAM,mBAAmB,CAAA;AAEvC,+BAAe;IACd,IAAI,EAAE,cAAc;IACpB,IAAI;QACH,OAAO;YACN,aAAa,oBAAE;gBACd,aAAa,EAAE,GAAG,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,WAAW;aAC1D,CAAA;SACD,CAAA;IACF,CAAC;IACD,KAAK,EAAE;QACN,QAAQ,EAAE;YACT,IAAI,EAAE,MAAM;YACZ,OAAO,EAAE,CAAC;SACV;QACD,OAAO,EAAE;YACR,IAAI,EAAE,MAAM;YACZ,OAAO,EAAE,CAAC,GAAG,IAAI,GAAG,IAAI;SACxB;QACD,UAAU,EAAE;YACX,IAAI,EAAE,MAAM;YACZ,OAAO,EAAE,OAAO;SAChB;QACD,WAAW,EAAE;YACZ,IAAI,EAAE,OAAO;YACb,OAAO,EAAE,KAAK;SACd;QACD,QAAQ,EAAE;YACT,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE,IAAI;SACb;QACD,SAAS,EAAE;YACV,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE,IAAI;SACb;QACD,OAAO,EAAE;YACR,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE,IAAI;SACb;KACD;IACD,OAAO,EAAE;QACR,eAAe;YACd,GAAG,CAAC,WAAW,mBAAC;gBACf,KAAK,EAAE,IAAI,CAAC,QAAQ;gBACpB,UAAU,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC;gBAC7B,QAAQ,EAAE,CAAC,UAAU,CAAC;gBACtB,OAAO,EAAE,CAAC,GAAG;oBACZ,GAAG,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI;wBAC1B,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;4BAC1C,YAAY;4BACZ,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;yBACvB;oBACF,CAAC,CAAC,CAAA;gBACH,CAAC;aACD,EAAC,CAAA;QACH,CAAC;QACD,WAAW,CAAC,IAAI,OAAA;YACf,GAAG,CAAC,UAAU,CAAC;gBACd,GAAG,EAAE,OAAO,CAAC,QAAQ,GAAG,4BAA4B,GAAG,IAAI,CAAC,WAAW;gBACvE,MAAM,oBAAE;oBACP,WAAW,EAAE,GAAG,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,WAAW;iBACxD,CAAA;gBACD,QAAQ,EAAE,IAAI,CAAC,IAAI;gBACnB,IAAI,EAAE,MAAM;gBACZ,OAAO,EAAE,CAAC,GAAG;oBACZ,IAAI,IAAI,GAAG,SAAK,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;oBAChC,IAAI,IAAI,CAAC,IAAI,IAAI,GAAG,EAAE;wBACrB,GAAG,CAAC,SAAS,CAAC;4BACb,IAAI,EAAE,MAAM;4BACZ,KAAK,EAAE,IAAI,CAAC,OAAO;yBACnB,CAAC,CAAA;wBACF,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;qBACzC;yBAAM;wBACN,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;qBAC7C;gBACF,CAAC;gBACD,IAAI,EAAE,CAAC,GAAG;oBACT,GAAG,CAAC,KAAK,CAAC,KAAK,EAAC,0DAA0D,EAAC,GAAG,CAAC,CAAC;oBAChF,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;gBACzC,CAAC;aACD,CAAC,CAAA;QACH,CAAC;KACD;CACD,EAAA\"}"}
