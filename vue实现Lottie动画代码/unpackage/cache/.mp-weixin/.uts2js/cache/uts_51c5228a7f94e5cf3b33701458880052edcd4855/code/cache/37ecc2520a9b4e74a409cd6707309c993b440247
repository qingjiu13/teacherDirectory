{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent as _defineComponent } from 'vue';\nimport { resolveComponent as _resolveComponent, o as _o, sr as _sr, p as _p, toDisplayString as _toDisplayString, t as _t, gei as _gei, sei as _sei, e as _e } from \"vue\";\nconst __BINDING_COMPONENTS__ = '{\"c-lottie\":{\"name\":\"_easycom_c_lottie\",\"type\":\"unknown\"}}';\nif (!Array) {\n    const _easycom_c_lottie_1 = _resolveComponent(\"c-lottie\");\n    (_easycom_c_lottie_1)();\n}\nimport _easycom_c_lottie from 'E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/uni_modules/c-lottie/components/c-lottie/c-lottie.vue';\nif (!Math) {\n    (_easycom_c_lottie)();\n}\nimport { ref, onMounted, computed, watch, onBeforeUnmount } from 'vue';\nimport { useAnimationCache } from './useAnimationCache.js';\n/**\n * @typedef {Object} LoadingAnimationProps\n * @property {String} src - 动画源文件地址\n * @property {String} width - 动画宽度\n * @property {String} height - 动画高度\n * @property {Boolean} autoPlay - 是否自动播放\n * @property {Boolean} showText - 是否显示加载文字\n * @property {String} text - 加载文字内容\n */\n/**\n * 组件属性\n * @type {LoadingAnimationProps}\n */\nexport default /*#__PURE__*/ _defineComponent({\n    __name: 'LoadingAnimation',\n    props: {\n        src: new UTSJSONObject({\n            type: String,\n            default: 'https://lottie.host/1f64310d-d1a9-44c9-ac77-3c29ae849559/c3yfKGAzCm.json'\n        }),\n        width: new UTSJSONObject({\n            type: String,\n            default: '200rpx'\n        }),\n        height: new UTSJSONObject({\n            type: String,\n            default: '200rpx'\n        }),\n        autoPlay: new UTSJSONObject({\n            type: Boolean,\n            default: true\n        }),\n        showText: new UTSJSONObject({\n            type: Boolean,\n            default: true\n        }),\n        text: new UTSJSONObject({\n            type: String,\n            default: '加载中...'\n        })\n    },\n    emits: ['mounted', 'dataReady', 'error', 'timeout'],\n    setup(__props, _a) {\n        var __expose = _a.expose, __emit = _a.emit;\n        const props = __props;\n        /**\n         * 组件事件\n         * @type {Object}\n         */\n        const emit = __emit;\n        // 组件内部状态\n        const lottieRef = ref(null);\n        const visible = ref(false);\n        const animationSrc = ref(props.src);\n        const isLoaded = ref(false);\n        const isPlaying = ref(false);\n        const loadingTimeout = ref(null);\n        // 使用动画缓存功能\n        const _b = useAnimationCache(), isAnimationCached = _b.isAnimationCached, loadAnimationData = _b.loadAnimationData, getAnimationFromCache = _b.getAnimationFromCache, getAnimationStats = _b.getAnimationStats;\n        /**\n         * 显示加载动画\n         */\n        const show = () => {\n            if (!isLoaded.value) {\n                preload();\n            }\n            visible.value = true;\n            if (lottieRef.value && isLoaded.value) {\n                lottieRef.value.call('play');\n                isPlaying.value = true;\n            }\n        };\n        /**\n         * 隐藏加载动画\n         */\n        const hide = () => {\n            visible.value = false;\n            if (lottieRef.value && isPlaying.value) {\n                lottieRef.value.call('stop');\n                isPlaying.value = false;\n            }\n        };\n        /**\n         * 预加载动画资源\n         * @returns {Promise<boolean>} 预加载结果\n         */\n        const preload = () => { return __awaiter(this, void 0, void 0, function* () {\n            if (isLoaded.value) {\n                return true;\n            }\n            try {\n                // 设置加载超时处理\n                if (loadingTimeout.value) {\n                    clearTimeout(loadingTimeout.value);\n                }\n                loadingTimeout.value = setTimeout(() => {\n                    uni.__f__('warn', 'at components/loading/LoadingAnimation.vue:128', '动画加载超时', animationSrc.value);\n                    emit('timeout', animationSrc.value);\n                }, 5000);\n                // 预加载动画数据\n                const animationData = yield loadAnimationData(animationSrc.value);\n                if (animationData) {\n                    if (loadingTimeout.value) {\n                        clearTimeout(loadingTimeout.value);\n                        loadingTimeout.value = null;\n                    }\n                    isLoaded.value = true;\n                    return true;\n                }\n                return false;\n            }\n            catch (error) {\n                uni.__f__('error', 'at components/loading/LoadingAnimation.vue:147', '预加载动画失败', error);\n                emit('error', error);\n                if (loadingTimeout.value) {\n                    clearTimeout(loadingTimeout.value);\n                    loadingTimeout.value = null;\n                }\n                return false;\n            }\n        }); };\n        /**\n         * 动画数据准备完成回调\n         */\n        const onDataReady = () => {\n            uni.__f__('log', 'at components/loading/LoadingAnimation.vue:163', '动画数据准备完成');\n            isLoaded.value = true;\n            if (loadingTimeout.value) {\n                clearTimeout(loadingTimeout.value);\n                loadingTimeout.value = null;\n            }\n            emit('dataReady');\n            // 如果当前应该显示动画，则播放\n            if (visible.value && !isPlaying.value) {\n                lottieRef.value.call('play');\n                isPlaying.value = true;\n            }\n        };\n        /**\n         * 监听src属性变化\n         */\n        watch(() => { return props.src; }, (newSrc) => {\n            if (newSrc !== animationSrc.value) {\n                animationSrc.value = newSrc;\n                isLoaded.value = false;\n                // 如果当前正在显示，需要重新加载\n                if (visible.value) {\n                    preload();\n                }\n            }\n        });\n        /**\n         * 提供给外部的组件方法\n         */\n        __expose(new UTSJSONObject({\n            show,\n            hide,\n            preload,\n            isLoaded: computed(() => { return isLoaded.value; }),\n            isPlaying: computed(() => { return isPlaying.value; }),\n            lottieRef,\n            getAnimationStats\n        }));\n        // 组件挂载时预加载\n        onMounted(() => {\n            uni.__f__('log', 'at components/loading/LoadingAnimation.vue:210', '加载动画组件已挂载');\n            // 检查是否已缓存\n            if (isAnimationCached(animationSrc.value)) {\n                uni.__f__('log', 'at components/loading/LoadingAnimation.vue:214', '动画已缓存，直接标记为已加载');\n                isLoaded.value = true;\n            }\n            else {\n                // 自动预加载但不显示\n                preload().then(() => {\n                    uni.__f__('log', 'at components/loading/LoadingAnimation.vue:219', '动画预加载完成', isLoaded.value);\n                });\n            }\n            emit('mounted');\n        });\n        // 组件卸载前清理\n        onBeforeUnmount(() => {\n            if (loadingTimeout.value) {\n                clearTimeout(loadingTimeout.value);\n                loadingTimeout.value = null;\n            }\n            // 停止播放\n            if (lottieRef.value && isPlaying.value) {\n                lottieRef.value.call('stop');\n                isPlaying.value = false;\n            }\n        });\n        return (_ctx = null, _cache = null) => {\n            const __returned__ = _e(new UTSJSONObject({\n                a: _sr(lottieRef, 'f6494e84-0', new UTSJSONObject({\n                    \"k\": \"lottieRef\"\n                })),\n                b: _o(onDataReady),\n                c: _p(new UTSJSONObject({\n                    src: animationSrc.value,\n                    width: __props.width,\n                    height: __props.height,\n                    loop: true,\n                    autoPlay: __props.autoPlay\n                })),\n                d: __props.showText\n            }), __props.showText ? new UTSJSONObject({\n                e: _t(__props.text)\n            }) : new UTSJSONObject({}), new UTSJSONObject({\n                f: _sei(_gei(_ctx, ''), 'view'),\n                g: visible.value ? 1 : ''\n            }));\n            return __returned__;\n        };\n    }\n});\n//# sourceMappingURL=E:/%E7%A0%94%E5%B8%88%E5%BD%95%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/teacherDirectory/vue%E5%AE%9E%E7%8E%B0Lottie%E5%8A%A8%E7%94%BB%E4%BB%A3%E7%A0%81/components/loading/LoadingAnimation.vue?vue&type=script&setup=true&lang.uts.js.map","references":["E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/uni_modules/c-lottie/components/c-lottie/c-lottie.vue.ts","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/components/loading/useAnimationCache.js"],"uniExtApis":["uni.__f__"],"map":"{\"version\":3,\"file\":\"LoadingAnimation.vue?vue&type=script&setup=true&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"LoadingAnimation.vue?vue&type=script&setup=true&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
