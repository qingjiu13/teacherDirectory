{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent as _defineComponent } from 'vue';\nimport { o as _o, sr as _sr, p as _p, gei as _gei, sei as _sei, s as _s } from \"vue\";\nconst __BINDING_COMPONENTS__ = '{\"LoadingAnimation\":{\"name\":\"LoadingAnimation\",\"type\":\"setup\"}}';\nif (!Math) {\n    (LoadingAnimation)();\n}\nimport { ref, computed, onMounted, provide, onBeforeUnmount } from 'vue';\nimport LoadingAnimation from './LoadingAnimation.vue';\nimport { useGlobalAnimationState } from './useAnimationCache.js';\n/**\n * @typedef {Object} GlobalLoadingProps\n * @property {String} src - 动画源文件地址\n * @property {String} width - 动画宽度\n * @property {String} height - 动画高度\n * @property {Boolean} fullscreen - 是否全屏显示\n * @property {Boolean} transparent - 背景是否透明\n * @property {String} backgroundColor - 背景颜色\n * @property {Boolean} autoPlay - 是否自动播放\n * @property {Boolean} preload - 是否预加载\n * @property {Boolean} showText - 是否显示加载文字\n * @property {String} text - 加载文字内容\n * @property {Number} zIndex - 层级\n */\n/**\n * 组件属性\n * @type {GlobalLoadingProps}\n */\nexport default /*#__PURE__*/ _defineComponent({\n    __name: 'GlobalLoading',\n    props: {\n        src: new UTSJSONObject({\n            type: String,\n            default: 'https://lottie.host/1f64310d-d1a9-44c9-ac77-3c29ae849559/c3yfKGAzCm.json'\n        }),\n        width: new UTSJSONObject({\n            type: String,\n            default: '200rpx'\n        }),\n        height: new UTSJSONObject({\n            type: String,\n            default: '200rpx'\n        }),\n        fullscreen: new UTSJSONObject({\n            type: Boolean,\n            default: true\n        }),\n        transparent: new UTSJSONObject({\n            type: Boolean,\n            default: false\n        }),\n        backgroundColor: new UTSJSONObject({\n            type: String,\n            default: 'rgba(255, 255, 255, 0.9)'\n        }),\n        autoPlay: new UTSJSONObject({\n            type: Boolean,\n            default: true\n        }),\n        preload: new UTSJSONObject({\n            type: Boolean,\n            default: true\n        }),\n        showText: new UTSJSONObject({\n            type: Boolean,\n            default: true\n        }),\n        text: new UTSJSONObject({\n            type: String,\n            default: '加载中...'\n        }),\n        zIndex: new UTSJSONObject({\n            type: Number,\n            default: 9999\n        })\n    },\n    emits: ['mounted', 'dataReady', 'error', 'timeout'],\n    setup(__props, _a) {\n        var __expose = _a.expose, __emit = _a.emit;\n        const props = __props;\n        /**\n         * 组件事件\n         * @type {Object}\n         */\n        const emit = __emit;\n        // 组件内部状态\n        const loadingRef = ref(null);\n        const visible = ref(false);\n        const isPreloaded = ref(false);\n        // 获取全局动画状态\n        const _b = useGlobalAnimationState(), globalState = _b.globalState, getGlobalStats = _b.getGlobalStats, isAllAnimationsLoaded = _b.isAllAnimationsLoaded;\n        /**\n         * 计算包装器样式\n         */\n        const wrapperStyle = computed(() => {\n            return new UTSJSONObject({\n                backgroundColor: props.transparent ? 'transparent' : props.backgroundColor,\n                zIndex: props.zIndex\n            });\n        });\n        /**\n         * 显示加载动画\n         */\n        const show = () => {\n            visible.value = true;\n            if (loadingRef.value) {\n                loadingRef.value.show();\n            }\n        };\n        /**\n         * 隐藏加载动画\n         */\n        const hide = () => {\n            visible.value = false;\n            if (loadingRef.value) {\n                loadingRef.value.hide();\n            }\n        };\n        /**\n         * 预加载动画资源\n         * @returns {Promise<boolean>} 预加载结果\n         */\n        const preload = () => { return __awaiter(this, void 0, void 0, function* () {\n            if (isPreloaded.value) {\n                return true;\n            }\n            try {\n                if (loadingRef.value) {\n                    const result = yield loadingRef.value.preload();\n                    if (result) {\n                        isPreloaded.value = true;\n                    }\n                    return result;\n                }\n                return false;\n            }\n            catch (error) {\n                uni.__f__('error', 'at components/loading/GlobalLoading.vue:157', '预加载全局动画失败', error);\n                return false;\n            }\n        }); };\n        /**\n         * 获取动画组件\n         * @returns {Object|null} 动画组件实例\n         */\n        const getLottieRef = () => {\n            if (loadingRef.value && loadingRef.value.lottieRef) {\n                return loadingRef.value.lottieRef.value;\n            }\n            return null;\n        };\n        /**\n         * 获取动画统计信息\n         * @returns {Object} 统计信息\n         */\n        const getAnimationStats = () => {\n            return getGlobalStats();\n        };\n        /**\n         * 动画数据准备完成回调\n         */\n        const onDataReady = () => {\n            isPreloaded.value = true;\n            emit('dataReady');\n        };\n        /**\n         * 处理错误\n         * @param {Error} error - 错误信息\n         */\n        const onError = (error = null) => {\n            emit('error', error);\n        };\n        /**\n         * 处理超时\n         * @param {String} src - 动画源\n         */\n        const onTimeout = (src = null) => {\n            emit('timeout', src);\n        };\n        /**\n         * 动画组件挂载完成\n         */\n        const onMounted = () => {\n            // 如果设置了预加载，则自动预加载\n            if (props.preload) {\n                preload();\n            }\n            emit('mounted');\n        };\n        /**\n         * 提供给外部的组件方法\n         */\n        __expose(new UTSJSONObject({\n            show,\n            hide,\n            preload,\n            isPreloaded: computed(() => { return isPreloaded.value; }),\n            getLottieRef,\n            getAnimationStats\n        }));\n        // 全局状态注入\n        provide('globalLoading', new UTSJSONObject({\n            show,\n            hide,\n            preload,\n            isPreloaded: computed(() => { return isPreloaded.value; }),\n            stats: getGlobalStats\n        }));\n        // 组件挂载\n        onMounted(() => {\n            // 注册全局实例\n            const globalApp = getApp();\n            if (globalApp) {\n                globalApp.globalData = globalApp.globalData || new UTSJSONObject({}\n                // 更新全局$loading对象\n                );\n                // 更新全局$loading对象\n                globalApp.globalData.$loading = new UTSJSONObject({\n                    show,\n                    hide,\n                    preload,\n                    isPreloaded: new UTSJSONObject({ value: isPreloaded.value }),\n                    getStatus: getAnimationStats,\n                    globalState,\n                    isReady: true,\n                    componentMounted: true\n                });\n                uni.__f__('log', 'at components/loading/GlobalLoading.vue:257', '全局$loading对象已更新');\n            }\n        });\n        // 组件卸载\n        onBeforeUnmount(() => {\n            // 清理全局引用\n            const globalApp = getApp();\n            if (globalApp && globalApp.globalData && globalApp.globalData.$loading) {\n                // 保留引用但标记为未挂载\n                globalApp.globalData.$loading.componentMounted = false;\n            }\n        });\n        return (_ctx = null, _cache = null) => {\n            const __returned__ = {\n                a: _sr(loadingRef, '52456a73-0', {\n                    \"k\": \"loadingRef\"\n                }),\n                b: _o(onDataReady),\n                c: _o(onError),\n                d: _o(onTimeout),\n                e: _o(onMounted),\n                f: _p({\n                    src: __props.src,\n                    width: __props.width,\n                    height: __props.height,\n                    showText: __props.showText,\n                    text: __props.text,\n                    autoPlay: __props.autoPlay\n                }),\n                g: _sei(_gei(_ctx, ''), 'view'),\n                h: _s(wrapperStyle.value),\n                i: visible.value ? 1 : '',\n                j: __props.fullscreen ? 1 : ''\n            };\n            return __returned__;\n        };\n    }\n});\n//# sourceMappingURL=E:/%E7%A0%94%E5%B8%88%E5%BD%95%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/teacherDirectory/vue%E5%AE%9E%E7%8E%B0Lottie%E5%8A%A8%E7%94%BB%E4%BB%A3%E7%A0%81/components/loading/GlobalLoading.vue?vue&type=script&setup=true&lang.uts.js.map","references":["E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/node_modules/@vue/runtime-core/dist/runtime-core.d.ts","E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/components/loading/LoadingAnimation.vue.ts","E:/研师录与其他人共享文件/teacherDirectory/vue实现Lottie动画代码/components/loading/useAnimationCache.js"],"uniExtApis":["uni.__f__"],"map":"{\"version\":3,\"file\":\"GlobalLoading.vue?vue&type=script&setup=true&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"GlobalLoading.vue?vue&type=script&setup=true&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
