{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\n/**\n * @description AI择校第二步页面\n */\nimport { aiSelectionApis } from '../../../config.js';\nimport callCloudFunction from '../../../utils/cloudFunction.js';\nexport default defineComponent({\n    name: 'AISelectionStep2',\n    data() {\n        return {\n            selectedSchool: '',\n            selectedMajor: '',\n            showSchoolList: false,\n            showMajorList: false,\n            searchText: '',\n            searchMajorText: '',\n            schools: [],\n            majors: [],\n            // 添加本地备用数据，防止云函数失败\n            localSchools: [\n                '北京大学', '清华大学', '复旦大学', '上海交通大学', '浙江大学',\n                '南京大学', '中国人民大学', '武汉大学', '中山大学', '华中科技大学',\n                '北京师范大学', '厦门大学', '南开大学', '吉林大学', '西安交通大学',\n                '哈尔滨工业大学', '电子科技大学', '东南大学', '四川大学', '中南大学'\n            ],\n            localMajors: [\n                '计算机科学与技术', '软件工程', '人工智能', '数据科学与大数据技术',\n                '网络空间安全', '电子信息工程', '通信工程', '自动化', '机械工程',\n                '土木工程', '建筑学', '工商管理', '会计学', '金融学', '经济学',\n                '法学', '医学', '生物科学', '化学', '物理学', '数学', '英语',\n                '汉语言文学', '新闻学', '心理学', '教育学'\n            ]\n        };\n    },\n    computed: {\n        /**\n         * @description 过滤后的学校列表\n         * @returns {Array} 过滤后的学校列表\n         */\n        filteredSchools() {\n            if (!this.searchText)\n                return this.schools.length > 0 ? this.schools : this.localSchools;\n            const keyword = this.searchText.toLowerCase();\n            return (this.schools.length > 0 ? this.schools : this.localSchools).filter(school => { return school.toLowerCase().includes(keyword); });\n        },\n        /**\n         * @description 过滤后的专业列表\n         * @returns {Array} 过滤后的专业列表\n         */\n        filteredMajors() {\n            if (!this.searchMajorText)\n                return this.majors.length > 0 ? this.majors : this.localMajors;\n            const keyword = this.searchMajorText.toLowerCase();\n            return (this.majors.length > 0 ? this.majors : this.localMajors).filter(major => { return major.toLowerCase().includes(keyword); });\n        }\n    },\n    onLoad() {\n        this.loadSchools();\n        // 检查是否有保存的数据，如果有则回显\n        const savedSchool = uni.getStorageSync('step2_school');\n        const savedMajor = uni.getStorageSync('step2_major');\n        if (savedSchool) {\n            this.selectedSchool = savedSchool;\n            this.searchText = savedSchool;\n        }\n        if (savedMajor) {\n            this.selectedMajor = savedMajor;\n            this.searchMajorText = savedMajor;\n        }\n    },\n    methods: {\n        /**\n         * @description 加载学校列表\n         */\n        loadSchools() {\n            return __awaiter(this, void 0, void 0, function* () {\n                try {\n                    uni.showLoading({\n                        title: '加载中...'\n                    });\n                    const result = yield callCloudFunction(new UTSJSONObject({\n                        name: aiSelectionApis.getSchools,\n                        data: new UTSJSONObject({}),\n                        timeout: 10000 // 增加超时时间\n                    })).catch((err = null) => {\n                        uni.__f__('error', 'at pages/AI/selection/step2.uvue:160', '获取学校列表失败:', err);\n                        return new UTSJSONObject({ result: new UTSJSONObject({ code: -1, msg: err.message }) });\n                    });\n                    uni.hideLoading();\n                    if (result.result && result.result.code === 0) {\n                        this.schools = result.result.data || [];\n                        uni.__f__('log', 'at pages/AI/selection/step2.uvue:168', '获取到学校列表:', this.schools);\n                    }\n                    else {\n                        uni.__f__('warn', 'at pages/AI/selection/step2.uvue:170', '使用本地学校列表');\n                        this.schools = this.localSchools;\n                    }\n                }\n                catch (e) {\n                    uni.hideLoading();\n                    uni.__f__('error', 'at pages/AI/selection/step2.uvue:175', '加载学校列表异常:', e);\n                    // 使用本地备用数据\n                    this.schools = this.localSchools;\n                }\n            });\n        },\n        /**\n         * @description 选择学校\n         * @param {String} school - 选择的学校\n         */\n        selectSchool(school = null) {\n            this.selectedSchool = school;\n            this.searchText = school;\n            this.showSchoolList = false;\n            uni.setStorageSync('step2_school', school);\n        },\n        /**\n         * @description 加载专业列表\n         */\n        loadMajors() {\n            return __awaiter(this, void 0, void 0, function* () {\n                try {\n                    if (!this.selectedSchool) {\n                        return Promise.resolve(null);\n                    }\n                    uni.showLoading({\n                        title: '加载中...'\n                    });\n                    const result = yield callCloudFunction(new UTSJSONObject({\n                        name: aiSelectionApis.getUndergraduateMajors,\n                        data: new UTSJSONObject({\n                            school: this.selectedSchool // 传入学校参数\n                        }),\n                        timeout: 10000 // 增加超时时间\n                    })).catch((err = null) => {\n                        uni.__f__('error', 'at pages/AI/selection/step2.uvue:212', '获取专业列表失败:', err);\n                        return new UTSJSONObject({ result: new UTSJSONObject({ code: -1, msg: err.message }) });\n                    });\n                    uni.hideLoading();\n                    if (result.result && result.result.code === 0) {\n                        // 本科专业列表是简单的字符串数组\n                        this.majors = result.result.data || [];\n                        uni.__f__('log', 'at pages/AI/selection/step2.uvue:221', '获取到专业列表:', this.majors);\n                    }\n                    else {\n                        uni.__f__('warn', 'at pages/AI/selection/step2.uvue:223', '使用本地专业列表');\n                        this.majors = this.localMajors;\n                    }\n                }\n                catch (e) {\n                    uni.hideLoading();\n                    uni.__f__('error', 'at pages/AI/selection/step2.uvue:228', '加载专业列表异常:', e);\n                    // 使用本地备用数据\n                    this.majors = this.localMajors;\n                }\n            });\n        },\n        /**\n         * @description 选择专业\n         * @param {String} major - 选择的专业\n         */\n        selectMajor(major = null) {\n            this.selectedMajor = major;\n            this.searchMajorText = major;\n            this.showMajorList = false;\n            uni.setStorageSync('step2_major', major);\n        },\n        /**\n         * @description 返回上一步\n         */\n        prevPage() {\n            uni.navigateBack();\n        },\n        /**\n         * @description 进入下一步\n         */\n        nextPage() {\n            if (!this.selectedSchool) {\n                uni.showToast({\n                    title: '请选择您的本科院校',\n                    icon: 'none'\n                });\n                return null;\n            }\n            if (!this.selectedMajor) {\n                uni.showToast({\n                    title: '请选择您的本科专业',\n                    icon: 'none'\n                });\n                return null;\n            }\n            // 保存数据\n            this.formData.university = this.selectedSchool;\n            this.formData.major = this.selectedMajor;\n            uni.setStorageSync('step2_data', new UTSJSONObject({\n                university: this.selectedSchool,\n                major: this.selectedMajor\n            }));\n            // 导航到下一步\n            uni.navigateTo({\n                url: '/pages/AI/selection/step3'\n            });\n        }\n    }\n});\n//# sourceMappingURL=E:/yanshilu%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AFyanshilu/pages/AI/selection/step2.uvue?vue&type=script&lang.uts.js.map","references":["E:/yanshilu小程序前端/前端yanshilu/config.js","E:/yanshilu小程序前端/前端yanshilu/utils/cloudFunction.js"],"uniExtApis":["uni.getStorageSync","uni.showLoading","uni.__f__","uni.hideLoading","uni.setStorageSync","uni.navigateBack","uni.showToast","uni.navigateTo"],"map":"{\"version\":3,\"file\":\"step2.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"step2.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
