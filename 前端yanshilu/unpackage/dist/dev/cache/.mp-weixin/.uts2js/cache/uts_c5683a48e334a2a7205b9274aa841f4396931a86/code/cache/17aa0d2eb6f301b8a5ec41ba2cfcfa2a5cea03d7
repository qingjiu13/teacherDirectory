{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\n/**\n * @description AI择校第六步页面\n */\nimport { aiSelectionApis } from '../../../config.js';\nexport default defineComponent({\n    data() {\n        return {\n            areaA: ['北京市', '上海市', '浙江省', '江苏省', '湖北省', '广东省', '吉林省', '天津市'],\n            areaB: ['四川省', '安徽省', '陕西省', '黑龙江省', '湖南省', '山东省', '福建省', '辽宁省',\n                '重庆市', '河南省', '江西省', '山西省'],\n            selectedAreas: []\n        };\n    },\n    onLoad() {\n        // 检查是否有已保存的数据\n        const savedAreas = uni.getStorageSync('step6_areas');\n        if (savedAreas && Array.isArray(savedAreas)) {\n            this.selectedAreas = savedAreas;\n        }\n    },\n    methods: {\n        /**\n         * @description 切换选择区域\n         * @param {String} area - 区域名称\n         */\n        toggleArea(area = null) {\n            const index = this.selectedAreas.indexOf(area);\n            if (index === -1) {\n                this.selectedAreas.push(area);\n            }\n            else {\n                this.selectedAreas.splice(index, 1);\n            }\n            // 保存到本地存储\n            uni.setStorageSync('step6_areas', this.selectedAreas);\n        },\n        /**\n         * @description 返回上一步\n         */\n        prevPage() {\n            uni.navigateBack();\n        },\n        /**\n         * @description 提交数据，开始分析\n         */\n        submitData() {\n            var _a;\n            return __awaiter(this, void 0, void 0, function* () {\n                if (this.selectedAreas.length === 0) {\n                    uni.showToast({\n                        title: '请至少选择一个目标省份',\n                        icon: 'none'\n                    });\n                    return Promise.resolve(null);\n                }\n                try {\n                    uni.showLoading({\n                        title: '准备分析...'\n                    });\n                    // 从本地存储获取之前步骤的数据\n                    const formData = new UTSJSONObject({\n                        identity: uni.getStorageSync('step1_data') || '',\n                        university: uni.getStorageSync('step2_school') || '',\n                        major: uni.getStorageSync('step2_major') || '',\n                        englishLevel: uni.getStorageSync('step3_english') || '',\n                        ranking: uni.getStorageSync('step3_ranking') || '',\n                        targetMajor: uni.getStorageSync('step4_major') || '',\n                        studyMode: uni.getStorageSync('step4_mode') || '',\n                        targetType: uni.getStorageSync('step5_target') || '',\n                        considerResearch: uni.getStorageSync('step5_research') || '',\n                        targetAreas: this.selectedAreas\n                    });\n                    uni.__f__('log', 'at pages/ai/selection/step6.uvue:123', '提交数据:', formData);\n                    // 先保存分析请求\n                    const saveResult = yield uniCloud.callFunction({\n                        name: aiSelectionApis.saveAnalysisRequest,\n                        data: new UTSJSONObject({\n                            formData: formData\n                        }),\n                        timeout: 10000 // 增加超时时间到10秒\n                    });\n                    uni.hideLoading();\n                    if (saveResult.result && saveResult.result.code === 0) {\n                        const analysisId = saveResult.result.data.id;\n                        // 直接跳转到分析中页面，不等待分析完成\n                        uni.navigateTo({\n                            url: '/pages/ai/selection/analyzing?id=' + analysisId\n                        });\n                        // 后台开始实际的AI分析过程\n                        uniCloud.callFunction({\n                            name: aiSelectionApis.startAnalysis,\n                            data: new UTSJSONObject({ id: analysisId }),\n                            success: (res = null) => {\n                                uni.__f__('log', 'at pages/ai/selection/step6.uvue:149', '分析开始:', res);\n                            },\n                            fail: (err = null) => {\n                                uni.__f__('error', 'at pages/ai/selection/step6.uvue:152', '启动分析失败:', err);\n                            }\n                        });\n                    }\n                    else {\n                        throw new Error(((_a = saveResult.result) === null || _a === void 0 ? void 0 : _a.msg) || '准备分析失败');\n                    }\n                }\n                catch (e) {\n                    uni.hideLoading();\n                    uni.showModal({\n                        title: '提示',\n                        content: e.message || '准备分析失败，请重试',\n                        showCancel: false\n                    });\n                }\n            });\n        }\n    }\n});\n//# sourceMappingURL=E:/%E7%A0%94%E5%B8%88%E5%BD%95%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/teacherDirectory/%E5%89%8D%E7%AB%AFyanshilu/pages/ai/selection/step6.uvue?vue&type=script&lang.uts.js.map","references":["E:/研师录与其他人共享文件/teacherDirectory/前端yanshilu/config.js"],"uniExtApis":["uni.getStorageSync","uni.setStorageSync","uni.navigateBack","uni.showToast","uni.showLoading","uni.__f__","uniCloud.callFunction","uni.hideLoading","uni.navigateTo","uni.showModal"],"map":"{\"version\":3,\"file\":\"step6.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"step6.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
