{"version":3,"file":"mine.js","sources":["pages/mine/mine.uvue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWluZS9taW5lLnV2dWU"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<!-- 用户信息区 -->\n\t\t<view class=\"user-info\">\n\t\t\t<view class=\"user-info-row\">\n\t\t\t\t<image class=\"avatar\" :src=\"userInfo ? userInfo.avatarUrl || '/static/image/default_avatar.png' : '/static/image/default_avatar.png'\" mode=\"aspectFill\" @click=\"handleAvatarClick\"></image>\n\t\t\t\t<view class=\"login-tag-container\">\n\t\t\t\t\t<text class=\"login-text\" @click=\"handleLoginClick\">{{ userInfo ? userInfo.nickname || '用户' : '登录' }}</text>\n\t\t\t\t\t<view class=\"tag-btn\" v-if=\"userInfo\">\n\t\t\t\t\t\t<text>{{ userInfo.tag || '标签' }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"tag-btn\" v-else>\n\t\t\t\t\t\t<text>标签</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 用户数据 -->\n\t\t<view class=\"user-stats\">\n\t\t\t<view class=\"stats-row\" @click=\"goToMyPosts\">\n\t\t\t\t<text class=\"stats-num\">{{ userInfo ? userInfo.postCount || '0' : '0' }}</text>\n\t\t\t\t<text class=\"stats-label\">动态</text>\n\t\t\t</view>\n\t\t\t<view class=\"stats-row\" @click=\"goToFansList\">\n\t\t\t\t<text class=\"stats-num\">{{ userInfo ? userInfo.fansCount || '0' : '0' }}</text>\n\t\t\t\t<text class=\"stats-label\">粉丝</text>\n\t\t\t</view>\n\t\t\t<view class=\"stats-row\" @click=\"goToFollowList\">\n\t\t\t\t<text class=\"stats-num\">{{ userInfo ? userInfo.followCount || '0' : '0' }}</text>\n\t\t\t\t<text class=\"stats-label\">关注</text>\n\t\t\t</view>\n\t\t\t<view class=\"stats-row\" @click=\"goToFavorites\">\n\t\t\t\t<text class=\"stats-num\">{{ userInfo ? userInfo.favoriteCount || '0' : '0' }}</text>\n\t\t\t\t<text class=\"stats-label\">收藏</text>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 功能菜单列表 -->\n\t\t<view class=\"menu-list\">\n\t\t\t<view class=\"menu-item\" @click=\"navigateTo('/pages/order/order')\">\n\t\t\t\t<view class=\"icon-circle success\">\n\t\t\t\t\t<text class=\"icon-text\">✓</text>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"menu-text\">我的订单</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"navigateTo('/pages/wallet/wallet')\">\n\t\t\t\t<view class=\"icon-circle warning\">\n\t\t\t\t\t<text class=\"icon-text\">!</text>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"menu-text\">我的钱包</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"navigateTo('/pages/certification/certification')\">\n\t\t\t\t<view class=\"icon-circle info\">\n\t\t\t\t\t<text class=\"icon-text\">i</text>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"menu-text\">学长学姐认证</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"navigateTo('/pages/service/service')\">\n\t\t\t\t<view class=\"icon-circle info\">\n\t\t\t\t\t<text class=\"icon-text\">⏱</text>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"menu-text\">我的服务</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"navigateTo('/pages/subscribe/subscribe')\">\n\t\t\t\t<view class=\"icon-circle info\">\n\t\t\t\t\t<text class=\"icon-text\">i</text>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"menu-text\">关注公众号</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"navigateTo('/pages/contact/contact')\">\n\t\t\t\t<view class=\"icon-circle success\">\n\t\t\t\t\t<text class=\"icon-text\">✓</text>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"menu-text\">联系我们</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"handleLogout\" v-if=\"userInfo\">\n\t\t\t\t<view class=\"icon-circle warning\">\n\t\t\t\t\t<text class=\"icon-text\">⚠</text>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"menu-text\">退出登录</text>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 底部导航栏 -->\n\t\t<tab-bar pageName=\"mine\"></tab-bar>\n\t</view>\n</template>\n\n<script lang=\"uts\">\n\t/**\n\t * @description 个人中心页面\n\t */\n\timport TabBar from '../../components/tab-bar/tab-bar.uvue';\n\timport { Navigator, CommonRoutes } from '../../utils/routes.js';\n\timport { isLoggedIn, getUserInfo, checkLogin, logout } from '../../utils/checkload.js';\n\t\n\texport default {\n\t\tcomponents: {\n\t\t\tTabBar\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tuserInfo: null\n\t\t\t}\n\t\t},\n\t\tonLoad() {\n\t\t\t/**\n\t\t\t * 页面加载时执行\n\t\t\t */\n\t\t\tthis.checkLoginStatus();\n\t\t},\n\t\tonShow() {\n\t\t\t/**\n\t\t\t * 确保系统tabBar被隐藏\n\t\t\t */\n\t\t\tuni.hideTabBar();\n\t\t\t\n\t\t\t// 每次显示页面时检查登录状态，以便更新页面显示\n\t\t\tthis.checkLoginStatus();\n\t\t},\n\t\tmethods: {\n\t\t\t/**\n\t\t\t * @description 检查登录状态\n\t\t\t */\n\t\t\tcheckLoginStatus() {\n\t\t\t\t// 检查是否已登录\n\t\t\t\tif (isLoggedIn()) {\n\t\t\t\t\t// 获取用户信息\n\t\t\t\t\tthis.userInfo = getUserInfo();\n\t\t\t\t} else {\n\t\t\t\t\tthis.userInfo = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 处理头像点击\n\t\t\t */\n\t\t\thandleAvatarClick() {\n\t\t\t\tif (!this.userInfo) {\n\t\t\t\t\t// 未登录，跳转到登录页\n\t\t\t\t\tNavigator.toLogin('/pages/mine/mine');\n\t\t\t\t} else {\n\t\t\t\t\t// 已登录，跳转到个人资料页\n\t\t\t\t\tthis.navigateTo('/pages/mine/profile/profile');\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 处理登录文本点击\n\t\t\t */\n\t\t\thandleLoginClick() {\n\t\t\t\tif (!this.userInfo) {\n\t\t\t\t\t// 未登录，跳转到登录页\n\t\t\t\t\tNavigator.toLogin('/pages/mine/mine');\n\t\t\t\t} else {\n\t\t\t\t\t// 已登录，跳转到个人资料页\n\t\t\t\t\tthis.navigateTo('/pages/mine/profile/profile');\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 处理退出登录\n\t\t\t */\n\t\t\thandleLogout() {\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: '提示',\n\t\t\t\t\tcontent: '确定要退出登录吗？',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t// 调用退出登录方法\n\t\t\t\t\t\t\tlogout();\n\t\t\t\t\t\t\t// 更新页面显示\n\t\t\t\t\t\t\tthis.userInfo = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * 页面跳转方法\n\t\t\t * @param {string} url - 目标页面路径\n\t\t\t */\n\t\t\tnavigateTo(url) {\n\t\t\t\t// 有些页面需要登录才能访问\n\t\t\t\tconst requiresLogin = [\n\t\t\t\t\t'/pages/order/order',\n\t\t\t\t\t'/pages/wallet/wallet',\n\t\t\t\t\t'/pages/certification/certification',\n\t\t\t\t\t'/pages/service/service',\n\t\t\t\t\t'/pages/mine/profile/profile'\n\t\t\t\t];\n\t\t\t\t\n\t\t\t\t// 如果需要登录的页面且未登录，则先检查登录状态\n\t\t\t\tif (requiresLogin.includes(url) && !isLoggedIn()) {\n\t\t\t\t\t// 检查登录状态，未登录会自动跳转到登录页\n\t\t\t\t\tcheckLogin({\n\t\t\t\t\t\tredirect: url\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 正常跳转\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: url\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 跳转到我的帖子页面\n\t\t\t */\n\t\t\tgoToMyPosts() {\n\t\t\t\t// 检查是否已登录\n\t\t\t\tif (!checkLogin({ redirect: '/pages/mine/minepost' })) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\t// 使用主包标准路径格式\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\turl: '/pages/mine/minepost',\n\t\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\t\tuni.__f__('error','at pages/mine/mine.uvue:223','跳转失败:', err);\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '页面跳转失败',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tuni.__f__('error','at pages/mine/mine.uvue:231','跳转异常:', e);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 跳转到粉丝列表页面\n\t\t\t */\n\t\t\tgoToFansList() {\n\t\t\t\tif (!checkLogin({ redirect: '/pages/mine/fans/fans' })) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '/pages/mine/fans/fans'\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 跳转到关注列表页面\n\t\t\t */\n\t\t\tgoToFollowList() {\n\t\t\t\tif (!checkLogin({ redirect: '/pages/mine/follow/follow' })) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '/pages/mine/follow/follow'\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t/**\n\t\t\t * @description 跳转到收藏页面\n\t\t\t */\n\t\t\tgoToFavorites() {\n\t\t\t\tif (!checkLogin({ redirect: '/pages/mine/favorites/favorites' })) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '/pages/mine/favorites/favorites'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\tpage {\n\t\tbackground-color: #ffffff;\n\t}\n\t\n\t.container {\n\t\tmin-height: 100vh;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tbox-sizing: border-box;\n\t\tpadding-bottom: 50px;\n\t}\n\t\n\t/* 用户信息区样式 */\n\t.user-info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: flex-start;\n\t\tpadding: 30rpx;\n\t}\n\t\n\t.user-info-row {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\twidth: 100%;\n\t}\n\t\n\t.avatar {\n\t\twidth: 120rpx;\n\t\theight: 120rpx;\n\t\tborder-radius: 50%;\n\t\tmargin-right: 20rpx;\n\t}\n\t\n\t.login-tag-container {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t}\n\t\n\t.login-text {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tmargin-right: 20rpx;\n\t}\n\t\n\t.tag-btn {\n\t\tbackground-color: #f5f5f5;\n\t\tborder-radius: 30rpx;\n\t\tpadding: 8rpx 30rpx;\n\t}\n\t\n\t.tag-btn text {\n\t\tfont-size: 26rpx;\n\t\tcolor: #666;\n\t}\n\t\n\t/* 用户数据统计 */\n\t.user-stats {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tjustify-content: space-around;\n\t\tpadding: 20rpx 0;\n\t\tborder-bottom: 1px solid #f0f0f0;\n\t}\n\t\n\t.stats-row {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t}\n\t\n\t.stats-num {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t\tmargin-bottom: 5rpx;\n\t}\n\t\n\t.stats-label {\n\t\tfont-size: 26rpx;\n\t\tcolor: #666;\n\t}\n\t\n\t/* 菜单列表 */\n\t.menu-list {\n\t\twidth: 100%;\n\t}\n\t\n\t.menu-item {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tjustify-content: flex-start;\n\t\tpadding: 30rpx 0;\n\t\tborder-bottom: 1px solid #f0f0f0;\n\t}\n\t\n\t.icon-circle {\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t\tborder-radius: 50%;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tmargin: 0 30rpx;\n\t\tflex-shrink: 0;\n\t}\n\t\n\t.success {\n\t\tbackground-color: rgba(76, 175, 80, 0.1);\n\t}\n\t\n\t.warning {\n\t\tbackground-color: rgba(255, 82, 82, 0.1);\n\t}\n\t\n\t.info {\n\t\tbackground-color: rgba(33, 150, 243, 0.1);\n\t}\n\t\n\t.icon-text {\n\t\tfont-size: 30rpx;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.success .icon-text {\n\t\tcolor: #4CAF50;\n\t}\n\t\n\t.warning .icon-text {\n\t\tcolor: #FF5252;\n\t}\n\t\n\t.info .icon-text {\n\t\tcolor: #2196F3;\n\t}\n\t\n\t.menu-text {\n\t\tfont-size: 30rpx;\n\t\tcolor: #333;\n\t\ttext-align: left;\n\t}\n</style>\n","import MiniProgramPage from 'E:/研师录与其他人共享文件/teacherDirectory/前端yanshilu/pages/mine/mine.uvue'\nwx.createPage(MiniProgramPage)"],"names":["_sfc_main","defineComponent","components","TabBar","data","userInfo","onLoad","this","checkLoginStatus","onShow","uni","index","hideTabBar","methods","isLoggedIn","getUserInfo","handleAvatarClick","navigateTo","toLogin","handleLoginClick","handleLogout","showModal","title","content","success","res","confirm","logout","url","includes","utils_checkload","checkLogin","UTSJSONObject","redirect","goToMyPosts","fail","err","__f__","showToast","icon","e","goToFansList","goToFollowList","goToFavorites","wx","createPage","MiniProgramPage"],"mappings":"gIAiGCA,EAAeC,kBAAA,CACdC,WAAY,CACXC,OANiB,IAAA,uCAQlBC,KAAI,KACI,CACNC,SAAU,OAGZC,SAICC,KAAKC,kBACL,EACDC,SAICC,EAAGC,MAACC,aAGJL,KAAKC,kBACL,EACDK,QAAS,CAIRL,mBAEKM,EAAUA,aAERP,KAAAF,SAAWU,EAAAA,cAEhBR,KAAKF,SAAW,IAEjB,EAKDW,oBACMT,KAAKF,SAKTE,KAAKU,WAAW,2CAHNC,QAAQ,mBAKnB,EAKDC,mBACMZ,KAAKF,SAKTE,KAAKU,WAAW,2CAHNC,QAAQ,mBAKnB,EAKDE,eACCV,EAAAA,MAAIW,UAAU,CACbC,MAAO,KACPC,QAAS,YACTC,QAAUC,IACLA,EAAIC,UAEPC,EAAAA,SAEApB,KAAKF,SAAW,KACjB,GAGF,EAMDY,WAAWW,EAAG,MAWb,GATsB,CACrB,qBACA,uBACA,qCACA,yBACA,+BAIiBC,SAASD,KAASd,EAAUA,aAKvC,OAHIgB,EAAAC,WAAC,IAAAC,cAAA,CACVC,SAAUL,KAEL,KAIPlB,EAAAA,MAAIO,WAAW,CACdW,OAED,EAKDM,cAEK,IAACH,EAAUA,WAAC,IAAAC,cAAA,CAAEC,SAAU,0BACrB,OAAA,KAGH,IAEHvB,EAAAA,MAAIO,WAAW,CACdW,IAAK,uBACLO,KAAOC,IACN1B,EAAGC,MAAC0B,MAAM,QAAQ,8BAA8B,QAASD,GACzD1B,EAAAA,MAAI4B,UAAU,CACbhB,MAAO,SACPiB,KAAM,QACN,GAKJ,OAFSC,GACR9B,EAAGC,MAAC0B,MAAM,QAAQ,8BAA8B,QAASG,EAC1D,CACA,EAKDC,eACK,IAACV,EAAUA,WAAC,IAAAC,cAAA,CAAEC,SAAU,2BACrB,OAAA,KAGPvB,EAAAA,MAAIO,WAAW,CACdW,IAAK,yBAEN,EAKDc,iBACK,IAACX,EAAUA,WAAC,IAAAC,cAAA,CAAEC,SAAU,+BACrB,OAAA,KAGPvB,EAAAA,MAAIO,WAAW,CACdW,IAAK,6BAEN,EAKDe,gBACK,IAACZ,EAAUA,WAAC,IAAAC,cAAA,CAAEC,SAAU,qCACrB,OAAA,KAGPvB,EAAAA,MAAIO,WAAW,CACdW,IAAK,mCAEP,ixCC9QHgB,GAAGC,WAAWC"}