{"version":3,"file":"message.js","sources":["pages/message/message.uvue","../../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWVzc2FnZS9tZXNzYWdlLnV2dWU"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 顶部导航栏 -->\r\n\t\t<view class=\"header\">\r\n\t\t\t<view class=\"header-content\">\r\n\t\t\t\t<text class=\"title\">消息</text>\r\n\t\t\t\t<view class=\"add-button\" @tap=\"navigateToAddFriend\">\r\n\t\t\t\t\t<image class=\"add-icon\" src=\"/static/image/plus-1727487.svg\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 搜索栏 -->\r\n\t\t<view class=\"search-bar\">\r\n\t\t\t<view class=\"search-input\">\r\n\t\t\t\t\r\n\t\t\t\t<text class=\"search-text\">搜索</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 好友列表 -->\r\n\t\t<scroll-view class=\"friend-list\" \r\n\t\t\t\t\tscroll-y=\"true\" \r\n\t\t\t\t\t@scrolltolower=\"loadMoreFriends\"\r\n\t\t\t\t\tenable-back-to-top>\r\n\t\t\t<view class=\"friend-item\" \r\n\t\t\t\t  v-for=\"friend in friendList\" \r\n\t\t\t\t  :key=\"friend.id\"\r\n\t\t\t\t  @tap=\"navigateToChat(friend)\"\r\n\t\t\t\t  hover-class=\"friend-item-hover\">\r\n\t\t\t\t<view class=\"friend-avatar\">\r\n\t\t\t\t\t<image :src=\"friend.avatar || '/static/image/default_avatar.png'\" \r\n\t\t\t\t\t\t   mode=\"aspectFill\"></image>\r\n\t\t\t\t\t<view class=\"badge\" v-if=\"friend.unreadCount > 0\">\r\n\t\t\t\t\t\t{{friend.unreadCount}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"friend-info\">\r\n\t\t\t\t\t<view class=\"friend-header\">\r\n\t\t\t\t\t\t<text class=\"friend-name\">{{friend.name}}</text>\r\n\t\t\t\t\t\t<text class=\"message-time\">{{formatTime(friend.lastMessageTime)}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"friend-message\">\r\n\t\t\t\t\t\t<text class=\"message-preview\">{{friend.lastMessage}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\r\n\t\t<!-- 添加好友弹窗 -->\r\n\t\t\r\n\r\n\t\t<!-- 底部导航栏 -->\r\n\t\t<tab-bar pageName=\"message\"></tab-bar>\r\n\t</view>\r\n</template>\r\n\r\n<script lang=\"uts\">\r\n\timport TabBar from '../../components/tab-bar/tab-bar.uvue';\r\n\t\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tTabBar\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tsearchKey: '',\r\n\t\t\t\tsearchFriendKey: '',\r\n\t\t\t\tfriendList: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: '1',\r\n\t\t\t\t\t\tname: '张教授',\r\n\t\t\t\t\t\tavatar: '/static/image/default_avatar.png',\r\n\t\t\t\t\t\tlastMessage: '关于论文的修改建议已经发送给你了',\r\n\t\t\t\t\t\tlastMessageTime: Date.now() - 3600000,\r\n\t\t\t\t\t\tunreadCount: 2,\r\n\t\t\t\t\t\ttitle: '计算机科学教授'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: '2',\r\n\t\t\t\t\t\tname: '李老师',\r\n\t\t\t\t\t\tavatar: '/static/image/default_avatar.png',\r\n\t\t\t\t\t\tlastMessage: '下周一记得来参加组会',\r\n\t\t\t\t\t\tlastMessageTime: Date.now() - 7200000,\r\n\t\t\t\t\t\tunreadCount: 0,\r\n\t\t\t\t\t\ttitle: '软件工程讲师'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: '3',\r\n\t\t\t\t\t\tname: '学习群',\r\n\t\t\t\t\t\tavatar: '/static/image/default_avatar.png',\r\n\t\t\t\t\t\tlastMessage: '[有人@我] 请问这道题怎么解？',\r\n\t\t\t\t\t\tlastMessageTime: Date.now() - 120000,\r\n\t\t\t\t\t\tunreadCount: 5,\r\n\t\t\t\t\t\ttitle: '群聊'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: '4',\r\n\t\t\t\t\t\tname: '系统通知',\r\n\t\t\t\t\t\tavatar: '/static/image/default_avatar.png',\r\n\t\t\t\t\t\tlastMessage: '您有新的课程提醒',\r\n\t\t\t\t\t\tlastMessageTime: Date.now() - 86400000,\r\n\t\t\t\t\t\tunreadCount: 0,\r\n\t\t\t\t\t\ttitle: '系统消息'\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tnavigateToChat(friend) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/pages/message/chat?id=${friend.id}&name=${friend.name}`\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tnavigateToAddFriend() {\r\n\t\t\t\tuni.__f__('log','at pages/message/message.uvue:117','点击了添加好友按钮');\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/message/add',\r\n\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\tuni.__f__('log','at pages/message/message.uvue:121','成功跳转到添加好友页面');\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tuni.__f__('error','at pages/message/message.uvue:124','跳转失败:', err);\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '跳转失败，请重试',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tshowAddFriendPopup() {\r\n\t\t\t\tthis.$refs.addFriendPopup.open();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tcloseAddFriendPopup() {\r\n\t\t\t\tthis.$refs.addFriendPopup.close();\r\n\t\t\t\tthis.searchFriendKey = '';\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tformatTime(timestamp) {\r\n\t\t\t\tconst date = new Date(timestamp);\r\n\t\t\t\tconst now = new Date();\r\n\t\t\t\tconst diff = now - date;\r\n\t\t\t\t\r\n\t\t\t\tif (diff < 24 * 60 * 60 * 1000) {\r\n\t\t\t\t\treturn `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;\r\n\t\t\t\t} else if (diff < 7 * 24 * 60 * 60 * 1000) {\r\n\t\t\t\t\tconst days = ['日', '一', '二', '三', '四', '五', '六'];\r\n\t\t\t\t\treturn `星期${days[date.getDay()]}`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn `${date.getMonth() + 1}月${date.getDate()}日`;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t/* 全局变量 - 蓝色主题 */\r\n\tpage {\r\n\t\t/* 蓝色调色板 */\r\n\t\t--blue-primary: #2970ff;\r\n\t\t--blue-secondary: #5294ff;\r\n\t\t--blue-light: #eaf2ff;\r\n\t\t--blue-dark: #1e5ac8;\r\n\t\t--blue-gradient: linear-gradient(135deg, #2970ff, #5294ff);\r\n\t\t\r\n\t\t/* 文本颜色 */\r\n\t\t--text-primary: #333333;\r\n\t\t--text-secondary: #666666;\r\n\t\t--text-light: #999999;\r\n\t\t--text-white: #ffffff;\r\n\t\t\r\n\t\t/* 背景和边框 */\r\n\t\t--bg-white: #ffffff;\r\n\t\t--bg-light: #f8f9fc;\r\n\t\t--border-color: #eaedf4;\r\n\t\t\r\n\t\t/* 阴影 */\r\n\t\t--shadow-sm: 0 2px 6px rgba(41, 112, 255, 0.08);\r\n\t\t--shadow-md: 0 4px 12px rgba(41, 112, 255, 0.12);\r\n\t\t\r\n\t\t/* 字体 */\r\n\t\t--font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif;\r\n\t}\r\n\r\n\t.container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\theight: 100vh;\r\n\t\tbackground-color: var(--bg-light);\r\n\t\tfont-family: var(--font-family);\r\n\t}\r\n\r\n\t/* 顶部导航栏 - 蓝色渐变 */\r\n\t.header {\r\n\t\tpadding-top: calc(5px + constant(safe-area-inset-top));\r\n\t\tpadding-top: calc(5px + env(safe-area-inset-top));\r\n\t\tpadding-bottom: 2px;\r\n\t\tbackground-image: var(--blue-gradient);\r\n\t\tposition: relative;\r\n\t\tbox-shadow: var(--shadow-sm);\r\n\t\tz-index: 10;\r\n\t}\r\n\r\n\t.header-content {\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\theight: 30px;\r\n\t}\r\n\r\n\t.title {\r\n\t\tcolor: var(--text-white);\r\n\t\tfont-size: 16px;\r\n\t\tfont-weight: 500;\r\n\t\ttext-align: center;\r\n\t\tletter-spacing: 0.5px;\r\n\t}\r\n\r\n\t.add-button {\r\n\t\tposition: absolute;\r\n\t\tright: 16px;\r\n\t\ttop: 0px;\r\n\t\twidth: 30px;\r\n\t\theight: 30px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbackground-color: rgba(255, 255, 255, 0.15);\r\n\t\tborder-radius: 50%;\r\n\t\tbackdrop-filter: blur(4px);\r\n\t\t-webkit-backdrop-filter: blur(4px);\r\n\t\ttransition: all 0.3s;\r\n\t\tpadding: 5px;\r\n\t}\r\n\t\r\n\t.add-button:active {\r\n\t\ttransform: scale(0.92);\r\n\t\tbackground-color: rgba(255, 255, 255, 0.25);\r\n\t}\r\n\r\n\t.add-icon {\r\n\t\twidth: 16px;\r\n\t\theight: 16px;\r\n\t\tfilter: brightness(0) invert(1);\r\n\t}\r\n\r\n\t/* 搜索栏 - 美化版 */\r\n\t.search-bar {\r\n\t\tpadding: 8px 16px;\r\n\t\tbackground-color: var(--bg-white);\r\n\t\tborder-bottom: 1px solid var(--border-color);\r\n\t}\r\n\r\n\t.search-input {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbackground-color: var(--bg-light);\r\n\t\tborder-radius: 20px;\r\n\t\tpadding: 6px 12px;\r\n\t\theight: 24px;\r\n\t\ttransition: all 0.3s;\r\n\t\tbox-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);\r\n\t}\r\n\t\r\n\t.search-input:active {\r\n\t\tbox-shadow: inset 0 1px 3px rgba(41, 112, 255, 0.1);\r\n\t}\r\n\r\n\t.search-icon {\r\n\t\twidth: 16px;\r\n\t\theight: 16px;\r\n\t\tmargin-right: 8px;\r\n\t\topacity: 0.5;\r\n\t\tfilter: grayscale(1);\r\n\t}\r\n\r\n\t.search-text {\r\n\t\tcolor: var(--text-light);\r\n\t\tfont-size: 14px;\r\n\t}\r\n\r\n\t/* 好友列表 - 美化版 */\r\n\t.friend-list {\r\n\t\tflex: 1;\r\n\t\tbackground-color: var(--bg-white);\r\n\t\tpadding: 4px 0;\r\n\t}\r\n\r\n\t.friend-item {\r\n\t\tdisplay: flex;\r\n\t\tpadding: 12px 16px;\r\n\t\tmargin: 2px 8px;\r\n\t\tborder-radius: 8px;\r\n\t\talign-items: center;\r\n\t\ttransition: all 0.3s;\r\n\t}\r\n\r\n\t.friend-item-hover {\r\n\t\tbackground-color: var(--blue-light);\r\n\t}\r\n\r\n\t.friend-avatar {\r\n\t\tposition: relative;\r\n\t\tmargin-right: 12px;\r\n\t\tmargin-left: 0;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.friend-avatar image {\r\n\t\twidth: 48px;\r\n\t\theight: 48px;\r\n\t\tborder-radius: 12px;\r\n\t\tbox-shadow: var(--shadow-sm);\r\n\t\tborder: 2px solid var(--bg-white);\r\n\t}\r\n\r\n\t.badge {\r\n\t\tposition: absolute;\r\n\t\ttop: -5px;\r\n\t\tright: -5px;\r\n\t\tbackground-image: var(--blue-gradient);\r\n\t\tcolor: var(--text-white);\r\n\t\tfont-size: 11px;\r\n\t\tpadding: 0;\r\n\t\tmin-width: 18px;\r\n\t\theight: 18px;\r\n\t\tborder-radius: 18px;\r\n\t\ttext-align: center;\r\n\t\tline-height: 18px;\r\n\t\tfont-weight: bold;\r\n\t\tbox-shadow: 0 2px 4px rgba(41, 112, 255, 0.3);\r\n\t\tborder: 1.5px solid var(--bg-white);\r\n\t}\r\n\r\n\t.friend-info {\r\n\t\tflex: 1;\r\n\t\toverflow: hidden;\r\n\t\tpadding: 4px 0;\r\n\t}\r\n\r\n\t.friend-header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 4px;\r\n\t}\r\n\r\n\t.friend-name {\r\n\t\tfont-size: 15px;\r\n\t\tcolor: var(--text-primary);\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t.message-time {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: var(--text-light);\r\n\t\tmargin-left: 8px;\r\n\t}\r\n\r\n\t.friend-message {\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.message-preview {\r\n\t\tfont-size: 13px;\r\n\t\tcolor: var(--text-secondary);\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t\twidth: 100%;\r\n\t\tline-height: 1.4;\r\n\t}\r\n\r\n\t/* 隐藏滚动条 */\r\n\t::-webkit-scrollbar {\r\n\t\twidth: 0;\r\n\t\theight: 0;\r\n\t\tbackground-color: transparent;\r\n\t}\r\n\t\r\n\t/* 适配深色模式 */\r\n\t@media (prefers-color-scheme: dark) {\r\n\t\tpage {\r\n\t\t\t--blue-primary: #4c8dff;\r\n\t\t\t--blue-secondary: #6fa5ff;\r\n\t\t\t--blue-light: #1c2c4c;\r\n\t\t\t--blue-dark: #3b78e7;\r\n\t\t\t--blue-gradient: linear-gradient(135deg, #2d6fdc, #4c8dff);\r\n\t\t\t\r\n\t\t\t--text-primary: #f0f0f0;\r\n\t\t\t--text-secondary: #c0c0c0;\r\n\t\t\t--text-light: #909090;\r\n\t\t\t\r\n\t\t\t--bg-white: #1a1a1a;\r\n\t\t\t--bg-light: #242424;\r\n\t\t\t--border-color: #333333;\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/研师录与其他人共享文件/teacherDirectory/前端yanshilu/pages/message/message.uvue'\nwx.createPage(MiniProgramPage)"],"names":["_sfc_main","defineComponent","components","TabBar","data","searchKey","searchFriendKey","friendList","UTSJSONObject","id","name","avatar","lastMessage","lastMessageTime","Date","now","unreadCount","title","methods","navigateToChat","friend","uni","navigateTo","url","navigateToAddFriend","__f__","success","fail","err","index","showToast","icon","showAddFriendPopup","this","$refs","addFriendPopup","open","closeAddFriendPopup","close","formatTime","timestamp","date","diff","getHours","toString","padStart","getMinutes","getDay","getMonth","getDate","wx","createPage","MiniProgramPage"],"mappings":"2FA4DCA,EAAeC,kBAAA,CACdC,WAAY,CACXC,OAJiB,IAAA,uCAMlBC,KAAI,KACI,CACNC,UAAW,GACXC,gBAAiB,GACjBC,WAAY,CACX,IAAAC,cAAA,CACCC,GAAI,IACJC,KAAM,MACNC,OAAQ,mCACRC,YAAa,mBACbC,gBAAiBC,KAAKC,MAAQ,KAC9BC,YAAa,EACbC,MAAO,YAER,IAAAT,cAAA,CACCC,GAAI,IACJC,KAAM,MACNC,OAAQ,mCACRC,YAAa,aACbC,gBAAiBC,KAAKC,MAAQ,KAC9BC,YAAa,EACbC,MAAO,WAER,IAAAT,cAAA,CACCC,GAAI,IACJC,KAAM,MACNC,OAAQ,mCACRC,YAAa,mBACbC,gBAAiBC,KAAKC,MAAQ,KAC9BC,YAAa,EACbC,MAAO,OAER,IAAAT,cAAA,CACCC,GAAI,IACJC,KAAM,OACNC,OAAQ,mCACRC,YAAa,WACbC,gBAAiBC,KAAKC,MAAQ,MAC9BC,YAAa,EACbC,MAAO,YAKXC,QAAS,CACRC,eAAeC,EAAM,MACpBC,EAAAA,MAAIC,WAAW,CACdC,IAAK,0BAA0BH,EAAOX,WAAWW,EAAOV,QAEzD,EAEDc,sBACCH,EAAAA,MAAII,MAAM,MAAM,oCAAoC,aACpDJ,EAAAA,MAAIC,WAAW,CACdC,IAAK,qBACLG,QAAS,KACRL,EAAAA,MAAII,MAAM,MAAM,oCAAoC,cAAa,EAElEE,KAAOC,IACNP,EAAGQ,MAACJ,MAAM,QAAQ,oCAAoC,QAASG,GAC/DP,EAAAA,MAAIS,UAAU,CACbb,MAAO,WACPc,KAAM,QACN,GAGH,EAEDC,qBACMC,KAAAC,MAAMC,eAAeC,MAC1B,EAEDC,sBACMJ,KAAAC,MAAMC,eAAeG,QAC1BL,KAAK3B,gBAAkB,EACvB,EAEDiC,WAAWC,EAAS,MACb,MAAAC,EAAO,IAAI3B,KAAK0B,GAEhBE,MADU5B,KACG2B,EAEnB,GAAIC,EAAO,MACV,MAAO,GAAGD,EAAKE,WAAWC,WAAWC,SAAS,EAAG,QAAQJ,EAAKK,aAAaF,WAAWC,SAAS,EAAG,UACxFH,EAAO,OAAyB,CAE1C,MAAO,KADM,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAC3BD,EAAKM,WACrB,CACM,MAAA,GAAGN,EAAKO,WAAa,KAAKP,EAAKQ,YAExC,8kBCzJHC,GAAGC,WAAWC"}