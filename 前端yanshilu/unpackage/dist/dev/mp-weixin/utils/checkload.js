"use strict";const e=require("../common/vendor.js"),t=require("./routes.js"),o=()=>{try{const t=e.index.getStorageSync("userInfo");return t?JSON.parse(t):null}catch(t){return e.index.__f__("error","at utils/checkload.js:21","获取用户信息失败:",t),null}},n=()=>{const t=e.index.getStorageSync("token"),n=o();return!!t&&!!n};exports.checkLogin=(o={})=>{const{showToast:r=!0,redirect:s=null}=o;return!!n()||(r&&e.index.showToast({title:"请先登录",icon:"none"}),setTimeout((()=>{(e=>{const o=getCurrentPages()[getCurrentPages().length-1],n=e||o.route;t.Navigator.toLogin(n)})(s)}),1500),!1)},exports.getUserInfo=o,exports.isLoggedIn=n,exports.logout=(o={})=>{const{redirect:n=!1}=o;e.index.removeStorageSync("token"),e.index.removeStorageSync("userInfo"),e.index.showToast({title:"已退出登录",icon:"success"}),n&&setTimeout((()=>{t.Navigator.toLogin()}),1500)},exports.updateLoginStatus=(t,o)=>{e.index.setStorageSync("userInfo",JSON.stringify(t)),o&&e.index.setStorageSync("token",o)};
//# sourceMappingURL=../../.sourcemap/mp-weixin/utils/checkload.js.map
