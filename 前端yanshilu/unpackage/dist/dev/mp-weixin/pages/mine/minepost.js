"use strict";const e=require("../../common/vendor.js"),t=require("../../common/assets.js"),s=e.defineComponent({data:()=>({posts:[],currentPage:1,isLoading:!1,hasMore:!0,isRefreshing:!1}),onLoad(){this.loadMyPosts()},onPullDownRefresh(){this.currentPage=1,this.posts=[],this.loadMyPosts((()=>{e.index.stopPullDownRefresh()}))},onReachBottom(){this.hasMore&&!this.isLoading&&this.loadMorePosts()},methods:{navigateBack(){e.index.navigateBack()},loadMyPosts(e=null){if(this.isLoading)return null;this.isLoading=!0,new UTSJSONObject({page:this.currentPage,pageSize:10});const t=this.getMockData();this.posts=1===this.currentPage?t:[...this.posts,...t],this.hasMore=this.currentPage<2,setTimeout((()=>{this.isLoading=!1,e&&e()}),500)},loadMorePosts(){this.currentPage++,this.loadMyPosts()},viewPostDetail(t=null){e.index.navigateTo({url:`/pages/post/detail?id=${t}`})},likePost(t=null){const s=t.isLiked?"unlike":"like";e.index.request({url:`YOUR_API_URL/post/${s}`,method:"POST",data:new UTSJSONObject({postId:t.id}),success:e=>{200===e.statusCode&&(t.isLiked=!t.isLiked,t.likeCount+=t.isLiked?1:-1)}})},commentPost(t=null){e.index.navigateTo({url:`/pages/post/detail?id=${t.id}&showComment=true`})},collectPost(t=null){const s=t.isCollected?"uncollect":"collect";e.index.request({url:`YOUR_API_URL/post/${s}`,method:"POST",data:new UTSJSONObject({postId:t.id}),success:s=>{200===s.statusCode&&(t.isCollected=!t.isCollected,t.collectCount+=t.isCollected?1:-1,e.index.showToast({title:t.isCollected?"已收藏":"已取消收藏",icon:"none"}))}})},sharePost(t=null){e.index.showActionSheet({itemList:["分享给好友","分享到微信好友","分享到微信群聊","分享到朋友圈"],success:s=>{const i=s.tapIndex;switch(i){case 0:e.index.navigateTo({url:`/pages/share/friends?postId=${t.id}`});break;case 1:case 2:case 3:e.index.share(new UTSJSONObject({provider:"weixin",scene:1===i||2===i?"WXSceneSession":"WXSceneTimeline",type:0,title:t.title||"分享内容",summary:t.content.substring(0,50)+(t.content.length>50?"...":""),imageUrl:t.images&&t.images.length>0?t.images[0]:"/static/image/share_default.png",href:`YOUR_SHARE_URL/post/${t.id}`,success:function(){e.index.__f__("log","at pages/mine/minepost.uvue:266","分享成功"),t.shareCount++},fail:function(){e.index.__f__("log","at pages/mine/minepost.uvue:271","分享失败")}}))}}})},getMockData:()=>[new UTSJSONObject({id:1,content:"今天分享一下考研复习经验，希望对大家有帮助！数学部分要注重基础，多做真题。#考研# #复习经验#",createTime:"2023-09-15 14:30",viewCount:256,likeCount:42,commentCount:8,collectCount:15,shareCount:3,isLiked:!1,isCollected:!1,images:[]}),new UTSJSONObject({id:2,content:"考研英语阅读理解技巧分享，掌握这些方法效率提升50%！长难句分析方法和常见词汇搭配整理。",createTime:"2023-08-20 09:15",viewCount:189,likeCount:36,commentCount:12,collectCount:20,shareCount:5,isLiked:!0,isCollected:!1,images:[]}),new UTSJSONObject({id:3,content:"考研政治复习时间规划，建议8月开始系统学习，10月开始真题训练，12月开始背诵考点。提供我整理的笔记供大家参考。",createTime:"2023-07-05 16:45",viewCount:320,likeCount:67,commentCount:23,collectCount:45,shareCount:12,isLiked:!1,isCollected:!0,images:[]})]}});const i=e._export_sfc(s,[["render",function(s,i,o,n,a,c){return e.e({a:e.o(((...e)=>c.navigateBack&&c.navigateBack(...e))),b:a.isRefreshing},(a.isRefreshing,{}),{c:e.f(a.posts,((t,s,i)=>({a:e.t(t.content),b:e.t(t.createTime),c:e.t(t.viewCount),d:t.isLiked?"/static/image/like_filled.svg":"/static/image/like.svg",e:e.t(t.likeCount),f:e.o((e=>c.likePost(t)),s),g:e.t(t.commentCount),h:e.o((e=>c.commentPost(t)),s),i:t.isCollected?"/static/image/star_filled.svg":"/static/image/star.svg",j:e.t(t.collectCount),k:e.o((e=>c.collectPost(t)),s),l:e.t(t.shareCount),m:e.o((e=>c.sharePost(t)),s),n:s,o:e.o((e=>c.viewPostDetail(t.id)),s)}))),d:t._imports_0$2,e:t._imports_1,f:a.isLoading&&a.posts.length>0},(a.isLoading&&a.posts.length,{}),{g:0===a.posts.length&&!a.isLoading},(0!==a.posts.length||a.isLoading,{}),{h:e.sei(s.virtualHostId,"view")})}]]);wx.createPage(i);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/mine/minepost.js.map
