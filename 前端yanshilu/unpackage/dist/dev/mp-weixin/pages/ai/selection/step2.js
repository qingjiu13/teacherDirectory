"use strict";const e=require("../../../common/vendor.js"),o=require("../../../config.js"),s=e.defineComponent({data:()=>({selectedSchool:"",selectedMajor:"",showSchoolList:!1,showMajorList:!1,searchText:"",searchMajorText:"",schools:[],majors:[],localSchools:["北京大学","清华大学","复旦大学","上海交通大学","浙江大学","南京大学","中国人民大学","武汉大学","中山大学","华中科技大学","北京师范大学","厦门大学","南开大学","吉林大学","西安交通大学","哈尔滨工业大学","电子科技大学","东南大学","四川大学","中南大学"],localMajors:["计算机科学与技术","软件工程","人工智能","数据科学与大数据技术","网络空间安全","电子信息工程","通信工程","自动化","机械工程","土木工程","建筑学","工商管理","会计学","金融学","经济学","法学","医学","生物科学","化学","物理学","数学","英语","汉语言文学","新闻学","心理学","教育学"]}),computed:{filteredSchools(){if(!this.searchText)return this.schools.length>0?this.schools:this.localSchools;const e=this.searchText.toLowerCase();return(this.schools.length>0?this.schools:this.localSchools).filter((o=>o.toLowerCase().includes(e)))},filteredMajors(){if(!this.searchMajorText)return this.majors.length>0?this.majors:this.localMajors;const e=this.searchMajorText.toLowerCase();return(this.majors.length>0?this.majors:this.localMajors).filter((o=>o.toLowerCase().includes(e)))}},onLoad(){this.loadSchools();const o=e.index.getStorageSync("step2_school"),s=e.index.getStorageSync("step2_major");o&&(this.selectedSchool=o,this.searchText=o),s&&(this.selectedMajor=s,this.searchMajorText=s)},methods:{loadSchools(){return e.__awaiter(this,void 0,void 0,(function*(){try{e.index.showLoading({title:"加载中..."});const s=yield e.Zs.callFunction({name:o.aiSelectionApis.getSchools,data:new UTSJSONObject({}),timeout:1e4}).catch(((o=null)=>(e.index.__f__("error","at pages/ai/selection/step2.uvue:158","获取学校列表失败:",o),new UTSJSONObject({result:new UTSJSONObject({code:-1,msg:o.message})}))));e.index.hideLoading(),s.result&&0===s.result.code?(this.schools=s.result.data||[],e.index.__f__("log","at pages/ai/selection/step2.uvue:166","获取到学校列表:",this.schools)):(e.index.__f__("warn","at pages/ai/selection/step2.uvue:168","使用本地学校列表"),this.schools=this.localSchools)}catch(s){e.index.hideLoading(),e.index.__f__("error","at pages/ai/selection/step2.uvue:173","加载学校列表异常:",s),this.schools=this.localSchools}}))},selectSchool(o=null){this.selectedSchool=o,this.searchText=o,this.showSchoolList=!1,e.index.setStorageSync("step2_school",o)},loadMajors(){return e.__awaiter(this,void 0,void 0,(function*(){try{if(!this.selectedSchool)return Promise.resolve(null);e.index.showLoading({title:"加载中..."});const s=yield e.Zs.callFunction({name:o.aiSelectionApis.getUndergraduateMajors,data:new UTSJSONObject({school:this.selectedSchool}),timeout:1e4}).catch(((o=null)=>(e.index.__f__("error","at pages/ai/selection/step2.uvue:210","获取专业列表失败:",o),new UTSJSONObject({result:new UTSJSONObject({code:-1,msg:o.message})}))));e.index.hideLoading(),s.result&&0===s.result.code?(this.majors=s.result.data||[],e.index.__f__("log","at pages/ai/selection/step2.uvue:219","获取到专业列表:",this.majors)):(e.index.__f__("warn","at pages/ai/selection/step2.uvue:221","使用本地专业列表"),this.majors=this.localMajors)}catch(s){e.index.hideLoading(),e.index.__f__("error","at pages/ai/selection/step2.uvue:226","加载专业列表异常:",s),this.majors=this.localMajors}}))},selectMajor(o=null){this.selectedMajor=o,this.searchMajorText=o,this.showMajorList=!1,e.index.setStorageSync("step2_major",o)},prevPage(){e.index.navigateBack()},nextPage(){return this.selectedSchool?this.selectedMajor?void e.index.navigateTo({url:"/pages/ai/selection/step3"}):(e.index.showToast({title:"请输入就读专业",icon:"none"}),null):(e.index.showToast({title:"请选择就读学校",icon:"none"}),null)}}});const t=e._export_sfc(s,[["render",function(o,s,t,a,i,l){return e.e({a:e.o((e=>i.showSchoolList=!0)),b:i.searchText,c:e.o((e=>i.searchText=e.detail.value)),d:i.showSchoolList},i.showSchoolList?{e:e.f(l.filteredSchools,((o,s,t)=>({a:e.t(o),b:s,c:e.o((e=>l.selectSchool(o)),s)})))}:{},{f:e.o((e=>i.showMajorList=!0)),g:i.searchMajorText,h:e.o((e=>i.searchMajorText=e.detail.value)),i:i.showMajorList},i.showMajorList?{j:e.f(l.filteredMajors,((o,s,t)=>({a:e.t(o),b:s,c:e.o((e=>l.selectMajor(o)),s)})))}:{},{k:e.o(((...e)=>l.prevPage&&l.prevPage(...e))),l:e.o(((...e)=>l.nextPage&&l.nextPage(...e))),m:e.sei(o.virtualHostId,"view")})}]]);wx.createPage(t);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/ai/selection/step2.js.map
