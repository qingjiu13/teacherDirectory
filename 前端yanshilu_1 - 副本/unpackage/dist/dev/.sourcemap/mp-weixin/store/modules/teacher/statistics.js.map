{"version":3,"file":"statistics.js","sources":["store/modules/teacher/statistics.js"],"sourcesContent":["/**\r\n * @description 教师统计分析模块 - 处理教学数据分析\r\n */\r\nimport { services } from '../../services';\r\n\r\n// 初始状态\r\nconst state = {\r\n  teachingStats: null,\r\n  studentPerformance: [],\r\n  courseAnalytics: [],\r\n  incomeStats: null,\r\n  timeframeFilter: 'month', // month, quarter, year\r\n  loading: false,\r\n  error: null\r\n};\r\n\r\n// Getters\r\nconst getters = {\r\n  teachingStats: state => state.teachingStats,\r\n  studentPerformance: state => state.studentPerformance,\r\n  courseAnalytics: state => state.courseAnalytics,\r\n  incomeStats: state => state.incomeStats,\r\n  timeframeFilter: state => state.timeframeFilter,\r\n  loading: state => state.loading,\r\n  error: state => state.error\r\n};\r\n\r\n// 引入常量类型\r\nconst FETCH_TEACHING_STATS_REQUEST = 'FETCH_TEACHING_STATS_REQUEST';\r\nconst FETCH_TEACHING_STATS_SUCCESS = 'FETCH_TEACHING_STATS_SUCCESS';\r\nconst FETCH_TEACHING_STATS_FAILURE = 'FETCH_TEACHING_STATS_FAILURE';\r\nconst FETCH_STUDENT_PERFORMANCE_REQUEST = 'FETCH_STUDENT_PERFORMANCE_REQUEST';\r\nconst FETCH_STUDENT_PERFORMANCE_SUCCESS = 'FETCH_STUDENT_PERFORMANCE_SUCCESS';\r\nconst FETCH_STUDENT_PERFORMANCE_FAILURE = 'FETCH_STUDENT_PERFORMANCE_FAILURE';\r\nconst FETCH_COURSE_ANALYTICS_REQUEST = 'FETCH_COURSE_ANALYTICS_REQUEST';\r\nconst FETCH_COURSE_ANALYTICS_SUCCESS = 'FETCH_COURSE_ANALYTICS_SUCCESS';\r\nconst FETCH_COURSE_ANALYTICS_FAILURE = 'FETCH_COURSE_ANALYTICS_FAILURE';\r\nconst FETCH_INCOME_STATS_REQUEST = 'FETCH_INCOME_STATS_REQUEST';\r\nconst FETCH_INCOME_STATS_SUCCESS = 'FETCH_INCOME_STATS_SUCCESS';\r\nconst FETCH_INCOME_STATS_FAILURE = 'FETCH_INCOME_STATS_FAILURE';\r\nconst SET_TIMEFRAME_FILTER = 'SET_TIMEFRAME_FILTER';\r\n\r\n// Mutations\r\nconst mutations = {\r\n  [FETCH_TEACHING_STATS_REQUEST](state) {\r\n    state.loading = true;\r\n    state.error = null;\r\n  },\r\n  [FETCH_TEACHING_STATS_SUCCESS](state, stats) {\r\n    state.teachingStats = stats;\r\n    state.loading = false;\r\n  },\r\n  [FETCH_TEACHING_STATS_FAILURE](state, error) {\r\n    state.loading = false;\r\n    state.error = error;\r\n  },\r\n  [FETCH_STUDENT_PERFORMANCE_REQUEST](state) {\r\n    state.loading = true;\r\n    state.error = null;\r\n  },\r\n  [FETCH_STUDENT_PERFORMANCE_SUCCESS](state, data) {\r\n    state.studentPerformance = data;\r\n    state.loading = false;\r\n  },\r\n  [FETCH_STUDENT_PERFORMANCE_FAILURE](state, error) {\r\n    state.loading = false;\r\n    state.error = error;\r\n  },\r\n  [FETCH_COURSE_ANALYTICS_REQUEST](state) {\r\n    state.loading = true;\r\n    state.error = null;\r\n  },\r\n  [FETCH_COURSE_ANALYTICS_SUCCESS](state, data) {\r\n    state.courseAnalytics = data;\r\n    state.loading = false;\r\n  },\r\n  [FETCH_COURSE_ANALYTICS_FAILURE](state, error) {\r\n    state.loading = false;\r\n    state.error = error;\r\n  },\r\n  [FETCH_INCOME_STATS_REQUEST](state) {\r\n    state.loading = true;\r\n    state.error = null;\r\n  },\r\n  [FETCH_INCOME_STATS_SUCCESS](state, data) {\r\n    state.incomeStats = data;\r\n    state.loading = false;\r\n  },\r\n  [FETCH_INCOME_STATS_FAILURE](state, error) {\r\n    state.loading = false;\r\n    state.error = error;\r\n  },\r\n  [SET_TIMEFRAME_FILTER](state, timeframe) {\r\n    state.timeframeFilter = timeframe;\r\n  }\r\n};\r\n\r\n// Actions\r\nconst actions = {\r\n  /**\r\n   * @description 获取教学统计数据\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Object>} 统计数据\r\n   */\r\n  async fetchTeachingStats({ commit, state }) {\r\n    commit(FETCH_TEACHING_STATS_REQUEST);\r\n    \r\n    try {\r\n      // 假设API服务中有获取教学统计数据的方法\r\n      const response = await services.teacher.getTeachingStats({\r\n        timeframe: state.timeframeFilter\r\n      });\r\n      \r\n      commit(FETCH_TEACHING_STATS_SUCCESS, response.data);\r\n      return response.data;\r\n    } catch (error) {\r\n      const errorMsg = error.response?.data?.message || '获取教学统计数据失败';\r\n      commit(FETCH_TEACHING_STATS_FAILURE, errorMsg);\r\n      return Promise.reject(error);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 获取学生表现数据\r\n   * @param {Object} context - Vuex上下文\r\n   * @param {string} [courseId] - 可选的课程ID过滤\r\n   * @returns {Promise<Array>} 学生表现数据\r\n   */\r\n  async fetchStudentPerformance({ commit, state }, courseId) {\r\n    commit(FETCH_STUDENT_PERFORMANCE_REQUEST);\r\n    \r\n    try {\r\n      // 假设API服务中有获取学生表现数据的方法\r\n      const response = await services.teacher.getStudentPerformance({\r\n        timeframe: state.timeframeFilter,\r\n        courseId\r\n      });\r\n      \r\n      commit(FETCH_STUDENT_PERFORMANCE_SUCCESS, response.data);\r\n      return response.data;\r\n    } catch (error) {\r\n      const errorMsg = error.response?.data?.message || '获取学生表现数据失败';\r\n      commit(FETCH_STUDENT_PERFORMANCE_FAILURE, errorMsg);\r\n      return Promise.reject(error);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 获取课程分析数据\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Array>} 课程分析数据\r\n   */\r\n  async fetchCourseAnalytics({ commit, state }) {\r\n    commit(FETCH_COURSE_ANALYTICS_REQUEST);\r\n    \r\n    try {\r\n      // 假设API服务中有获取课程分析数据的方法\r\n      const response = await services.teacher.getCourseAnalytics({\r\n        timeframe: state.timeframeFilter\r\n      });\r\n      \r\n      commit(FETCH_COURSE_ANALYTICS_SUCCESS, response.data);\r\n      return response.data;\r\n    } catch (error) {\r\n      const errorMsg = error.response?.data?.message || '获取课程分析数据失败';\r\n      commit(FETCH_COURSE_ANALYTICS_FAILURE, errorMsg);\r\n      return Promise.reject(error);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 获取收入统计数据\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Object>} 收入统计数据\r\n   */\r\n  async fetchIncomeStats({ commit, state }) {\r\n    commit(FETCH_INCOME_STATS_REQUEST);\r\n    \r\n    try {\r\n      // 假设API服务中有获取收入统计数据的方法\r\n      const response = await services.teacher.getIncomeStats({\r\n        timeframe: state.timeframeFilter\r\n      });\r\n      \r\n      commit(FETCH_INCOME_STATS_SUCCESS, response.data);\r\n      return response.data;\r\n    } catch (error) {\r\n      const errorMsg = error.response?.data?.message || '获取收入统计数据失败';\r\n      commit(FETCH_INCOME_STATS_FAILURE, errorMsg);\r\n      return Promise.reject(error);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 设置时间范围过滤器\r\n   * @param {Object} context - Vuex上下文\r\n   * @param {string} timeframe - 时间范围(month/quarter/year)\r\n   */\r\n  setTimeframeFilter({ commit }, timeframe) {\r\n    commit(SET_TIMEFRAME_FILTER, timeframe);\r\n  },\r\n  \r\n  /**\r\n   * @description 加载所有统计数据\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Object>} 加载结果\r\n   */\r\n  async loadAllStats({ dispatch }) {\r\n    try {\r\n      await Promise.all([\r\n        dispatch('fetchTeachingStats'),\r\n        dispatch('fetchStudentPerformance'),\r\n        dispatch('fetchCourseAnalytics'),\r\n        dispatch('fetchIncomeStats')\r\n      ]);\r\n      \r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('加载统计数据失败:', error);\r\n      return { success: false, error };\r\n    }\r\n  }\r\n};\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  getters,\r\n  actions,\r\n  mutations\r\n}; "],"names":["state","services","uni"],"mappings":";;;AAMA,MAAM,QAAQ;AAAA,EACZ,eAAe;AAAA,EACf,oBAAoB,CAAE;AAAA,EACtB,iBAAiB,CAAE;AAAA,EACnB,aAAa;AAAA,EACb,iBAAiB;AAAA;AAAA,EACjB,SAAS;AAAA,EACT,OAAO;AACT;AAGA,MAAM,UAAU;AAAA,EACd,eAAe,CAAAA,WAASA,OAAM;AAAA,EAC9B,oBAAoB,CAAAA,WAASA,OAAM;AAAA,EACnC,iBAAiB,CAAAA,WAASA,OAAM;AAAA,EAChC,aAAa,CAAAA,WAASA,OAAM;AAAA,EAC5B,iBAAiB,CAAAA,WAASA,OAAM;AAAA,EAChC,SAAS,CAAAA,WAASA,OAAM;AAAA,EACxB,OAAO,CAAAA,WAASA,OAAM;AACxB;AAGA,MAAM,+BAA+B;AACrC,MAAM,+BAA+B;AACrC,MAAM,+BAA+B;AACrC,MAAM,oCAAoC;AAC1C,MAAM,oCAAoC;AAC1C,MAAM,oCAAoC;AAC1C,MAAM,iCAAiC;AACvC,MAAM,iCAAiC;AACvC,MAAM,iCAAiC;AACvC,MAAM,6BAA6B;AACnC,MAAM,6BAA6B;AACnC,MAAM,6BAA6B;AACnC,MAAM,uBAAuB;AAG7B,MAAM,YAAY;AAAA,EAChB,CAAC,4BAA4B,EAAEA,QAAO;AACpC,IAAAA,OAAM,UAAU;AAChB,IAAAA,OAAM,QAAQ;AAAA,EACf;AAAA,EACD,CAAC,4BAA4B,EAAEA,QAAO,OAAO;AAC3C,IAAAA,OAAM,gBAAgB;AACtB,IAAAA,OAAM,UAAU;AAAA,EACjB;AAAA,EACD,CAAC,4BAA4B,EAAEA,QAAO,OAAO;AAC3C,IAAAA,OAAM,UAAU;AAChB,IAAAA,OAAM,QAAQ;AAAA,EACf;AAAA,EACD,CAAC,iCAAiC,EAAEA,QAAO;AACzC,IAAAA,OAAM,UAAU;AAChB,IAAAA,OAAM,QAAQ;AAAA,EACf;AAAA,EACD,CAAC,iCAAiC,EAAEA,QAAO,MAAM;AAC/C,IAAAA,OAAM,qBAAqB;AAC3B,IAAAA,OAAM,UAAU;AAAA,EACjB;AAAA,EACD,CAAC,iCAAiC,EAAEA,QAAO,OAAO;AAChD,IAAAA,OAAM,UAAU;AAChB,IAAAA,OAAM,QAAQ;AAAA,EACf;AAAA,EACD,CAAC,8BAA8B,EAAEA,QAAO;AACtC,IAAAA,OAAM,UAAU;AAChB,IAAAA,OAAM,QAAQ;AAAA,EACf;AAAA,EACD,CAAC,8BAA8B,EAAEA,QAAO,MAAM;AAC5C,IAAAA,OAAM,kBAAkB;AACxB,IAAAA,OAAM,UAAU;AAAA,EACjB;AAAA,EACD,CAAC,8BAA8B,EAAEA,QAAO,OAAO;AAC7C,IAAAA,OAAM,UAAU;AAChB,IAAAA,OAAM,QAAQ;AAAA,EACf;AAAA,EACD,CAAC,0BAA0B,EAAEA,QAAO;AAClC,IAAAA,OAAM,UAAU;AAChB,IAAAA,OAAM,QAAQ;AAAA,EACf;AAAA,EACD,CAAC,0BAA0B,EAAEA,QAAO,MAAM;AACxC,IAAAA,OAAM,cAAc;AACpB,IAAAA,OAAM,UAAU;AAAA,EACjB;AAAA,EACD,CAAC,0BAA0B,EAAEA,QAAO,OAAO;AACzC,IAAAA,OAAM,UAAU;AAChB,IAAAA,OAAM,QAAQ;AAAA,EACf;AAAA,EACD,CAAC,oBAAoB,EAAEA,QAAO,WAAW;AACvC,IAAAA,OAAM,kBAAkB;AAAA,EACzB;AACH;AAGA,MAAM,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMd,MAAM,mBAAmB,EAAE,QAAQ,OAAAA,UAAS;;AAC1C,WAAO,4BAA4B;AAEnC,QAAI;AAEF,YAAM,WAAW,MAAMC,8BAAS,QAAQ,iBAAiB;AAAA,QACvD,WAAWD,OAAM;AAAA,MACzB,CAAO;AAED,aAAO,8BAA8B,SAAS,IAAI;AAClD,aAAO,SAAS;AAAA,IACjB,SAAQ,OAAO;AACd,YAAM,aAAW,iBAAM,aAAN,mBAAgB,SAAhB,mBAAsB,YAAW;AAClD,aAAO,8BAA8B,QAAQ;AAC7C,aAAO,QAAQ,OAAO,KAAK;AAAA,IAC5B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQD,MAAM,wBAAwB,EAAE,QAAQ,OAAAA,OAAK,GAAI,UAAU;;AACzD,WAAO,iCAAiC;AAExC,QAAI;AAEF,YAAM,WAAW,MAAMC,8BAAS,QAAQ,sBAAsB;AAAA,QAC5D,WAAWD,OAAM;AAAA,QACjB;AAAA,MACR,CAAO;AAED,aAAO,mCAAmC,SAAS,IAAI;AACvD,aAAO,SAAS;AAAA,IACjB,SAAQ,OAAO;AACd,YAAM,aAAW,iBAAM,aAAN,mBAAgB,SAAhB,mBAAsB,YAAW;AAClD,aAAO,mCAAmC,QAAQ;AAClD,aAAO,QAAQ,OAAO,KAAK;AAAA,IAC5B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,MAAM,qBAAqB,EAAE,QAAQ,OAAAA,UAAS;;AAC5C,WAAO,8BAA8B;AAErC,QAAI;AAEF,YAAM,WAAW,MAAMC,8BAAS,QAAQ,mBAAmB;AAAA,QACzD,WAAWD,OAAM;AAAA,MACzB,CAAO;AAED,aAAO,gCAAgC,SAAS,IAAI;AACpD,aAAO,SAAS;AAAA,IACjB,SAAQ,OAAO;AACd,YAAM,aAAW,iBAAM,aAAN,mBAAgB,SAAhB,mBAAsB,YAAW;AAClD,aAAO,gCAAgC,QAAQ;AAC/C,aAAO,QAAQ,OAAO,KAAK;AAAA,IAC5B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,MAAM,iBAAiB,EAAE,QAAQ,OAAAA,UAAS;;AACxC,WAAO,0BAA0B;AAEjC,QAAI;AAEF,YAAM,WAAW,MAAMC,8BAAS,QAAQ,eAAe;AAAA,QACrD,WAAWD,OAAM;AAAA,MACzB,CAAO;AAED,aAAO,4BAA4B,SAAS,IAAI;AAChD,aAAO,SAAS;AAAA,IACjB,SAAQ,OAAO;AACd,YAAM,aAAW,iBAAM,aAAN,mBAAgB,SAAhB,mBAAsB,YAAW;AAClD,aAAO,4BAA4B,QAAQ;AAC3C,aAAO,QAAQ,OAAO,KAAK;AAAA,IAC5B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,mBAAmB,EAAE,OAAQ,GAAE,WAAW;AACxC,WAAO,sBAAsB,SAAS;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,MAAM,aAAa,EAAE,YAAY;AAC/B,QAAI;AACF,YAAM,QAAQ,IAAI;AAAA,QAChB,SAAS,oBAAoB;AAAA,QAC7B,SAAS,yBAAyB;AAAA,QAClC,SAAS,sBAAsB;AAAA,QAC/B,SAAS,kBAAkB;AAAA,MACnC,CAAO;AAED,aAAO,EAAE,SAAS;IACnB,SAAQ,OAAO;AACdE,oBAAc,MAAA,MAAA,SAAA,8CAAA,aAAa,KAAK;AAChC,aAAO,EAAE,SAAS,OAAO;IAC1B;AAAA,EACF;AACH;AAEA,MAAe,aAAA;AAAA,EACb,YAAY;AAAA,EACZ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;;"}