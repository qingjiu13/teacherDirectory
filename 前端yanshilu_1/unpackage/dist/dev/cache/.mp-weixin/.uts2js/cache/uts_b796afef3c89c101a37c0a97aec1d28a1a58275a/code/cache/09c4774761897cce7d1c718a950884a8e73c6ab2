{"code":"import { defineComponent } from \"vue\";\n/**\n * @description 我的页面（通用）\n */\nimport { Navigator, MineRoutes } from '@/router/Router.js';\nimport TabBar from '../../../components/tab-bar/tab-bar.uvue';\nexport default defineComponent({\n    components: {\n        TabBar\n    },\n    data() {\n        return {\n            userRole: 'student',\n            userName: '',\n            userData: new UTSJSONObject({}),\n            isLoggedIn: false,\n            MineRoutes // 引入路由对象方便模板使用\n        };\n    },\n    onLoad() {\n        // 获取用户角色信息\n        const storedUserRole = uni.getStorageSync('userRole');\n        if (storedUserRole) {\n            this.userRole = storedUserRole;\n        }\n        this.loadUserData();\n        uni.__f__('log', 'at pages/mine/mine/mine_common.uvue:148', \"当前用户角色:\", this.userRole); // 调试输出\n    },\n    onShow() {\n        // 每次显示页面时检查登录状态，以便更新页面显示\n        this.loadUserData();\n        // 获取最新的用户角色信息\n        const storedUserRole = uni.getStorageSync('userRole');\n        if (storedUserRole) {\n            this.userRole = storedUserRole;\n            uni.__f__('log', 'at pages/mine/mine/mine_common.uvue:158', \"onShow 更新用户角色:\", this.userRole); // 调试输出\n        }\n    },\n    methods: {\n        /**\n         * @description 加载用户数据\n         */\n        loadUserData() {\n            // 检查登录状态\n            const token = uni.getStorageSync('token');\n            this.isLoggedIn = !!token;\n            if (this.isLoggedIn) {\n                // 获取用户信息\n                const userInfo = uni.getStorageSync('userInfo');\n                if (userInfo) {\n                    try {\n                        this.userData = typeof userInfo === 'string' ? UTS.JSON.parse(userInfo) : userInfo;\n                        this.userName = this.userData.nickname || '用户';\n                        // 如果存储中有用户角色，使用存储的角色\n                        if (this.userData.role) {\n                            this.userRole = this.userData.role;\n                            // 同步更新到storage\n                            uni.setStorageSync('userRole', this.userData.role);\n                        }\n                    }\n                    catch (e) {\n                        uni.__f__('error', 'at pages/mine/mine/mine_common.uvue:185', '解析用户信息失败:', e);\n                    }\n                }\n            }\n            else {\n                this.userData = new UTSJSONObject({});\n                this.userName = '';\n                // 未登录时默认显示学生界面\n                this.userRole = 'student';\n            }\n            uni.__f__('log', 'at pages/mine/mine/mine_common.uvue:195', \"加载用户数据后的角色:\", this.userRole); // 调试输出\n        },\n        /**\n         * @description 处理头像点击\n         */\n        handleAvatarClick() {\n            if (!this.isLoggedIn) {\n                // 未登录，跳转到登录页\n                Navigator.toLogin();\n            }\n            else {\n                // 已登录，跳转到个人资料页\n                this.handleEditProfile();\n            }\n        },\n        /**\n         * @description 处理登录文本点击\n         */\n        handleLoginClick() {\n            if (!this.isLoggedIn) {\n                // 未登录，跳转到登录页\n                Navigator.toLogin();\n            }\n            else {\n                // 已登录，跳转到个人资料页\n                this.handleEditProfile();\n            }\n        },\n        /**\n         * @description 跳转到修改个人信息页面\n         */\n        handleEditProfile() {\n            if (!this.isLoggedIn) {\n                Navigator.toLogin();\n                return null;\n            }\n            // 跳转到个人信息修改页面\n            Navigator.toModify();\n        },\n        /**\n         * @description 页面跳转方法\n         * @param {string} url - 目标页面路径\n         */\n        navigateTo(url = null) {\n            // 有些页面需要登录才能访问\n            if (!this.isLoggedIn) {\n                // 未登录，跳转到登录页\n                Navigator.toLogin();\n                return null;\n            }\n            // 正常跳转\n            Navigator.navigateTo(url);\n        },\n        /**\n         * @description 处理退出登录\n         */\n        handleLogout() {\n            uni.showModal({\n                title: '提示',\n                content: '确定要退出登录吗？',\n                success: (res) => {\n                    if (res.confirm) {\n                        // 清除登录信息\n                        uni.removeStorageSync('token');\n                        uni.removeStorageSync('userInfo');\n                        uni.removeStorageSync('userRole');\n                        // 更新页面显示\n                        this.isLoggedIn = false;\n                        this.userData = new UTSJSONObject({});\n                        this.userName = '';\n                        this.userRole = 'student'; // 退出后默认显示学生界面\n                        uni.showToast({\n                            title: '已退出登录',\n                            icon: 'success'\n                        });\n                    }\n                }\n            });\n        }\n    }\n});\n//# sourceMappingURL=E:/%E7%A0%94%E5%B8%88%E5%BD%95%E4%B8%8E%E5%85%B6%E4%BB%96%E4%BA%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/teacherDirectory/%E5%89%8D%E7%AB%AFyanshilu_1/pages/mine/mine/mine_common.uvue?vue&type=script&lang.uts.js.map","references":["E:/研师录与其他人共享文件/teacherDirectory/前端yanshilu_1/router/Router.js","E:/研师录与其他人共享文件/teacherDirectory/前端yanshilu_1/components/tab-bar/tab-bar.uvue.ts"],"uniExtApis":["uni.getStorageSync","uni.__f__","uni.setStorageSync","uni.showModal","uni.removeStorageSync","uni.showToast"],"map":"{\"version\":3,\"file\":\"mine_common.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"mine_common.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
