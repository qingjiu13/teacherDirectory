{"version":3,"file":"HistorySidebar.js","sources":["components/ai-chat/HistorySidebar.uvue","../../HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RToveWFuc2hpbHXph43mlrDmnaXov4cv5YmN56uveWFuc2hpbHVfMS9jb21wb25lbnRzL2FpLWNoYXQvSGlzdG9yeVNpZGViYXIudXZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"history-sidebar\" :class=\"{visible: visible}\">\r\n\t\t<view class=\"sidebar-header\">\r\n\t\t\t<text class=\"sidebar-title\">历史记录</text>\r\n\t\t</view>\r\n\t\t<scroll-view class=\"history-list\" scroll-y=\"true\">\r\n\t\t\t<view class=\"empty-history\" v-if=\"historySummaries.length === 0\">\r\n\t\t\t\t<text class=\"empty-history-text\">暂无历史记录</text>\r\n\t\t\t</view>\r\n\t\t\t<view v-else>\r\n\t\t\t\t<view \r\n\t\t\t\t\tv-for=\"(item, index) in historySummaries\" \r\n\t\t\t\t\t:key=\"item.id\" \r\n\t\t\t\t\tclass=\"history-item\"\r\n\t\t\t\t\t:class=\"{'active': currentChatId === item.id}\"\r\n\t\t\t\t\t@click=\"loadChatHistory(item.id)\">\r\n\t\t\t\t\t<view class=\"history-item-content\">\r\n\t\t\t\t\t\t<text class=\"history-title\">{{item.title || '对话 ' + (index + 1)}}</text>\r\n\t\t\t\t\t\t<text class=\"history-time\">{{formatTime(item.updatedAt || item.createdAt)}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"history-delete\" @click.stop=\"deleteChatHistory(item.id, $event)\">\r\n\t\t\t\t\t\t<text class=\"delete-icon\">×</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t</view>\r\n</template>\r\n\r\n<script lang=\"uts\">\r\n\t/**\r\n\t * @description 历史记录侧边栏组件\r\n\t * @property {Boolean} visible - 侧边栏是否可见\r\n\t * @property {Array} historySummaries - 历史聊天摘要数组（只包含ID和标题等基本信息）\r\n\t * @property {String} currentChatId - 当前选中的聊天ID\r\n\t * @event {Function} loadChat - 加载聊天历史记录\r\n\t * @event {Function} deleteChat - 删除聊天历史记录\r\n\t */\r\n\texport default {\r\n\t\tname: \"HistorySidebar\",\r\n\t\tprops: {\r\n\t\t\tvisible: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\thistorySummaries: {\r\n\t\t\t\ttype: Array,\r\n\t\t\t\tdefault: () => []\r\n\t\t\t},\r\n\t\t\tcurrentChatId: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t/**\r\n\t\t\t * @description 加载聊天历史\r\n\t\t\t * @param {String} chatId - 聊天ID\r\n\t\t\t */\r\n\t\t\tloadChatHistory(chatId) {\r\n\t\t\t\tthis.$emit('loadChat', chatId);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t/**\r\n\t\t\t * @description 删除历史记录\r\n\t\t\t * @param {String} chatId - 聊天ID\r\n\t\t\t * @param {Event} e - 事件对象，用于阻止冒泡\r\n\t\t\t */\r\n\t\t\tdeleteChatHistory(chatId, e) {\r\n\t\t\t\t// 确保阻止事件冒泡，避免触发点击加载历史记录\r\n\t\t\t\tif (e) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tuni.__f__('log','at components/ai-chat/HistorySidebar.uvue:76','删除历史记录:', chatId);\r\n\t\t\t\tthis.$emit('deleteChat', chatId);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t/**\r\n\t\t\t * @description 格式化时间\r\n\t\t\t * @param {Date|String} time - 时间对象或时间字符串\r\n\t\t\t * @returns {String} 格式化后的时间字符串\r\n\t\t\t */\r\n\t\t\tformatTime(time) {\r\n\t\t\t\tif (!time) return '';\r\n\t\t\t\t\r\n\t\t\t\tconst date = new Date(time);\r\n\t\t\t\tconst year = date.getFullYear();\r\n\t\t\t\tconst month = String(date.getMonth() + 1).padStart(2, '0');\r\n\t\t\t\tconst day = String(date.getDate()).padStart(2, '0');\r\n\t\t\t\tconst hours = String(date.getHours()).padStart(2, '0');\r\n\t\t\t\tconst minutes = String(date.getMinutes()).padStart(2, '0');\r\n\t\t\t\t\r\n\t\t\t\treturn `${year}-${month}-${day} ${hours}:${minutes}`;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.history-sidebar {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 66vw; /* 占屏幕宽度的2/3 */\r\n\t\theight: 100vh;\r\n\t\tbackground-color: #ffffff;\r\n\t\ttransform: translateX(-100%);\r\n\t\ttransition: transform 0.3s ease;\r\n\t\tz-index: 999;\r\n\t\tbox-shadow: 0 0 20rpx rgba(0, 0, 0, 0.1);\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\t\r\n\t.history-sidebar.visible {\r\n\t\ttransform: translateX(0);\r\n\t}\r\n\t\r\n\t.sidebar-header {\r\n\t\tpadding: 30rpx 20rpx;\r\n\t\tborder-bottom: 1rpx solid #eee;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\theight: 80rpx;\r\n\t}\r\n\t\r\n\t.sidebar-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\t\r\n\t.history-list {\r\n\t\tflex: 1;\r\n\t\theight: calc(100vh - 80rpx);\r\n\t\tpadding: 0;\r\n\t\tbackground-color: #f9f9f9;\r\n\t}\r\n\t\r\n\t.empty-history {\r\n\t\theight: 100%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 40rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.empty-history-text {\r\n\t\tcolor: #999;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t.history-item {\r\n\t\tpadding: 30rpx 20rpx;\r\n\t\tbackground-color: #ffffff;\r\n\t\tmargin-bottom: 2rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\t\ttransition: all 0.2s;\r\n\t}\r\n\t\r\n\t.history-item:active {\r\n\t\tbackground-color: #f5f5f5;\r\n\t}\r\n\t\r\n\t.history-item.active {\r\n\t\tbackground-color: #e6f7ff;\r\n\t\tborder-left: 4rpx solid #1890ff;\r\n\t}\r\n\t\r\n\t.history-item-content {\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t\r\n\t.history-title {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 10rpx;\r\n\t\t/* 单行文本截断 */\r\n\t\twhite-space: nowrap;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\tmax-width: 80%;\r\n\t}\r\n\t\r\n\t.history-time {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.history-delete {\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tmargin-left: 20rpx;\r\n\t}\r\n\t\r\n\t.delete-icon {\r\n\t\tfont-size: 36rpx;\r\n\t\tcolor: #ff4d4f;\r\n\t\tline-height: 1;\r\n\t}\r\n</style> ","import Component from 'E:/yanshilu重新来过/前端yanshilu_1/components/ai-chat/HistorySidebar.uvue'\nwx.createComponent(Component)"],"names":["defineComponent","uni"],"mappings":";;AAsCC,MAAA,YAAeA,8BAAA;AAAA,EACd,MAAM;AAAA,EACN,OAAO;AAAA,IACN,SAAS;AAAA,MACR,MAAM;AAAA,MACN,SAAS;AAAA,IACT;AAAA,IACD,kBAAkB;AAAA,MACjB,MAAM;AAAA,MACN,SAAS,MAAA;AAAM,eAAA,CAAA;AAAA,MAAC;AAAA,IAChB;AAAA,IACD,eAAe;AAAA,MACd,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,EACA;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,IAKR,gBAAgB,SAAM,MAAA;AACrB,WAAK,MAAM,YAAY,MAAM;AAAA,IAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOD,kBAAkB,SAAM,MAAE,IAAC,MAAA;AAE1B,UAAI,GAAG;AACN,UAAE,gBAAe;AACjB,UAAE,eAAc;AAAA,MACjB;AAEAC,oBAAG,MAAC,MAAM,OAAM,gDAA+C,WAAW,MAAM;AAChF,WAAK,MAAM,cAAc,MAAM;AAAA,IAC/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOD,WAAW,OAAI,MAAA;AACd,UAAI,CAAC;AAAM,eAAO;AAElB,YAAM,OAAO,IAAI,KAAK,IAAI;AAC1B,YAAM,OAAO,KAAK;AAClB,YAAM,QAAQ,OAAO,KAAK,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG;AACzD,YAAM,MAAM,OAAO,KAAK,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAClD,YAAM,QAAQ,OAAO,KAAK,SAAU,CAAA,EAAE,SAAS,GAAG,GAAG;AACrD,YAAM,UAAU,OAAO,KAAK,WAAY,CAAA,EAAE,SAAS,GAAG,GAAG;AAEzD,aAAO,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG,IAAI,KAAK,IAAI,OAAO;AAAA,IACnD;AAAA,EACD;CACD;;;;;;;;;;;;;;;;;;;;;AChGD,GAAG,gBAAgB,SAAS;"}