{"version":3,"file":"teacher.js","sources":["store/modules/common/teacher.js"],"sourcesContent":["/**\r\n * @description 老师详情功能Vuex模块\r\n * 获取和管理老师详细信息\r\n */\r\n\r\nimport { match, mock } from '../../services';\r\n\r\n// 初始状态\r\nconst state = {\r\n  // 老师基本信息\r\n  teacherInfo: {\r\n    id: null,\r\n    nickname: '',\r\n    avatar: '',\r\n    school: '',\r\n    major: '',\r\n    score: '',\r\n    tags: [],\r\n    introduction: ''\r\n  },\r\n  \r\n  // 老师服务列表\r\n  services: [],\r\n  \r\n  // 加载状态\r\n  loading: false,\r\n  error: null\r\n};\r\n\r\n// Getters\r\nconst getters = {\r\n  /**\r\n   * @description 获取老师详情\r\n   * @param {Object} state - Vuex状态\r\n   * @returns {Object} 老师详情\r\n   */\r\n  teacherInfo: state => state.teacherInfo,\r\n  \r\n  /**\r\n   * @description 获取老师服务列表\r\n   * @param {Object} state - Vuex状态\r\n   * @returns {Array} 服务列表\r\n   */\r\n  services: state => state.services,\r\n  \r\n  /**\r\n   * @description 获取加载状态\r\n   * @param {Object} state - Vuex状态\r\n   * @returns {Boolean} 是否正在加载\r\n   */\r\n  isLoading: state => state.loading,\r\n  \r\n  /**\r\n   * @description 获取错误信息\r\n   * @param {Object} state - Vuex状态\r\n   * @returns {Object} 错误信息\r\n   */\r\n  error: state => state.error\r\n};\r\n\r\n// 引入常量类型\r\nconst SET_TEACHER_INFO = 'SET_TEACHER_INFO';\r\nconst SET_SERVICES = 'SET_SERVICES';\r\nconst SET_LOADING = 'SET_LOADING';\r\nconst SET_ERROR = 'SET_ERROR';\r\nconst RESET_TEACHER = 'RESET_TEACHER';\r\n\r\n// Mutations\r\nconst mutations = {\r\n  [SET_TEACHER_INFO](state, teacherInfo) {\r\n    state.teacherInfo = teacherInfo;\r\n  },\r\n  \r\n  [SET_SERVICES](state, services) {\r\n    state.services = services;\r\n  },\r\n  \r\n  [SET_LOADING](state, loading) {\r\n    state.loading = loading;\r\n  },\r\n  \r\n  [SET_ERROR](state, error) {\r\n    state.error = error;\r\n  },\r\n  \r\n  [RESET_TEACHER](state) {\r\n    state.teacherInfo = {\r\n      id: null,\r\n      nickname: '',\r\n      avatar: '',\r\n      school: '',\r\n      major: '',\r\n      score: '',\r\n      tags: [],\r\n      introduction: ''\r\n    };\r\n    state.services = [];\r\n  }\r\n};\r\n\r\n// Actions\r\nconst actions = {\r\n  /**\r\n   * @description 获取老师详情和服务列表（合并API）\r\n   * @param {Object} context - Vuex上下文\r\n   * @param {Number} teacherId - 老师ID\r\n   * @returns {Promise<Object>} 结果对象\r\n   */\r\n  async getTeacherInfo({ commit, rootState }, teacherId) {\r\n    try {\r\n      commit(SET_LOADING, true);\r\n      commit(SET_ERROR, null);\r\n      \r\n      // 尝试从match模块中找到这个老师的基本信息\r\n      let teacherBasicInfo = null;\r\n      \r\n      if (rootState.match && rootState.match.teachers) {\r\n        teacherBasicInfo = rootState.match.teachers.find(t => t.id === parseInt(teacherId));\r\n      }\r\n      \r\n      // API调用 - match.api.js会根据环境自动选择真实API或模拟数据\r\n      const response = await match.getTeacherDetail(teacherId);\r\n      \r\n      if (!response.success) {\r\n        throw response.error || { message: '获取老师详情失败' };\r\n      }\r\n      \r\n      // 从API响应中提取老师信息和服务列表\r\n      const teacherDetail = response.data.teacher;\r\n      const services = response.data.services || [];\r\n      \r\n      // 更新state\r\n      commit(SET_TEACHER_INFO, teacherDetail);\r\n      commit(SET_SERVICES, services);\r\n      \r\n      return { success: true, data: response.data };\r\n    } catch (error) {\r\n      console.error('获取老师详情失败:', error);\r\n      commit(SET_ERROR, error);\r\n      return { success: false, error };\r\n    } finally {\r\n      commit(SET_LOADING, false);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 重置老师信息\r\n   * @param {Object} context - Vuex上下文\r\n   */\r\n  resetTeacher({ commit }) {\r\n    commit(RESET_TEACHER);\r\n  },\r\n  \r\n  /**\r\n   * @description 清除错误信息\r\n   * @param {Object} context - Vuex上下文\r\n   */\r\n  clearError({ commit }) {\r\n    commit(SET_ERROR, null);\r\n  },\r\n  \r\n  /**\r\n   * @description 初始化老师模块数据\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Object>} 结果对象\r\n   */\r\n  async loadInitialData({ commit }) {\r\n    // 在这里可以加载一些基础数据\r\n    // 重置状态以确保初始化\r\n    commit(RESET_TEACHER);\r\n    \r\n    return { success: true };\r\n  }\r\n};\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  getters,\r\n  mutations,\r\n  actions\r\n}; "],"names":["state","match.getTeacherDetail","uni"],"mappings":"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"}