{"version":3,"file":"mutations.js","sources":["store/modules/user/mutations.js"],"sourcesContent":["/**\r\n * @description 用户模块的mutations\r\n */\r\n\r\nexport default {\r\n  /**\r\n   * @description 设置登录状态\r\n   * @param {Object} state - 状态对象\r\n   * @param {boolean} isLoggedIn - 是否已登录\r\n   */\r\n  SET_LOGGED_IN(state, isLoggedIn) {\r\n    state.isLoggedIn = isLoggedIn;\r\n    // 将登录状态保存到本地存储\r\n    uni.setStorageSync('isLoggedIn', isLoggedIn);\r\n  },\r\n  \r\n  /**\r\n   * @description 设置用户角色\r\n   * @param {Object} state - 状态对象\r\n   * @param {string} role - 用户角色\r\n   */\r\n  SET_ROLE(state, role) {\r\n    state.role = role;\r\n    // 将角色保存到本地存储\r\n    uni.setStorageSync('role', role);\r\n  },\r\n  \r\n  /**\r\n   * @description 设置认证信息\r\n   * @param {Object} state - 状态对象\r\n   * @param {Object} authData - 认证数据\r\n   * @param {string} authData.token - 访问令牌\r\n   * @param {string} authData.refreshToken - 刷新令牌\r\n   * @param {number} authData.expiresIn - 过期时间（秒）\r\n   */\r\n  SET_AUTH(state, authData) {\r\n    const { token, refreshToken, expiresIn } = authData;\r\n    const tokenExpireTime = Date.now() + (expiresIn * 1000);\r\n    \r\n    state.auth = {\r\n      token,\r\n      refreshToken,\r\n      tokenExpireTime\r\n    };\r\n    \r\n    // 将认证信息保存到本地存储\r\n    uni.setStorageSync('token', token);\r\n    uni.setStorageSync('refreshToken', refreshToken);\r\n    uni.setStorageSync('tokenExpireTime', tokenExpireTime);\r\n  },\r\n  \r\n  /**\r\n   * @description 设置用户信息\r\n   * @param {Object} state - 状态对象\r\n   * @param {Object} userInfo - 用户信息\r\n   */\r\n  SET_USER_INFO(state, userInfo) {\r\n    state.userInfo = userInfo;\r\n    \r\n    // 将基本用户信息保存到本地存储\r\n    uni.setStorageSync('userBaseInfo', {\r\n      name: userInfo.name,\r\n      avatar: userInfo.avatar,\r\n      tags: userInfo.tags || []\r\n    });\r\n    \r\n    // 将详细用户信息保存到本地存储\r\n    uni.setStorageSync('userDetailInfo', JSON.stringify(userInfo));\r\n  },\r\n  \r\n  /**\r\n   * @description 更新用户信息（部分更新）\r\n   * @param {Object} state - 状态对象\r\n   * @param {Object} partialInfo - 部分用户信息\r\n   */\r\n  UPDATE_USER_INFO(state, partialInfo) {\r\n    state.userInfo = {\r\n      ...state.userInfo,\r\n      ...partialInfo\r\n    };\r\n    \r\n    // 更新本地存储\r\n    if (partialInfo.name || partialInfo.avatar || partialInfo.tags) {\r\n      uni.setStorageSync('userBaseInfo', {\r\n        name: state.userInfo.name,\r\n        avatar: state.userInfo.avatar,\r\n        tags: state.userInfo.tags || []\r\n      });\r\n    }\r\n    \r\n    uni.setStorageSync('userDetailInfo', JSON.stringify(state.userInfo));\r\n  },\r\n  \r\n  /**\r\n   * @description 设置用户权限\r\n   * @param {Object} state - 状态对象\r\n   * @param {Array} permissions - 权限列表\r\n   */\r\n  SET_PERMISSIONS(state, permissions) {\r\n    state.permissions = permissions;\r\n  },\r\n  \r\n  /**\r\n   * @description 清除认证信息\r\n   * @param {Object} state - 状态对象\r\n   */\r\n  CLEAR_AUTH(state) {\r\n    state.isLoggedIn = false;\r\n    state.role = null;\r\n    state.auth = {\r\n      token: null,\r\n      refreshToken: null,\r\n      tokenExpireTime: null\r\n    };\r\n    state.userInfo = {\r\n      name: '',\r\n      avatar: '',\r\n      tags: [],\r\n      balance: null,\r\n      bio: '',\r\n      contact: {\r\n        phone: '',\r\n        email: '',\r\n        wechat: ''\r\n      },\r\n      notifications: {\r\n        unread: 0,\r\n        messages: []\r\n      }\r\n    };\r\n    state.permissions = [];\r\n    \r\n    // 清除本地存储\r\n    uni.removeStorageSync('token');\r\n    uni.removeStorageSync('refreshToken');\r\n    uni.removeStorageSync('tokenExpireTime');\r\n    uni.removeStorageSync('isLoggedIn');\r\n    uni.removeStorageSync('role');\r\n    uni.removeStorageSync('userBaseInfo');\r\n    uni.removeStorageSync('userDetailInfo');\r\n  },\r\n  \r\n  /**\r\n   * @description 设置注册状态\r\n   * @param {Object} state - 状态对象\r\n   * @param {Object} registrationData - 注册数据\r\n   * @param {number} registrationData.step - 当前步骤\r\n   * @param {boolean} registrationData.completed - 是否完成\r\n   * @param {Object} registrationData.data - 注册数据\r\n   */\r\n  SET_REGISTRATION(state, registrationData) {\r\n    state.registration = {\r\n      ...state.registration,\r\n      ...registrationData\r\n    };\r\n  }\r\n}; "],"names":["uni"],"mappings":";;AAIA,MAAe,YAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMb,cAAc,OAAO,YAAY;AAC/B,UAAM,aAAa;AAEnBA,kBAAAA,MAAI,eAAe,cAAc,UAAU;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,SAAS,OAAO,MAAM;AACpB,UAAM,OAAO;AAEbA,kBAAAA,MAAI,eAAe,QAAQ,IAAI;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUD,SAAS,OAAO,UAAU;AACxB,UAAM,EAAE,OAAO,cAAc,UAAS,IAAK;AAC3C,UAAM,kBAAkB,KAAK,IAAK,IAAI,YAAY;AAElD,UAAM,OAAO;AAAA,MACX;AAAA,MACA;AAAA,MACA;AAAA,IACN;AAGIA,kBAAAA,MAAI,eAAe,SAAS,KAAK;AACjCA,kBAAAA,MAAI,eAAe,gBAAgB,YAAY;AAC/CA,kBAAAA,MAAI,eAAe,mBAAmB,eAAe;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,cAAc,OAAO,UAAU;AAC7B,UAAM,WAAW;AAGjBA,kBAAG,MAAC,eAAe,gBAAgB;AAAA,MACjC,MAAM,SAAS;AAAA,MACf,QAAQ,SAAS;AAAA,MACjB,MAAM,SAAS,QAAQ,CAAE;AAAA,IAC/B,CAAK;AAGDA,kBAAG,MAAC,eAAe,kBAAkB,KAAK,UAAU,QAAQ,CAAC;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,iBAAiB,OAAO,aAAa;AACnC,UAAM,WAAW;AAAA,MACf,GAAG,MAAM;AAAA,MACT,GAAG;AAAA,IACT;AAGI,QAAI,YAAY,QAAQ,YAAY,UAAU,YAAY,MAAM;AAC9DA,oBAAG,MAAC,eAAe,gBAAgB;AAAA,QACjC,MAAM,MAAM,SAAS;AAAA,QACrB,QAAQ,MAAM,SAAS;AAAA,QACvB,MAAM,MAAM,SAAS,QAAQ,CAAE;AAAA,MACvC,CAAO;AAAA,IACF;AAEDA,kBAAG,MAAC,eAAe,kBAAkB,KAAK,UAAU,MAAM,QAAQ,CAAC;AAAA,EACpE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,gBAAgB,OAAO,aAAa;AAClC,UAAM,cAAc;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA;AAAA,EAMD,WAAW,OAAO;AAChB,UAAM,aAAa;AACnB,UAAM,OAAO;AACb,UAAM,OAAO;AAAA,MACX,OAAO;AAAA,MACP,cAAc;AAAA,MACd,iBAAiB;AAAA,IACvB;AACI,UAAM,WAAW;AAAA,MACf,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,MAAM,CAAE;AAAA,MACR,SAAS;AAAA,MACT,KAAK;AAAA,MACL,SAAS;AAAA,QACP,OAAO;AAAA,QACP,OAAO;AAAA,QACP,QAAQ;AAAA,MACT;AAAA,MACD,eAAe;AAAA,QACb,QAAQ;AAAA,QACR,UAAU,CAAE;AAAA,MACb;AAAA,IACP;AACI,UAAM,cAAc;AAGpBA,wBAAI,kBAAkB,OAAO;AAC7BA,wBAAI,kBAAkB,cAAc;AACpCA,wBAAI,kBAAkB,iBAAiB;AACvCA,wBAAI,kBAAkB,YAAY;AAClCA,wBAAI,kBAAkB,MAAM;AAC5BA,wBAAI,kBAAkB,cAAc;AACpCA,wBAAI,kBAAkB,gBAAgB;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUD,iBAAiB,OAAO,kBAAkB;AACxC,UAAM,eAAe;AAAA,MACnB,GAAG,MAAM;AAAA,MACT,GAAG;AAAA,IACT;AAAA,EACG;AACH;;"}