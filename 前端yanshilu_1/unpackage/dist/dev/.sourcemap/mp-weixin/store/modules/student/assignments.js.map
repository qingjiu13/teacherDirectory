{"version":3,"file":"assignments.js","sources":["store/modules/student/assignments.js"],"sourcesContent":["/**\r\n * @description 学生作业管理模块\r\n */\r\nimport { services } from '../../services';\r\n\r\n// 初始状态\r\nconst state = {\r\n  pendingAssignments: [],  // 待完成作业\r\n  completedAssignments: [], // 已完成作业\r\n  currentAssignment: null, // 当前正在查看的作业\r\n  loading: false,\r\n  error: null\r\n};\r\n\r\n// Getters\r\nconst getters = {\r\n  pendingAssignments: state => state.pendingAssignments,\r\n  completedAssignments: state => state.completedAssignments,\r\n  currentAssignment: state => state.currentAssignment,\r\n  loading: state => state.loading,\r\n  error: state => state.error,\r\n  \r\n  /**\r\n   * @description 获取作业总数\r\n   * @returns {Number} 作业总数\r\n   */\r\n  totalAssignments: state => state.pendingAssignments.length + state.completedAssignments.length\r\n};\r\n\r\n// 引入常量类型\r\nconst FETCH_ASSIGNMENTS_REQUEST = 'FETCH_ASSIGNMENTS_REQUEST';\r\nconst FETCH_ASSIGNMENTS_SUCCESS = 'FETCH_ASSIGNMENTS_SUCCESS';\r\nconst FETCH_ASSIGNMENTS_FAILURE = 'FETCH_ASSIGNMENTS_FAILURE';\r\nconst FETCH_ASSIGNMENT_DETAIL_REQUEST = 'FETCH_ASSIGNMENT_DETAIL_REQUEST';\r\nconst FETCH_ASSIGNMENT_DETAIL_SUCCESS = 'FETCH_ASSIGNMENT_DETAIL_SUCCESS';\r\nconst FETCH_ASSIGNMENT_DETAIL_FAILURE = 'FETCH_ASSIGNMENT_DETAIL_FAILURE';\r\nconst SUBMIT_ASSIGNMENT_REQUEST = 'SUBMIT_ASSIGNMENT_REQUEST';\r\nconst SUBMIT_ASSIGNMENT_SUCCESS = 'SUBMIT_ASSIGNMENT_SUCCESS';\r\nconst SUBMIT_ASSIGNMENT_FAILURE = 'SUBMIT_ASSIGNMENT_FAILURE';\r\n\r\n// Mutations\r\nconst mutations = {\r\n  [FETCH_ASSIGNMENTS_REQUEST](state) {\r\n    state.loading = true;\r\n    state.error = null;\r\n  },\r\n  [FETCH_ASSIGNMENTS_SUCCESS](state, { pending, completed }) {\r\n    state.pendingAssignments = pending || [];\r\n    state.completedAssignments = completed || [];\r\n    state.loading = false;\r\n    state.error = null;\r\n  },\r\n  [FETCH_ASSIGNMENTS_FAILURE](state, error) {\r\n    state.loading = false;\r\n    state.error = error;\r\n  },\r\n  [FETCH_ASSIGNMENT_DETAIL_REQUEST](state) {\r\n    state.loading = true;\r\n    state.error = null;\r\n  },\r\n  [FETCH_ASSIGNMENT_DETAIL_SUCCESS](state, assignment) {\r\n    state.currentAssignment = assignment;\r\n    state.loading = false;\r\n    state.error = null;\r\n  },\r\n  [FETCH_ASSIGNMENT_DETAIL_FAILURE](state, error) {\r\n    state.loading = false;\r\n    state.error = error;\r\n  },\r\n  [SUBMIT_ASSIGNMENT_REQUEST](state) {\r\n    state.loading = true;\r\n    state.error = null;\r\n  },\r\n  [SUBMIT_ASSIGNMENT_SUCCESS](state, assignmentId) {\r\n    // 将提交的作业从待完成移动到已完成\r\n    const assignmentIndex = state.pendingAssignments.findIndex(a => a.id === assignmentId);\r\n    if (assignmentIndex !== -1) {\r\n      const assignment = {...state.pendingAssignments[assignmentIndex], status: 'completed'};\r\n      state.completedAssignments.push(assignment);\r\n      state.pendingAssignments.splice(assignmentIndex, 1);\r\n    }\r\n    state.loading = false;\r\n  },\r\n  [SUBMIT_ASSIGNMENT_FAILURE](state, error) {\r\n    state.loading = false;\r\n    state.error = error;\r\n  }\r\n};\r\n\r\n// Actions\r\nconst actions = {\r\n  /**\r\n   * @description 获取待完成的作业列表\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Array>} 待完成作业列表\r\n   */\r\n  async fetchPendingAssignments({ commit }) {\r\n    commit(FETCH_ASSIGNMENTS_REQUEST);\r\n    \r\n    try {\r\n      const response = await services.student.getAssignments();\r\n      const { pending, completed } = response.data;\r\n      \r\n      commit(FETCH_ASSIGNMENTS_SUCCESS, { pending, completed });\r\n      return pending;\r\n    } catch (error) {\r\n      commit(FETCH_ASSIGNMENTS_FAILURE, error.response?.data?.message || '获取作业列表失败');\r\n      return Promise.reject(error);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 获取作业详情\r\n   * @param {Object} context - Vuex上下文\r\n   * @param {String} assignmentId - 作业ID\r\n   * @returns {Promise<Object>} 作业详情\r\n   */\r\n  async fetchAssignmentDetail({ commit }, assignmentId) {\r\n    commit(FETCH_ASSIGNMENT_DETAIL_REQUEST);\r\n    \r\n    try {\r\n      const response = await services.student.getAssignmentDetail(assignmentId);\r\n      commit(FETCH_ASSIGNMENT_DETAIL_SUCCESS, response.data);\r\n      return response.data;\r\n    } catch (error) {\r\n      commit(FETCH_ASSIGNMENT_DETAIL_FAILURE, error.response?.data?.message || '获取作业详情失败');\r\n      return Promise.reject(error);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 提交作业\r\n   * @param {Object} context - Vuex上下文\r\n   * @param {Object} payload - 提交内容\r\n   * @param {String} payload.assignmentId - 作业ID\r\n   * @param {Object} payload.submission - 提交的作业内容\r\n   * @returns {Promise<Object>} 提交结果\r\n   */\r\n  async submitAssignment({ commit }, { assignmentId, submission }) {\r\n    commit(SUBMIT_ASSIGNMENT_REQUEST);\r\n    \r\n    try {\r\n      const response = await services.student.submitAssignment(assignmentId, submission);\r\n      commit(SUBMIT_ASSIGNMENT_SUCCESS, assignmentId);\r\n      return response.data;\r\n    } catch (error) {\r\n      commit(SUBMIT_ASSIGNMENT_FAILURE, error.response?.data?.message || '提交作业失败');\r\n      return Promise.reject(error);\r\n    }\r\n  }\r\n};\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  getters,\r\n  actions,\r\n  mutations\r\n}; "],"names":["state","services"],"mappings":"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"}