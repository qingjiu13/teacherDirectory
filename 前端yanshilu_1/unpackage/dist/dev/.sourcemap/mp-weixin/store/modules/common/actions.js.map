{"version":3,"file":"actions.js","sources":["store/modules/common/actions.js"],"sourcesContent":["/**\r\n * @description 公共模块的actions\r\n */\r\n\r\nexport default {\r\n  /**\r\n   * @description 初始化应用\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Object>} 初始化结果\r\n   */\r\n  async initApp({ dispatch, commit }) {\r\n    try {\r\n      commit('SET_LOADING', true);\r\n      \r\n      // 加载系统信息\r\n      await dispatch('loadSystemInfo');\r\n      \r\n      // 加载应用配置\r\n      await dispatch('loadAppConfig');\r\n      \r\n      // 设置系统主题\r\n      dispatch('setSystemTheme');\r\n      \r\n      // 检查登录状态\r\n      await dispatch('user/checkLoginStatus', null, { root: true });\r\n      \r\n      commit('SET_LOADING', false);\r\n      \r\n      return { success: true, message: '应用初始化成功' };\r\n    } catch (error) {\r\n      console.error('应用初始化失败:', error);\r\n      commit('SET_ERROR', error.message || '应用初始化失败');\r\n      commit('SET_LOADING', false);\r\n      return { success: false, error };\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 加载系统信息\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Object>} 系统信息\r\n   */\r\n  loadSystemInfo({ commit }) {\r\n    try {\r\n      const systemInfo = uni.getSystemInfoSync();\r\n      commit('SET_SYSTEM_INFO', systemInfo);\r\n      return { success: true, data: systemInfo };\r\n    } catch (error) {\r\n      console.error('获取系统信息失败:', error);\r\n      return { success: false, error };\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 加载应用配置\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Object>} 加载结果\r\n   */\r\n  loadAppConfig({ commit }) {\r\n    try {\r\n      // 从本地存储获取应用配置\r\n      const config = uni.getStorageSync('appConfig') || {\r\n        theme: 'light',\r\n        fontSize: 'medium',\r\n        language: 'zh-CN'\r\n      };\r\n      \r\n      commit('SET_APP_CONFIG', config);\r\n      return { success: true, data: config };\r\n    } catch (error) {\r\n      console.error('加载应用配置失败:', error);\r\n      return { success: false, error };\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 设置系统主题\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Promise<Object>} 设置结果\r\n   */\r\n  setSystemTheme({ state }) {\r\n    try {\r\n      const { theme } = state.appConfig;\r\n      \r\n      // 设置系统主题\r\n      if (theme === 'dark') {\r\n        // 设置深色主题\r\n        uni.setNavigationBarColor({\r\n          frontColor: '#ffffff',\r\n          backgroundColor: '#333333'\r\n        });\r\n      } else {\r\n        // 设置浅色主题\r\n        uni.setNavigationBarColor({\r\n          frontColor: '#000000',\r\n          backgroundColor: '#ffffff'\r\n        });\r\n      }\r\n      \r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('设置系统主题失败:', error);\r\n      return { success: false, error };\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 更新应用配置\r\n   * @param {Object} context - Vuex上下文\r\n   * @param {Object} config - 新的配置\r\n   * @returns {Promise<Object>} 更新结果\r\n   */\r\n  async updateAppConfig({ commit, dispatch, state }, config) {\r\n    try {\r\n      commit('SET_APP_CONFIG', config);\r\n      \r\n      // 如果主题发生变化，重新设置系统主题\r\n      if (config.theme && config.theme !== state.appConfig.theme) {\r\n        await dispatch('setSystemTheme');\r\n      }\r\n      \r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('更新应用配置失败:', error);\r\n      return { success: false, error };\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 添加通知\r\n   * @param {Object} context - Vuex上下文\r\n   * @param {Object} notification - 通知对象\r\n   * @returns {Object} 添加结果\r\n   */\r\n  addNotification({ commit }, notification) {\r\n    try {\r\n      commit('ADD_NOTIFICATION', notification);\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('添加通知失败:', error);\r\n      return { success: false, error };\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 标记通知为已读\r\n   * @param {Object} context - Vuex上下文\r\n   * @param {string} notificationId - 通知ID\r\n   * @returns {Object} 标记结果\r\n   */\r\n  markNotificationRead({ commit }, notificationId) {\r\n    try {\r\n      commit('MARK_NOTIFICATION_READ', notificationId);\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('标记通知已读失败:', error);\r\n      return { success: false, error };\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @description 清除所有通知\r\n   * @param {Object} context - Vuex上下文\r\n   * @returns {Object} 清除结果\r\n   */\r\n  clearNotifications({ commit }) {\r\n    try {\r\n      commit('CLEAR_NOTIFICATIONS');\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('清除通知失败:', error);\r\n      return { success: false, error };\r\n    }\r\n  }\r\n}; "],"names":["uni"],"mappings":"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"}